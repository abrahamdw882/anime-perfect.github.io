<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>元渊`Blog</title>
  
  <subtitle>生活明朗,万物可爱</subtitle>
  <link href="https://www.yuanyuan.blog/atom.xml" rel="self"/>
  
  <link href="https://www.yuanyuan.blog/"/>
  <updated>2024-01-14T15:51:58.798Z</updated>
  <id>https://www.yuanyuan.blog/</id>
  
  <author>
    <name>元渊</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>dockerfile例子</title>
    <link href="https://www.yuanyuan.blog/posts/36423b00.html"/>
    <id>https://www.yuanyuan.blog/posts/36423b00.html</id>
    <published>2023-07-08T20:41:04.000Z</published>
    <updated>2024-01-14T15:51:58.798Z</updated>
    
    <content type="html"><![CDATA[<h3 id="centos">centos</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> centos</span><br><span class="line"><span class="keyword">MAINTAINER</span> liaojie1314&lt;<span class="number">1517438366</span>@qq.com&gt;</span><br><span class="line"><span class="keyword">ENV</span> MYPATH /usr/local</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> <span class="variable">$MYPATH</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">cd</span> /etc/yum.repos.d/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> sed -i <span class="string">&#x27;s/mirrorlist/#mirrorlist/g&#x27;</span> /etc/yum.repos.d/CentOS-*</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> sed -i <span class="string">&#x27;s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g&#x27;</span> /etc/yum.repos.d/CentOS-*</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum -y install vim</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum -y install net-tools</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="variable">$MYPATH</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;-----end----&quot;</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> /bin/bash</span></span><br></pre></td></tr></table></figure><h3 id="cuda-cudnn-tensorrt">cuda+cudnn+TensorRT</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ARG</span> CUDA_VERSION=<span class="number">11.4</span>.<span class="number">2</span></span><br><span class="line"><span class="keyword">ARG</span> OS_VERSION=<span class="number">20.04</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> nvidia/cuda:$&#123;CUDA_VERSION&#125;-cudnn8-devel-ubuntu$&#123;OS_VERSION&#125;</span><br><span class="line"><span class="keyword">LABEL</span><span class="language-bash"> maintainer=<span class="string">&quot;liaojie1314&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> TRT_VERSION <span class="number">8.2</span>.<span class="number">0.6</span></span><br><span class="line"><span class="keyword">SHELL</span><span class="language-bash"> [<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Setup user account</span></span><br><span class="line"><span class="keyword">ARG</span> uid=<span class="number">1000</span></span><br><span class="line"><span class="keyword">ARG</span> gid=<span class="number">1000</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> groupadd -r -f -g <span class="variable">$&#123;gid&#125;</span> trtuser &amp;&amp; useradd -o -r -u <span class="variable">$&#123;uid&#125;</span> -g <span class="variable">$&#123;gid&#125;</span> -ms /bin/bash trtuser</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> usermod -aG sudo trtuser</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&#x27;trtuser:nvidia&#x27;</span> | chpasswd</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> -p /workspace &amp;&amp; <span class="built_in">chown</span> trtuser /workspace</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Required to build Ubuntu 20.04 without user prompts with DLFW container</span></span><br><span class="line"><span class="keyword">ENV</span> DEBIAN_FRONTEND=noninteractive</span><br><span class="line"></span><br><span class="line"><span class="comment"># Install requried libraries</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-key adv --recv-keys --keyserver keyserver.ubuntu.com A4B469963BF863CC &amp;&amp; apt-get update &amp;&amp; apt-get install -y software-properties-common</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> add-apt-repository ppa:ubuntu-toolchain-r/test</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y --no-install-recommends \</span></span><br><span class="line"><span class="language-bash">    libcurl4-openssl-dev \</span></span><br><span class="line"><span class="language-bash">    wget \</span></span><br><span class="line"><span class="language-bash">    zlib1g-dev \</span></span><br><span class="line"><span class="language-bash">    git \</span></span><br><span class="line"><span class="language-bash">    pkg-config \</span></span><br><span class="line"><span class="language-bash">    sudo \</span></span><br><span class="line"><span class="language-bash">    ssh \</span></span><br><span class="line"><span class="language-bash">    libssl-dev \</span></span><br><span class="line"><span class="language-bash">    pbzip2 \</span></span><br><span class="line"><span class="language-bash">    pv \</span></span><br><span class="line"><span class="language-bash">    bzip2 \</span></span><br><span class="line"><span class="language-bash">    unzip \</span></span><br><span class="line"><span class="language-bash">    devscripts \</span></span><br><span class="line"><span class="language-bash">    lintian \</span></span><br><span class="line"><span class="language-bash">    fakeroot \</span></span><br><span class="line"><span class="language-bash">    dh-make \</span></span><br><span class="line"><span class="language-bash">    build-essential</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Install python3</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y --no-install-recommends \</span></span><br><span class="line"><span class="language-bash">      python3 \</span></span><br><span class="line"><span class="language-bash">      python3-pip \</span></span><br><span class="line"><span class="language-bash">      python3-dev \</span></span><br><span class="line"><span class="language-bash">      python3-wheel &amp;&amp;\</span></span><br><span class="line"><span class="language-bash">    <span class="built_in">cd</span> /usr/local/bin &amp;&amp;\</span></span><br><span class="line"><span class="language-bash">    <span class="built_in">ln</span> -s /usr/bin/python3 python &amp;&amp;\</span></span><br><span class="line"><span class="language-bash">    <span class="built_in">ln</span> -s /usr/bin/pip3 pip;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Install TensorRT</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> v=<span class="string">&quot;<span class="variable">$&#123;TRT_VERSION%.*&#125;</span>-1+cuda<span class="variable">$&#123;CUDA_VERSION%.*&#125;</span>&quot;</span> &amp;&amp;\</span></span><br><span class="line"><span class="language-bash">    apt-key adv --fetch-keys https://developer.download.nvidia.com/compute/cuda/repos/ubuntu2004/x86_64/7fa2af80.pub &amp;&amp;\</span></span><br><span class="line"><span class="language-bash">    apt-get update &amp;&amp;\</span></span><br><span class="line"><span class="language-bash">    sudo apt-get install libnvinfer8=<span class="variable">$&#123;v&#125;</span> libnvonnxparsers8=<span class="variable">$&#123;v&#125;</span> libnvparsers8=<span class="variable">$&#123;v&#125;</span> libnvinfer-plugin8=<span class="variable">$&#123;v&#125;</span> \</span></span><br><span class="line"><span class="language-bash">        libnvinfer-dev=<span class="variable">$&#123;v&#125;</span> libnvonnxparsers-dev=<span class="variable">$&#123;v&#125;</span> libnvparsers-dev=<span class="variable">$&#123;v&#125;</span> libnvinfer-plugin-dev=<span class="variable">$&#123;v&#125;</span> \</span></span><br><span class="line"><span class="language-bash">        python3-libnvinfer=<span class="variable">$&#123;v&#125;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Install PyPI packages</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip3 install --upgrade pip</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip3 install setuptools&gt;=41.0.0</span></span><br><span class="line"><span class="comment"># COPY requirements.txt /tmp/requirements.txt</span></span><br><span class="line"><span class="comment"># RUN pip3 install -r /tmp/requirements.txt</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip3 install jupyter jupyterlab</span></span><br><span class="line"><span class="comment"># Workaround to remove numpy installed with tensorflow</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip3 install --upgrade numpy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Install Cmake</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">cd</span> /tmp &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    wget https://github.com/Kitware/CMake/releases/download/v3.14.4/cmake-3.14.4-Linux-x86_64.sh &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    <span class="built_in">chmod</span> +x cmake-3.14.4-Linux-x86_64.sh &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    ./cmake-3.14.4-Linux-x86_64.sh --prefix=/usr/local --exclude-subdir --skip-license &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    <span class="built_in">rm</span> ./cmake-3.14.4-Linux-x86_64.sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Download NGC client</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">cd</span> /usr/local/bin &amp;&amp; wget https://ngc.nvidia.com/downloads/ngccli_cat_linux.zip &amp;&amp; unzip ngccli_cat_linux.zip &amp;&amp; <span class="built_in">cd</span> ngc-cli/ &amp;&amp; <span class="built_in">chmod</span> u+x ngc &amp;&amp; <span class="built_in">rm</span> ../ngccli_cat_linux.zip ../ngc-cli.md5 &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;no-apikey\nascii\n&quot;</span> | ./ngc config <span class="built_in">set</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set environment and working directory</span></span><br><span class="line"><span class="keyword">ENV</span> TRT_LIBPATH /usr/lib/x86_64-linux-gnu</span><br><span class="line"><span class="keyword">ENV</span> TRT_OSSPATH /workspace/TensorRT</span><br><span class="line"><span class="keyword">ENV</span> LD_LIBRARY_PATH=<span class="string">&quot;$&#123;LD_LIBRARY_PATH&#125;:$&#123;TRT_OSSPATH&#125;/build/out:$&#123;TRT_LIBPATH&#125;&quot;</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /workspace</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">USER</span> trtuser</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> [<span class="string">&quot;/bin/bash&quot;</span>]</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;centos&quot;&gt;centos&lt;/h3&gt;
&lt;figure class=&quot;highlight dockerfile&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span cla</summary>
      
    
    
    
    <category term="运维" scheme="https://www.yuanyuan.blog/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="docker" scheme="https://www.yuanyuan.blog/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>docker-compose例子</title>
    <link href="https://www.yuanyuan.blog/posts/bad9d448.html"/>
    <id>https://www.yuanyuan.blog/posts/bad9d448.html</id>
    <published>2023-07-08T20:40:53.000Z</published>
    <updated>2024-01-14T15:51:58.798Z</updated>
    
    <content type="html"><![CDATA[<h3 id="kavita漫画">Kavita漫画</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">version: &#x27;3.9&#x27;</span><br><span class="line">services:</span><br><span class="line">    kavita:</span><br><span class="line">        image: kizaing/kavita:latest    # Change latest to nightly for latest develop builds (can&#x27;t go back to stable)</span><br><span class="line">        container_name: kavita</span><br><span class="line">        volumes:</span><br><span class="line">            - ./manga:/manga            # Manga is just an example you can have the name you want. See the following</span><br><span class="line">            - ./comics:/comics          # Use as many as you want</span><br><span class="line">            - ./books:/books            #</span><br><span class="line">            - ./data:/kavita/config     # Change &#x27;./data if you want to have the config files in a different place.</span><br><span class="line">                                        # /kavita/config must not be changed</span><br><span class="line">        environment:</span><br><span class="line">            - TZ=Your/Timezone</span><br><span class="line">        ports:</span><br><span class="line">            - &quot;5000:5000&quot; # Change the public port (the first 5000) if you have conflicts with other services</span><br><span class="line">        restart: unless-stopped</span><br></pre></td></tr></table></figure><h3 id="lazydocker">lazydocker</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">version: &#x27;3&#x27;</span><br><span class="line">services:</span><br><span class="line">  lazydocker:</span><br><span class="line">    build:</span><br><span class="line">      context: https://github.com/jesseduffield/lazydocker.git</span><br><span class="line">      args:</span><br><span class="line">        BASE_IMAGE_BUILDER: golang</span><br><span class="line">        GOARCH: amd64</span><br><span class="line">        GOARM:</span><br><span class="line">    image: lazyteam/lazydocker</span><br><span class="line">    container_name: lazydocker</span><br><span class="line">    stdin_open: true</span><br><span class="line">    tty: true</span><br><span class="line">    volumes:</span><br><span class="line">      - /var/run/docker.sock:/var/run/docker.sock</span><br><span class="line">      - ./config:/.config/jesseduffield/lazydocker</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;kavita漫画&quot;&gt;Kavita漫画&lt;/h3&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span </summary>
      
    
    
    
    <category term="运维" scheme="https://www.yuanyuan.blog/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="docker" scheme="https://www.yuanyuan.blog/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>jenv管理多版本jdk</title>
    <link href="https://www.yuanyuan.blog/posts/9f01ffa.html"/>
    <id>https://www.yuanyuan.blog/posts/9f01ffa.html</id>
    <published>2023-07-05T19:24:26.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<h3 id="安装">安装</h3><h4 id="linux-os-x">Linux / OS X</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/jenv/jenv.git ~/.jenv</span><br></pre></td></tr></table></figure><h3 id="添加环境变量">添加环境变量</h3><h4 id="bash">Bash</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;export PATH=&quot;$HOME/.jenv/bin:$PATH&quot;&#x27; &gt;&gt; ~/.bash_profile</span><br><span class="line">echo &#x27;eval &quot;$(jenv init -)&quot;&#x27; &gt;&gt; ~/.bash_profile</span><br></pre></td></tr></table></figure><h4 id="zsh">Zsh</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;export PATH=&quot;$HOME/.jenv/bin:$PATH&quot;&#x27; &gt;&gt; ~/.zshrc</span><br><span class="line">echo &#x27;eval &quot;$(jenv init -)&quot;&#x27; &gt;&gt; ~/.zshrc</span><br></pre></td></tr></table></figure><h3 id="添加jdk位置">添加jdk位置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jenv add /usr/local/java/jdk1.8.0_371/</span><br></pre></td></tr></table></figure><h3 id="使用">使用</h3><h4 id="列出全部jdk">列出全部jdk</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">jenv versions</span></span><br><span class="line">  system</span><br><span class="line">  oracle64-1.6.0.39</span><br><span class="line">* oracle64-1.7.0.11</span><br></pre></td></tr></table></figure><h4 id="设置全局jdk版本">设置全局jdk版本</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jenv global oracle64-1.6.0.39</span><br></pre></td></tr></table></figure><h4 id="设置全局jdk版本-每个目录">设置全局jdk版本(每个目录)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jenv local oracle64-1.6.0.39</span><br></pre></td></tr></table></figure><h4 id="设置终端jdk版本">设置终端jdk版本</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jenv shell oracle64-1.6.0.39</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;安装&quot;&gt;安装&lt;/h3&gt;
&lt;h4 id=&quot;linux-os-x&quot;&gt;Linux / OS X&lt;/h4&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;li</summary>
      
    
    
    
    <category term="安装" scheme="https://www.yuanyuan.blog/categories/%E5%AE%89%E8%A3%85/"/>
    
    
    <category term="jenv" scheme="https://www.yuanyuan.blog/tags/jenv/"/>
    
  </entry>
  
  <entry>
    <title>ubuntu22.04安装配置neo4j</title>
    <link href="https://www.yuanyuan.blog/posts/157e09f6.html"/>
    <id>https://www.yuanyuan.blog/posts/157e09f6.html</id>
    <published>2023-07-05T18:44:09.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<p>neo4j 5 对 jre 版本要求是 17 及以上，且最好是 openjdk，使用比较新的 ubuntu 系统安装比较好， centos7 因为没有维护，yum 找不到 openjdk-17了。</p><h3 id="安装-openjdk-17-可以不安装-安装neo4j时默认会安装">安装 openjdk-17(可以不安装,安装neo4j时默认会安装)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get -y install openjdk-17-jdk openjdk-17-dbg openjdk-17-jre </span><br><span class="line">java -version </span><br></pre></td></tr></table></figure><h3 id="添加-neo4j-的仓库">添加 neo4j 的仓库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget -O - https://debian.neo4j.com/neotechnology.gpg.key | sudo apt-key add -</span><br><span class="line">echo &#x27;deb https://debian.neo4j.com stable latest&#x27; | sudo tee -a /etc/apt/sources.list.d/neo4j.list</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo add-apt-repository universe</span><br></pre></td></tr></table></figure><h3 id="安装-neo4j">安装 neo4j</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">apt list -a neo4j <span class="comment">#显示 neo4j 各个版本，选择自己需要的</span></span></span><br><span class="line">sudo apt-get -y install neo4j=1:5.5.0 # 选择 5.5 版本</span><br></pre></td></tr></table></figure><h3 id="查看版本">查看版本</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">neo4j --version</span><br></pre></td></tr></table></figure><h3 id="设置初始密码">设置初始密码</h3><p>“<password>” 记得改成自己密码：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo neo4j-admin dbms set-initial-password &lt;password&gt;</span><br></pre></td></tr></table></figure><h3 id="修改-neo4j-监听地址">修改 neo4j 监听地址</h3><p>找到 neo4j 的配置文件，将服务监听地址改成全局地址</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/neo4j/neo4j.conf</span><br></pre></td></tr></table></figure><p>取消掉如下 3 行的注释，保存配置文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server.default_listen_address=0.0.0.0</span><br><span class="line">server.http.listen_address=:7474</span><br><span class="line">server.http.advertised_address=:7474</span><br></pre></td></tr></table></figure><h3 id="启动-neo4j-服务">启动 neo4j 服务</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start neo4j.service</span><br></pre></td></tr></table></figure><p>ss -ntlp 看到 neo4j 监听端口，就说明启动成功了</p><p>访问 <a href="http://localhost:7474">http://localhost:7474</a>，输入账号 neo4j 以及自己设置的密码，就可以登录了。</p><h3 id="安装-apoc-插件">安装 apoc 插件</h3><p>Neo4j 5 版本 apoc 插件改成了两个部分 apoc-core 和 apoc-extend，5.5 版本就下 5.5 的插件</p><ul><li>apoc-core <a href="https://github.com/neo4j/apoc">GitHub - neo4j/apoc</a></li><li>apoc-extended  <a href="https://github.com/neo4j-contrib/neo4j-apoc-procedures">GitHub - neo4j-contrib/neo4j-apoc-procedures: Awesome Procedures On Cypher for Neo4j - codenamed “apoc”</a></li></ul><p>下好了后放到 neo4j 的 plugins 目录，这个目录可以在 neo4j.conf 中找到，本次安装默认配置的路径是 <strong>/var/lib/neo4j/plugins</strong></p><p>编辑 neo4j 配置文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/neo4j/neo4j.conf</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">取消以下行的注释，添加 apoc 扩展</span></span><br><span class="line">dbms.security.procedures.unrestricted=apoc.*</span><br></pre></td></tr></table></figure><p>在 /etc/neo4j/ 目录下新建 apoc.conf 文件，添加 apoc 插件配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/neo4j/apoc.conf</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加如下行</span></span><br><span class="line">apoc.import.file.enabled=true</span><br><span class="line">apoc.import.file.use_neo4j_config=false</span><br></pre></td></tr></table></figure><p>重新启动 neo4j 访问</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;neo4j 5 对 jre 版本要求是 17 及以上，且最好是 openjdk，使用比较新的 ubuntu 系统安装比较好， centos7 因为没有维护，yum 找不到 openjdk-17了。&lt;/p&gt;
&lt;h3 id=&quot;安装-openjdk-17-可以不安装-安装neo4</summary>
      
    
    
    
    <category term="数据库" scheme="https://www.yuanyuan.blog/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    <category term="安装" scheme="https://www.yuanyuan.blog/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%AE%89%E8%A3%85/"/>
    
    
    <category term="neo4j" scheme="https://www.yuanyuan.blog/tags/neo4j/"/>
    
  </entry>
  
  <entry>
    <title>ubuntu终端美化</title>
    <link href="https://www.yuanyuan.blog/posts/969f7c6b.html"/>
    <id>https://www.yuanyuan.blog/posts/969f7c6b.html</id>
    <published>2023-07-04T11:59:45.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<h2 id="非root用户安装">非root用户安装</h2><p>本教程会安装zsh，autojump，zsh-autosuggestions，zsh-syntax-highlighting等插件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">cd ~ # 到用户目录</span><br><span class="line">mkdir software # 创建目录，在该目录下安装zsh和其他插件</span><br><span class="line">cd software</span><br><span class="line">wget -O zsh.tar.xz https://sourceforge.net/projects/zsh/files/latest/download</span><br><span class="line">mkdir zsh &amp;&amp; unxz zsh.tar.xz &amp;&amp; tar -xvf zsh.tar -C zsh --strip-components 1</span><br><span class="line">cd zsh</span><br><span class="line"></span><br><span class="line">./configure --prefix=$HOME/software</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将 安装路径放到PATH中</span></span><br><span class="line">echo &#x27;export PATH=&quot;$HOME/software/bin:$PATH&quot;&#x27; &gt;&gt; ~/.bashrc</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行下面命令</span></span><br><span class="line">source ~/.bashrc</span><br><span class="line"></span><br><span class="line">cd ~/software # 回software目录，安装ohmyzsh，用于自动生成.zshrc文件</span><br><span class="line">git clone https://github.com/ohmyzsh/ohmyzsh.git</span><br><span class="line">cd ohmyzsh/tools/</span><br><span class="line">./install.sh</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这儿会让选择是否将zsh设置为默认的shell，选择n</span></span><br><span class="line">echo &quot;zsh&quot; &gt;&gt; ~/.bashrc # 每次打开终端，在最后都让他去执行zsh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载安装 zsh-autosuggestions （自动补全可能路径）</span></span><br><span class="line">cd ~/software # 回到software目录，安装zsh-autosuggestions插件</span><br><span class="line">git clone https://github.com/zsh-users/zsh-autosuggestions.git $ZSH_CUSTOM/plugins/zsh-autosuggestions</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载 autojump （快速跳转）</span></span><br><span class="line">git clone https://github.com/joelthelion/autojump.git</span><br><span class="line">cd autojump</span><br><span class="line">./install.py   #如果这里提示没有安装 python，请自行安装python，可以考虑直接安装anaconda</span><br><span class="line"></span><br><span class="line">echo &quot;[[ -s ~/.autojump/etc/profile.d/autojump.sh ]] &amp;&amp; . ~/.autojump/etc/profile.d/autojump.sh&quot; &gt;&gt; ~/.zshrc </span><br><span class="line"></span><br><span class="line">cd ~/software # 回software目录，下载语法高亮插件</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载安装 zsh-syntax-highlighting （终端输入高亮 正确路径下划线）</span></span><br><span class="line">git clone https://github.com/zsh-users/zsh-syntax-highlighting.git $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlighting</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">更新插件配置</span></span><br><span class="line">vi ~/.zshrc</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">plugins=(git autojump zsh-autosuggestions zsh-syntax-highlighting)</span></span><br><span class="line">source .zshrc</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;非root用户安装&quot;&gt;非root用户安装&lt;/h2&gt;
&lt;p&gt;本教程会安装zsh，autojump，zsh-autosuggestions，zsh-syntax-highlighting等插件&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;</summary>
      
    
    
    
    <category term="安装" scheme="https://www.yuanyuan.blog/categories/%E5%AE%89%E8%A3%85/"/>
    
    
    <category term="wine" scheme="https://www.yuanyuan.blog/tags/wine/"/>
    
  </entry>
  
  <entry>
    <title>ubuntu安装wine</title>
    <link href="https://www.yuanyuan.blog/posts/818c90c8.html"/>
    <id>https://www.yuanyuan.blog/posts/818c90c8.html</id>
    <published>2023-06-30T19:41:14.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<p>当我们在ubuntu中想要运行windows应用时，就需要安装wine。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg --add-architecture i386</span><br><span class="line">sudo apt update</span><br><span class="line">wget -qO- https://dl.winehq.org/wine-builds/winehq.key | sudo apt-key add -</span><br><span class="line">sudo apt install software-properties-common</span><br><span class="line">sudo apt-add-repository &quot;deb http://dl.winehq.org/wine-builds/ubuntu/ $(lsb_release -cs) main&quot;</span><br><span class="line">sudo apt install --install-recommends winehq-stable</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看wine版本</span></span><br><span class="line">wine --version</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;当我们在ubuntu中想要运行windows应用时，就需要安装wine。&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;b</summary>
      
    
    
    
    <category term="安装" scheme="https://www.yuanyuan.blog/categories/%E5%AE%89%E8%A3%85/"/>
    
    
    <category term="wine" scheme="https://www.yuanyuan.blog/tags/wine/"/>
    
  </entry>
  
  <entry>
    <title>postgresql</title>
    <link href="https://www.yuanyuan.blog/posts/126df961.html"/>
    <id>https://www.yuanyuan.blog/posts/126df961.html</id>
    <published>2023-06-28T20:59:23.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<h1 id="安装postgresql">安装postgresql</h1><h2 id="在ubuntu上安装">在ubuntu上安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install postgresql postgresql-contrib</span><br></pre></td></tr></table></figure><p>我们同时安装 PostgreSQL contrib 软件包，它可以提供 PostgreSQL 数据库系统的一些额外特性。</p><p>一旦安装完成， PostgreSQL 服务将会自动启动。使用<code>psql</code>工具通过连接 PostgreSQL 数据库并且打印它的版本来验证安装：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u postgres psql -c &quot;SELECT version();&quot;</span><br></pre></td></tr></table></figure><h3 id="postgresql-角色和身份认证方式">PostgreSQL 角色和身份认证方式</h3><p>PostgreSQL 数据库访问权限是通过角色来处理的。一个角色代表一个数据库用户或者一个数据库用户组。</p><p>PostgreSQL 支持多种身份认证方式。最常用的方法如下：</p><ul><li>Trust - 只要满足<code>pg_hba.conf</code>定义的条件，一个角色就可以不使用密码就能连接服务器</li><li>Password - 通过密码，一个角色可以连接服务器。密码可以被存储为 scram-sha-256, md5, 和 password(明文)。</li><li>Ident - 仅仅支持 TCP/IP 连接。它通常通过一个可选的用户名映射表，获取客户端操作系统用户名。</li><li>Peer - 和 Ident 一样，仅仅支持本地连接。</li></ul><p>PostgreSQL 客户端身份验证通常被定义在<code>pg_hba.conf</code>文件中。默认情况下，对于本地连接，PostgreSQL 被设置成身份认证防范 peer。</p><p>为了以<code>postgres</code>用户身份登录 PostgreSQL 服务器，首先切换用户，然后使用<code>psql</code>工具访问 PostgreSQL并设置初始密码(方便使用数据库管理工具如navicat连接)。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo su - postgres</span><br><span class="line">psql</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置初始密码</span></span><br><span class="line">\password postgres</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">或者</span></span><br><span class="line">ALTER USER postgres WITH PASSWORD &#x27;xxxxxx&#x27;;</span><br></pre></td></tr></table></figure><p>从这里开始，你可以与 PostgreSQL 实例交互。退出 PostgreSQL Shell，输入：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\q</span><br></pre></td></tr></table></figure><p>你也可以不切换用户，而使用<code>sudo</code>命令访问 PostgreSQL：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u postgres psql</span><br></pre></td></tr></table></figure><p>通常，<code>postgres</code>用户仅仅在本地被使用。</p><h3 id="创建-postgresql-角色和数据库-可选">创建 PostgreSQL 角色和数据库(可选)</h3><p>仅仅超级用户和拥有<code>CREATEROLE</code>权限的角色可以创建新角色。</p><p>在下面的例子中，我们创建一个名称为<code>yuanyuan</code>的角色，一个名称为<code>yuanyuandb</code>的数据库，并且授予数据库上的权限：</p><p>01.创建一个新的 PostgreSQL 角色：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su - postgres -c &quot;createuser yuanyuan&quot;</span><br></pre></td></tr></table></figure><p>02.创建一个新的 PostgreSQL 数据库：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su - postgres -c &quot;createdb yuanyuandb&quot;</span><br></pre></td></tr></table></figure><p>想要授权用户操作数据库，连接到 PostgreSQL shell:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u postgres psql</span><br></pre></td></tr></table></figure><p>并且运行下面的 query:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grant all privileges on database yuanyuandb to yuanyuan;</span><br></pre></td></tr></table></figure><h3 id="启用远程访问-postgresql-服务器-可选">启用远程访问 PostgreSQL 服务器(可选)</h3><p>默认情况下，PostgreSQL 服务器仅仅监听本地网络接口：<code>127.0.0.1</code>。</p><p>为了允许远程访问你的 PostgreSQL 服务器，打开配置文件<code>postgresql.conf</code>并且在<code>CONNECTIONS AND AUTHENTICATION</code>一节添加<code>listen_addresses = '*'</code>。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/postgresql/12/main/postgresql.conf</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">------------------------------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">CONNECTIONS AND AUTHENTICATION</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">------------------------------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">- Connection Settings -</span></span><br><span class="line"></span><br><span class="line">listen_addresses = &#x27;*&#x27;     # what IP address(es) to listen on;</span><br></pre></td></tr></table></figure><p>保存文件并且重启 PostgreSQL 服务：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service postgresql restart</span><br></pre></td></tr></table></figure><p>使用<code>ss</code>工具验证修改：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -nlt | grep 5432</span><br></pre></td></tr></table></figure><p>输出显示 PostgreSQL 服务器正在监听所有的网络接口(<code>0.0.0.0</code>):</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LISTEN  0        244              0.0.0.0:5432           0.0.0.0:*              </span><br><span class="line">LISTEN  0        244                 [::]:5432              [::]:*</span><br></pre></td></tr></table></figure><p>下一步就是配置服务器接受远程连接，编辑<code>pg_hba.conf</code>文件。</p><p>下面是一些例子，显示不同的用户场景：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># TYPE  DATABASE        USER            ADDRESS                 METHOD</span><br><span class="line"></span><br><span class="line"># The user yuanyuan can access all databases from all locations using md5 password</span><br><span class="line">host    all             yuanyuan        0.0.0.0/0                md5</span><br><span class="line"></span><br><span class="line"># The user yuanyuan can access only the yuanyuandb from all locations using md5 password</span><br><span class="line">host    yuanyuandb      yuanyuan        0.0.0.0/0                md5</span><br><span class="line"></span><br><span class="line"># The user yuanyuan can access all databases from a trusted location (192.168.1.134) without a password</span><br><span class="line">host    all             yuanyuan        192.168.1.134            trust</span><br></pre></td></tr></table></figure><p>最后一步就是在你的防火墙上打开端口<code>5432</code>端口。</p><p>假设你正在使用<code>UFW</code>来管理你的防火墙，并且你想允许从<code>192.168.1.0/24</code>子网过来的访问，你应该运行下面的命令：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw allow proto tcp from 192.168.1.0/24 to any port 5432</span><br></pre></td></tr></table></figure><p>确保你的防火墙被配置好，并仅仅接受来自受信任 IP 范围的连接。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;安装postgresql&quot;&gt;安装postgresql&lt;/h1&gt;
&lt;h2 id=&quot;在ubuntu上安装&quot;&gt;在ubuntu上安装&lt;/h2&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;p</summary>
      
    
    
    
    <category term="数据库" scheme="https://www.yuanyuan.blog/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="postgresql" scheme="https://www.yuanyuan.blog/tags/postgresql/"/>
    
  </entry>
  
  <entry>
    <title>dos常用指令</title>
    <link href="https://www.yuanyuan.blog/posts/5784a051.html"/>
    <id>https://www.yuanyuan.blog/posts/5784a051.html</id>
    <published>2023-05-03T20:10:06.000Z</published>
    <updated>2024-01-14T15:51:58.798Z</updated>
    
    <content type="html"><![CDATA[<h2 id="dos-的基本介绍">dos 的基本介绍</h2><p>Dos： Disk Operating System 磁盘操作系统, 简单说一下 windows 的目录结构</p><h2 id="dos-的基本操作原理">dos 的基本操作原理</h2><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503201204.png" alt="image-20230503201204522"></p><h2 id="目录操作指令">目录操作指令</h2><p>查看当前目录是什么</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503201247.png" alt="image-20230503201247375"></p><h3 id="切换目录">切换目录</h3><p>切换到其他盘下：盘符号 F 盘</p><p>案例演示：</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503201328.png" alt="image-20230503201328280"></p><p>切换到当前盘的其他目录下 (使用相对路径和绝对路径演示)<br>案例演示：</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503201348.png" alt="image-20230503201348645"></p><p>切换到上一级：</p><blockquote><p>cd …</p></blockquote><p>切换到根目录：</p><blockquote><p>cd \</p></blockquote><h3 id="新建目录-md-make-directory">新建目录 md （make directory）</h3><p>新建一个目录：</p><blockquote><p>md dirName</p></blockquote><p>新建多个目录：</p><blockquote><p>md dirName1 dirName2</p></blockquote><h3 id="删除目录">删除目录</h3><p>删除空目录</p><blockquote><p>rd dirName</p></blockquote><p>删除目录以及下面的子目录和文件，不带询问</p><blockquote><p>rd /q/s dirName</p></blockquote><p>删除目录以及下面的子目录和文件，带询问</p><blockquote><p>rd /s dirName</p></blockquote><h2 id="文件的操作">文件的操作</h2><h3 id="新建或追加内容到文件">新建或追加内容到文件</h3><blockquote><p>echo xxx &gt; d:\1.txt</p><p>echo xxx &gt; 2.txt</p></blockquote><h3 id="复制或移动文件">复制或移动文件</h3><p>复制</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503201856.png" alt="image-20230503201848117"></p><p>移动</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503201916.png" alt="image-20230503201916469"></p><h3 id="删除文件">删除文件</h3><p>删除指定文件</p><blockquote><p>del 1.txt</p><p>del /f “Read Only Test File.txt”  强制删除文件</p></blockquote><p>删除所有txt文件</p><blockquote><p>del *.txt</p></blockquote><h2 id="其它指令">其它指令</h2><h3 id="清屏">清屏</h3><blockquote><p>cls</p></blockquote><h3 id="退出-dos">退出 dos</h3><blockquote><p>exit</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;dos-的基本介绍&quot;&gt;dos 的基本介绍&lt;/h2&gt;
&lt;p&gt;Dos： Disk Operating System 磁盘操作系统, 简单说一下 windows 的目录结构&lt;/p&gt;
&lt;h2 id=&quot;dos-的基本操作原理&quot;&gt;dos 的基本操作原理&lt;/h2&gt;
&lt;p&gt;&lt;im</summary>
      
    
    
    
    <category term="运维" scheme="https://www.yuanyuan.blog/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="dos" scheme="https://www.yuanyuan.blog/tags/dos/"/>
    
  </entry>
  
  <entry>
    <title>go基础1变量</title>
    <link href="https://www.yuanyuan.blog/posts/1d8fb141.html"/>
    <id>https://www.yuanyuan.blog/posts/1d8fb141.html</id>
    <published>2023-05-03T20:09:14.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<h2 id="为什么需要变量">为什么需要变量</h2><h3 id="变量是程序的基本组成单位">变量是程序的基本组成单位</h3><p>不论是使用哪种高级程序语言编写程序,变量都是其程序的基本组成单位</p><h2 id="变量的介绍">变量的介绍</h2><h3 id="变量的概念">变量的概念</h3><p>变量相当于内存中一个数据存储空间的表示，你可以把变量看做是一个房间的门<br>牌号，通过门牌号我们可以找到房间，同样的道理，通过变量名可以访问到变量<br>(值)。</p><h3 id="变量的使用步骤">变量的使用步骤</h3><ol><li>声明变量(也叫:定义变量)</li><li>非变量赋值</li><li>使用变量</li></ol><h2 id="变量快速入门案例">变量快速入门案例</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 定义变量</span></span><br><span class="line"><span class="keyword">var</span> i <span class="type">int</span></span><br><span class="line"><span class="comment">// 给 i 赋值</span></span><br><span class="line">i = <span class="number">10</span></span><br><span class="line">fmt.Println(<span class="string">&quot;i=&quot;</span>, i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="变量使用注意事项">变量使用注意事项</h2><ol><li><p>变量表示内存中的一个存储区域</p></li><li><p>该区域有自己的名称（变量名）和类型（数据类型）<br>示意图：</p></li><li><p>Golang 变量使用的三种方式<br>(1) 第一种：指定变量类型，声明后若不赋值，使用默认值</p></li></ol>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i <span class="type">int</span></span><br></pre></td></tr></table></figure><p>(2) 第二种：根据值自行判定变量类型(类型推导)</p>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">10.11</span></span><br></pre></td></tr></table></figure><p>(3) 第三种：省略 var, 注意 :=左侧的变量不应该是已经声明过的，否则会导致编译错误</p>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name := <span class="string">&quot;yuanyuan&quot;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>多变量声明<br>在编程中，有时我们需要一次性声明多个变量，Golang 也提供这样的语法<br>举例说明:</li></ol>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a, b, c := <span class="number">100</span>, <span class="string">&quot;yuanyuan&quot;</span>, <span class="number">10.11</span></span><br></pre></td></tr></table></figure><p>如何一次性声明多个全局变量【在 go 中函数外部定义变量就是全局变量】：</p>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    n1 = <span class="number">100</span></span><br><span class="line">    n2 = <span class="number">200</span></span><br><span class="line">    n3 = <span class="number">300</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><ol start="5"><li><p>该区域的数据值可以在同一类型范围内不断变化(重点)</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230521202852.png" alt="image-20230521202852285"></p></li><li><p>变量在同一个作用域(在一个函数或者在代码块)内不能重名</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230521202947.png" alt="image-20230521202947250"></p></li></ol><ol start="7"><li>变量=变量名+值+数据类型，这一点请大家注意，变量的三要素</li><li>Golang 的变量如果没有赋初值，编译器会使用默认值, 比如 int 默认值 0, string 默认值为空串，小数默认为 0</li></ol><h2 id="变量的声明-初始化和赋值">变量的声明，初始化和赋值</h2><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230521203122.png" alt="image-20230521203121828"></p><h2 id="程序中-号的使用">程序中 + 号的使用</h2><ol><li>当左右两边都是数值型时，则做加法运算</li><li>当左右两边都是字符串，则做字符串拼接</li></ol><h2 id="数据类型的基本介绍">数据类型的基本介绍</h2><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230521203315.png" alt="image-20230521203315069"></p><h2 id="整数类型">整数类型</h2><h3 id="基本介绍">基本介绍</h3><p>简单的说，就是用于存放整数值的，比如 0, -1, 2345 等等。</p><h3 id="整数的各个类型">整数的各个类型</h3><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230521203551.png" alt="image-20230521203550762"></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> i <span class="type">int</span> = <span class="number">1</span></span><br><span class="line">fmt.Println(<span class="string">&quot;i=&quot;</span>, i)</span><br><span class="line"><span class="comment">// int8范围 -128~127</span></span><br><span class="line"><span class="keyword">var</span> j <span class="type">int8</span> = <span class="number">127</span></span><br><span class="line">fmt.Println(<span class="string">&quot;j=&quot;</span>, j)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>int 的无符号的类型：</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230521204508.png" alt="image-20230521204508320"></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> k <span class="type">uint16</span> = <span class="number">255</span></span><br><span class="line">fmt.Println(<span class="string">&quot;k=&quot;</span>, k)</span><br></pre></td></tr></table></figure><p>int 的其它类型的说明:</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230521204543.png" alt="image-20230521204543576"></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a <span class="type">int</span> = <span class="number">8900</span></span><br><span class="line">fmt.Println(<span class="string">&quot;a=&quot;</span>, a)</span><br><span class="line"><span class="keyword">var</span> b <span class="type">uint</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> c <span class="type">byte</span> = <span class="number">255</span></span><br><span class="line">fmt.Println(<span class="string">&quot;b=&quot;</span>, b, <span class="string">&quot;c=&quot;</span>, c)</span><br></pre></td></tr></table></figure><h3 id="整型的使用细节">整型的使用细节</h3><ol><li><p>Golang 各整数类型分：有符号和无符号，int uint 的大小和系统有关。</p></li><li><p>Golang 的整型默认声明为 int 型</p></li><li><p>如何在程序查看某个变量的字节大小和数据类型 （使用较多）</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;unsafe&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> a <span class="type">int64</span> = <span class="number">255</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;a的类型 %T 占用的字节数 %d&quot;</span>, a,unsafe.Sizeof(a))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ol start="4"><li>Golang 程序中整型变量在使用时，遵守保小不保大的原则，即：在保证程序正确运行下，尽量<br>使用占用空间小的数据类型。【如：年龄使用byte类型】</li></ol><ol start="5"><li>bit: 计算机中的最小存储单位。byte:计算机中基本存储单元。 1byte = 8 bit</li></ol><h2 id="小数类型-浮点型">小数类型/浮点型</h2><h3 id="基本介绍">基本介绍</h3><p>小数类型就是用于存放小数的，比如 1.2 0.23 -1.911</p><h3 id="小数类型分类">小数类型分类</h3><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230521205340.png" alt="image-20230521205339751"></p><ol><li>关于浮点数在机器中存放形式的简单说明,浮点数=符号位+指数位+尾数位<br>说明：浮点数都是有符号的.</li><li>尾数部分可能丢失，造成精度损失。 -123.0000901<br>说明：float64 的精度比 float32 的要准确.<br>说明：如果我们要保存一个精度高的数，则应该选用 float64</li><li>浮点型的存储分为三部分：符号位+指数位+尾数位 在存储过程中，精度会有丢失</li></ol><h3 id="浮点型使用细节">浮点型使用细节</h3><ol><li>Golang 浮点类型有固定的范围和字段长度，不受具体 OS(操作系统)的影响。</li><li>Golang 的浮点型默认声明为 float64 类型。</li><li>浮点型常量有两种表示形式<br>十进制数形式：  如：5.12        .512(必须有小数点）<br>科学计数法形式: 如：5.1234e2= 5.12 * 10 的 2 次方       5.12E-2 = 5.12/10 的 2 次方</li><li>通常情况下，应该使用 float64 ，因为它比 float32 更精确。[开发中，推荐使用 float64]</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;为什么需要变量&quot;&gt;为什么需要变量&lt;/h2&gt;
&lt;h3 id=&quot;变量是程序的基本组成单位&quot;&gt;变量是程序的基本组成单位&lt;/h3&gt;
&lt;p&gt;不论是使用哪种高级程序语言编写程序,变量都是其程序的基本组成单位&lt;/p&gt;
&lt;h2 id=&quot;变量的介绍&quot;&gt;变量的介绍&lt;/h2&gt;
&lt;h3 </summary>
      
    
    
    
    <category term="编程基础" scheme="https://www.yuanyuan.blog/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="golang" scheme="https://www.yuanyuan.blog/tags/golang/"/>
    
  </entry>
  
  <entry>
    <title>mongodb安装</title>
    <link href="https://www.yuanyuan.blog/posts/40605bfe.html"/>
    <id>https://www.yuanyuan.blog/posts/40605bfe.html</id>
    <published>2023-05-02T16:09:25.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<h2 id="windows安装mongodb">windows安装mongodb</h2><h3 id="下载文件">下载文件</h3><p>首先在mongodb的官方网站上下载最新版本的mongodb安装程序</p><p>下载网址：<a href="https://www.mongodb.com/try/download/community?tck=docs_server">MongoDB Community Download | MongoDB</a></p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503183640.png" alt="image-20230503183639389" style="zoom: 50%;" /><h3 id="安装">安装</h3><p>下载好后双击安装，目录自行选择，这里以安装在E目录为例</p><p>安装好后原本是没有data文件和log文件夹的，这里我们需要自己手动创建这两个文件夹，并且要在data文件夹中在创建一个db文件夹</p><h3 id="启动应用服务">启动应用服务</h3><p>以管理员身份运行cmd命令窗口，并进入至E:\MongoDB\bin目录下，执行以下命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongod --dbpath E:\MongoDB\data\db</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503184044.png" alt="image-20230503184044345"></p><p>再打开一个cmd命令窗口，并且还是以管理员身份打开，进入到E:\MongoDB\bin目录下，执行以下命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongo</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503184140.png" alt="image-20230503184139974"></p><p>如果出现这个界面就说明MongoDb已经启动成功了，但是要注意，这两个cmd命令框关闭后那么MongoDB也就结束服务了</p><h3 id="使用配置文件启动mongodb服务">使用配置文件启动MongoDB服务</h3><p>在<strong>E:\MongoDB\config</strong>下创建一个<strong>mongodb.conf</strong>文件，加入配置文件与直接运行命令的效果是一样的</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dbpath=E:\MongoDb\data\db             # 数据库文件</span><br><span class="line">logpath=E:\MongoDB\log\mongodb.log    # 日志文件</span><br><span class="line">logappend=true                        # 日志采用追加模式，配置后mongodb日志会追加到现有的日志文件，不会重新创建一个新文件</span><br><span class="line">journal=true                          # 启用日志文件，默认启用</span><br><span class="line">quiet=true                            # 这个选项可以过滤掉一些无用的日志信息，若需要调试使用请设置为 false</span><br><span class="line">port=27017                            # 端口号 默认为 27017</span><br></pre></td></tr></table></figure><p>然后运行命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc create MongoDB binPath= &quot;E:\MongoDB\bin\mongod.exe --service --config=E:\MongoDb\config\mongodb.conf&quot;</span><br></pre></td></tr></table></figure><h3 id="添加环境变量">添加环境变量</h3><p>此时进入至mongodb的目录才可以使用mongodb的命令行工具，如果在其他的目录，是不可以使用mongodb的命令行工具的，我们可以将mongodb的目录加入至环境变量，这样在任何位置都可以使用mongodb命令行工具了</p><p>将mongodb的bin目录加入至path环境变量中即可</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503184610.png" alt="image-20230503184609716"></p><h2 id="ubuntu安装mongodb">ubuntu安装mongodb</h2><h3 id="导入包管理系统使用的公钥">导入包管理系统使用的公钥</h3><p>从终端安装<code>gnupg</code>（如果尚不可用）</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install gnupg</span><br></pre></td></tr></table></figure><p>发出以下命令以导入 MongoDB 公共 GPG 密钥https://pgp.mongodb.com/server-6.0.asc：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -fsSL https://pgp.mongodb.com/server-6.0.asc | \</span><br><span class="line">   sudo gpg -o /usr/share/keyrings/mongodb-server-6.0.gpg \</span><br><span class="line">   --dearmor</span><br></pre></td></tr></table></figure><h3 id="为-mongodb-创建一个列表文件">为 MongoDB 创建一个列表文件</h3><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230502161557.png" alt="image-20230502161556772"></p><p><code>/etc/apt/sources.list.d/mongodb-org-6.0.list</code>为您的 Ubuntu 版本创建列表文件 。</p><p>单击适合您的 Ubuntu 版本的选项卡。如果您不确定主机正在运行哪个 Ubuntu 版本，请在主机上打开终端或 shell 并执行<code>lsb_release -dc</code>.</p><div class="tabs" id="mongodb-org-6.0.list"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#mongodb-org-6.0.list-1">Ubuntu 22.04 Jammy)</button></li><li class="tab"><button type="button" data-href="#mongodb-org-6.0.list-2">Ubuntu 20.04 (Focal)</button></li><li class="tab"><button type="button" data-href="#mongodb-org-6.0.list-3">Ubuntu 18.04 (Bionic)</button></li><li class="tab"><button type="button" data-href="#mongodb-org-6.0.list-4">Ubuntu 16.04 (Xenial)</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="mongodb-org-6.0.list-1"><p><code>/etc/apt/sources.list.d/mongodb-org-6.0.list</code> 为**Ubuntu 22.04 (Jammy)**创建 文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-6.0.gpg ] https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/6.0 multiverse&quot; | sudo tee /etc/apt/sources.list.d/mongodb-org-6.0.list</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="mongodb-org-6.0.list-2"><p><code>/etc/apt/sources.list.d/mongodb-org-6.0.list</code> 为**Ubuntu 20.04 (Focal)**创建 文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-6.0.gpg ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 multiverse&quot; | sudo tee /etc/apt/sources.list.d/mongodb-org-6.0.list</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="mongodb-org-6.0.list-3"><p><code>/etc/apt/sources.list.d/mongodb-org-6.0.list</code> 为**Ubuntu 18.04 (Bionic)**创建 文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-6.0.gpg ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/6.0 multiverse&quot; | sudo tee /etc/apt/sources.list.d/mongodb-org-6.0.list</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="mongodb-org-6.0.list-4"><p><code>/etc/apt/sources.list.d/mongodb-org-6.0.list</code> 为**Ubuntu 16.04 (Xenial)**创建 文件：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-6.0.gpg ] https://repo.mongodb.org/apt/ubuntu xenial/mongodb-org/6.0 multiverse&quot; | sudo tee /etc/apt/sources.list.d/mongodb-org-6.0.list</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="重新加载本地包数据库">重新加载本地包数据库</h3><p>发出以下命令重新加载本地包数据库：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><h3 id="安装-mongodb-包">安装 MongoDB 包</h3><div class="tabs" id="mongodb-org-6.0.list"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#mongodb-org-6.0.list-1">安装最新稳定版本的 MongoDB</button></li><li class="tab"><button type="button" data-href="#mongodb-org-6.0.list-2">安装特定版本的 MongoDB</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="mongodb-org-6.0.list-1"><p>要安装最新的稳定版本，请发出以下命令</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y mongodb-org</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="mongodb-org-6.0.list-2"><p>要安装特定版本，您必须单独指定每个组件包以及版本号，如下例所示：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install -y mongodb-org=6.0.7 mongodb-org-database=6.0.7 mongodb-org-server=6.0.7 mongodb-org-mongos=6.0.7 mongodb-org-tools=6.0.7</span><br></pre></td></tr></table></figure><p>如果您只安装<code>mongodb-org=6.0.7</code>而不包含组件包，则无论您指定哪个版本，都将安装每个 MongoDB 包的最新版本。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>尽管您可以指定 MongoDB 的任何可用版本， <code>apt-get</code>但当有新版本可用时将升级包。为了防止意外升级，您可以将软件包固定在当前安装的版本上：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;mongodb-org hold&quot; | sudo dpkg --set-selections</span><br><span class="line">echo &quot;mongodb-org-database hold&quot; | sudo dpkg --set-selections</span><br><span class="line">echo &quot;mongodb-org-server hold&quot; | sudo dpkg --set-selections</span><br><span class="line">echo &quot;mongodb-mongosh hold&quot; | sudo dpkg --set-selections</span><br><span class="line">echo &quot;mongodb-org-mongos hold&quot; | sudo dpkg --set-selections</span><br><span class="line">echo &quot;mongodb-org-tools hold&quot; | sudo dpkg --set-selections</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230502161939.png" alt="image-20230502161939006"></p><h2 id="docker-安装-mongodb">Docker 安装 MongoDB</h2><h3 id="拉取指定版本mongodb镜像">拉取指定版本MongoDB镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull mongo:4.4</span><br></pre></td></tr></table></figure><h3 id="运行容器">运行容器</h3><p>运行 mongo 容器：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name mongo -v 本地目录:/data/db -p 27017:27017 mongo:4.4 --auth</span><br></pre></td></tr></table></figure><p>参数说明：</p><ul><li><strong>-p 27017:27017</strong> ：映射容器服务的 27017(后) 端口到宿主机的 27017(前) 端口,外部可以直接通过 宿主机 ip:27017 访问到 mongo 的服务。</li><li><strong>–auth</strong>：需要密码才能访问容器服务。</li></ul><h3 id="进入容器-并进入到admin数据库">进入容器，并进入到admin数据库</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it mongo mongo admin</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230502170129.png" alt="image-20230502170128664"></p><h2 id="mongodb基础配置">mongodb基础配置</h2><h3 id="创建一个超级管理员root">创建一个超级管理员root</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.createUser(&#123;user: &quot;root&quot;,pwd: &quot;your password&quot;, roles: [ &#123; role: &quot;root&quot;, db: &quot;admin&quot; &#125; ]&#125;);</span><br><span class="line">db.createUser(&#123; user:&#x27;root&#x27;,pwd:&#x27;your password&#x27;,roles:[ &#123; role:&#x27;userAdminAnyDatabase&#x27;, db: &#x27;admin&#x27;&#125;,&#x27;readWriteAnyDatabase&#x27;]&#125;);</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230502162144.png" alt="image-20230502162144553"></p><h3 id="验证用户是否添加成功">验证用户是否添加成功</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.auth(&quot;root&quot;, &quot;your password&quot;) #如果返回1，则表示成功</span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230502162538.png" alt="image-20230502162537800"></p><h3 id="修改默认端口和希望外网访问-可选">修改默认端口和希望外网访问(可选)</h3><p><strong>vim /etc/mongodb.conf</strong></p><p>修改端口</p><p><strong>port=端口号</strong></p><p>外网访问</p><p>将<strong>bind_ip = 127.0.0.1</strong>修改<strong>bind_ip = 0.0.0.0</strong>，同时记得关闭防火墙</p><blockquote><p>开启服务</p></blockquote><p>sudo service mongodb start</p><blockquote><p>停止服务</p></blockquote><p>sudo service mongodb stop</p><blockquote><p>重启服务</p></blockquote><p>sudo service mongodb restart</p><p>修改端口后进入mongodb:<strong>mongo --port 端口号</strong></p><div class="tip warning faa-horizontal animated-hover"><p>必须另外创建自己的数据库和对应的用户，root数据库不能直接使用</p></div><h2 id="卸载-mongodb-社区版-ubuntu">卸载 MongoDB 社区版(ubuntu)</h2><h3 id="停止-mongodb">停止 MongoDB</h3><p><a href="https://www.mongodb.com/docs/manual/reference/program/mongod/#mongodb-binary-bin.mongod"><code>mongod</code></a>通过发出以下命令来停止该进程：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service mongod stop</span><br></pre></td></tr></table></figure><h3 id="删除包">删除包</h3><p>删除您之前安装的所有 MongoDB 软件包。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get purge mongodb-org*</span><br></pre></td></tr></table></figure><h3 id="删除数据目录">删除数据目录</h3><p>删除 MongoDB 数据库和日志文件。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -r /var/log/mongodb</span><br><span class="line">sudo rm -r /var/lib/mongodb</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;windows安装mongodb&quot;&gt;windows安装mongodb&lt;/h2&gt;
&lt;h3 id=&quot;下载文件&quot;&gt;下载文件&lt;/h3&gt;
&lt;p&gt;首先在mongodb的官方网站上下载最新版本的mongodb安装程序&lt;/p&gt;
&lt;p&gt;下载网址：&lt;a href=&quot;https://w</summary>
      
    
    
    
    <category term="安装" scheme="https://www.yuanyuan.blog/categories/%E5%AE%89%E8%A3%85/"/>
    
    
    <category term="mongodb" scheme="https://www.yuanyuan.blog/tags/mongodb/"/>
    
  </entry>
  
  <entry>
    <title>go基础开篇</title>
    <link href="https://www.yuanyuan.blog/posts/2a8a7182.html"/>
    <id>https://www.yuanyuan.blog/posts/2a8a7182.html</id>
    <published>2023-05-02T16:04:38.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<h2 id="hello-world">hello world</h2><p>作为每一门语言的入门，那必须是会打印<strong>hello world</strong></p><ol><li>hello.go</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;hello world!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>说明:</p><p>（1）go 文件的后缀是 .go</p><p>（2） package main<br>表示该 hello.go 文件所在的包是 main, 在 go 中，每个文件都必须归属于一个包。</p><p>（3）import “fmt”<br>表示：引入一个包，包名 fmt, 引入该包后，就可以使用 fmt 包的函数，比如：fmt.Println</p><p>（4）func 是一个关键字，表示一个函数。<br>main 是函数名，是一个主函数，即我们程序的入口。</p><p>（5）fmt.Println(“hello world!”)<br>表示调用 fmt 包的函数 Println 输出&quot;hello world!&quot;</p><ol start="2"><li><p>通过 go build 命令对该 go 文件进行编译，windows下生成 hello.exe 文件,linux下生成hello可执行文件</p></li><li><p>windows下运行 hello.exe,linux运行./hello即可</p></li><li><p>注意：通过 go run 命令可以直接运行 hello.go 程序 [类似执行一个脚本文件的形式]</p></li></ol><h3 id="golang-执行流程分析">Golang 执行流程分析</h3><blockquote><p>如果是对源码编译后，再执行，Go 的执行流程如下图</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503193432.png" alt="image-20230503193432455"></p><blockquote><p>如果我们是对源码直接 执行 go run 源码，Go 的执行流程如下图</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503193445.png" alt="image-20230503193445207"></p><blockquote><p>两种执行流程的方式区别</p></blockquote><ol><li>如果我们先编译生成了可执行文件，那么我们可以将该可执行文件拷贝到没有 go 开发环境的机<br>器上，仍然可以运行</li><li>如果我们是直接 go run<br>go 源代码，那么如果要在另外一个机器上这么运行，也需要 go 开发<br>环境，否则无法执行。</li><li>在编译时，编译器会将程序运行依赖的库文件包含在可执行文件中，所以，可执行文件变大了<br>很多。</li></ol><h3 id="编译和运行说明">编译和运行说明</h3><ol><li><p>有了 go 源文件，通过编译器将其编译成机器可以识别的二进制码文件。</p></li><li><p>在该源文件目录下，通过 go build对 hello.go文件进行编译。可以指定生成的可执行文件名，在windows下必须是 .exe 后缀。</p></li><li><p>如果程序没有错误，没有任何提示，会在当前目录下会出现一个可执行文件(windows 下是.exe<br>Linux 下是一个可执行文件)，该文件是二进制码文件，也是可以执行的程序。</p></li><li><p>如果程序有错误，编译时，会在错误的那行报错，有助于程序员调试错误.</p></li><li><p>运行有两种形式</p><p>windows下运行 hello.exe</p><p>linux运行./hello</p></li></ol><h3 id="go-程序开发的注意事项">Go 程序开发的注意事项</h3><ol><li>Go 源文件以 “.go” 为扩展名。</li><li>Go 应用程序的执行入口是 main()函数， 这个是和其它编程语言一样（比如 java/c）</li><li>Go 语言严格区分大小写。</li><li>Go 方法由一条条语句构成，每个语句后不需要分号(Go 语言会在每行后自动加分号)，这也体<br>现出Golang的简洁性。</li><li>Go 编译器是一行行进行编译的，因此我们一行就写一条语句，不能把多条语句写在同一个，否<br>则报错。</li><li>go 语言定义的变量或者 import 的包如果没有使用到，代码不能编译通过。</li><li>大括号都是成对出现的，缺一不可。</li></ol><h2 id="go-语言的转义字符-escape-char">Go 语言的转义字符(escape char)</h2><p>说明:常用的转义字符有如下:</p><ol><li><code>\t</code> : 表示一个制表符，通常使用它可以排版。</li><li><code>\n</code>：换行符</li><li><code>\\</code>：一个\</li><li><code>\&quot;</code>：一个&quot;</li><li><code>\r</code>：一个回车</li></ol><p>案例：</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503194340.png" alt="image-20230503194340298"></p><details class="folding-tag" green><summary> 查看代码测试 </summary>              <div class='content'>              <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;姓名\t 年龄\t 籍贯\t 地址\njohn\t20\t 河北\t 北京&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><h2 id="注释-comment">注释(comment)</h2><h3 id="介绍">介绍</h3><p>用于注解说明解释程序的文字就是注释，注释提高了代码的阅读性；<br>注释是一个程序员必须要具有的良好编程习惯。将自己的思想通过注释先整理出来，再用代码去<br>体现。</p><h3 id="在-golang-中注释有两种形式">在 Golang 中注释有两种形式</h3><ol><li>行注释</li></ol><blockquote><p>基本语法<br>// 注释内容</p></blockquote><ol start="2"><li><p>块注释(多行注释)</p><blockquote><p>基本语法<br>/*<br>注释内容<br>*/</p></blockquote></li></ol><p>使用细节</p><ol><li>对于行注释和块注释，被注释的文字，不会被 Go 编译器执行。</li><li><strong>块注释里面不允许有块注释嵌套</strong></li></ol><h2 id="规范的代码风格">规范的代码风格</h2><h3 id="正确的注释和注释风格：">正确的注释和注释风格：</h3><p>Go 官方推荐使用行注释来注释整个方法和语句。</p><h3 id="正确的缩进和空白">正确的缩进和空白</h3><ol><li>使用一次 tab 操作，实现缩进，默认整体向右边移动，时候用 shift+tab 整体向左移</li><li>或者使用 gofmt 来进行格式化</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gofmt -w main.go <span class="comment"># 该命令可以将格式化后的内容重新写入到文件</span></span><br></pre></td></tr></table></figure><ol start="3"><li><p>运算符两边习惯性各加一个空格。比如：2 + 4 * 5。</p></li><li><p>Go 语言的代码风格</p></li></ol>  <div class="tabs" id="style"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#style-1">正确写法</button></li><li class="tab"><button type="button" data-href="#style-2">错误写法</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="style-1"><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;hello,world!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="style-2"><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line">&#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;hello,world!&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>​Go 设计者思想: <strong>一个问题尽量只有一个解决方法</strong></p><ol start="5"><li>一行最长不超过 80 个字符，超过的请使用换行展示，尽量保持格式优雅</li></ol><h2 id="golang-官方编程指南">Golang 官方编程指南</h2><div class='tag-link-1'><a class="tag-Link" target="_blank" href=" https://go.dev/">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://api.iowen.cn/favicon/go.dev/.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">Golang 官方网站</div>            <div class="tag-link-sitename"> https://go.dev/</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div><p>Golang 官方标准库 API 文档，<a href="https://golang.org/pkg">https://golang.org/pkg</a> 可以查看 Golang 所有包下的函数和使用</p><h2 id="golang-标准库-api-文档">Golang 标准库 API 文档</h2><ol><li>API （Application Programming Interface,应用程序编程接口）是 Golang 提供的基本编程接口。</li><li>Go 语言提供了大量的标准库，因此 google 公司 也为这些标准库提供了相应的 API 文档，用于告<br>诉开发者如何使用这些标准库，以及标准库包含的方法。</li><li>Golang 中文网 在线标准库文档： <a href="https://studygolang.com/pkgdoc">https://studygolang.com/pkgdoc</a></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;hello-world&quot;&gt;hello world&lt;/h2&gt;
&lt;p&gt;作为每一门语言的入门，那必须是会打印&lt;strong&gt;hello world&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;hello.go&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&quot;high</summary>
      
    
    
    
    <category term="编程基础" scheme="https://www.yuanyuan.blog/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="golang" scheme="https://www.yuanyuan.blog/tags/golang/"/>
    
  </entry>
  
  <entry>
    <title>golang开篇</title>
    <link href="https://www.yuanyuan.blog/posts/67893972.html"/>
    <id>https://www.yuanyuan.blog/posts/67893972.html</id>
    <published>2023-04-30T19:22:32.000Z</published>
    <updated>2024-01-14T15:51:58.798Z</updated>
    
    <content type="html"><![CDATA[<h2 id="什么是golang">什么是Golang</h2><p>Golang（也称为Go）是一种开源编程语言，由Google开发。它结合了静态编译语言的性能和动态语言的开发效率，适用于构建可靠、高效、并发的软件。</p><p>Golang的设计目标是简单、高效、可靠。它支持并发编程，内置垃圾回收机制，具有强大的标准库和丰富的第三方库支持，同时还具有良好的跨平台支持。Golang的语法简洁明了，易于学习和使用，同时支持面向对象编程和函数式编程。</p><p>Golang被广泛应用于构建Web应用、网络服务、分布式系统、云计算等领域。它已经成为了一种流行的编程语言，并且在不断发展和完善。</p><h2 id="golang-的学习方向">Golang 的学习方向</h2><ol><li><p>区块链研发工程师</p></li><li><p>Go服务器端/游戏软件工程师</p></li><li><p>Golang分布式/云计算软件工程师</p></li></ol><h2 id="golang应用领域">Golang应用领域</h2><ol><li>区块链的应用开发</li><li>后台的服务应用</li><li>云计算/云服务后台应用</li></ol><h2 id="go-语言的诞生">Go 语言的诞生</h2><h3 id="go-语言的核心开发团队-三个大牛">Go 语言的核心开发团队-三个大牛</h3><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230430212145.png" alt="image-20230430212144529"></p><h3 id="google-创造-golang-的原因">Google 创造 Golang 的原因</h3><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230430212324.png" alt="image-20230430212324319"></p><h3 id="golang-的发展历程">Golang 的发展历程</h3><ul><li>2007 年，谷歌工程师 Rob Pike, Ken Thompson 和 Robert Griesemer 开始设计一门全新的语言，这是Go 语言的最初原型。</li><li>2009 年 11 月 10 日，Google 将 Go 语言以开放源代码的方式向全球发布。</li><li>2015 年 8 月 19 日，Go 1.5 版发布，本次更新中移除了”最后残余的 C 代码”</li><li>2017 年 2 月 17 日，Go 语言 Go 1.8 版发布。</li><li>2017 年 8 月 24 日，Go 语言 Go 1.9 版发布。 1.9.2 版本</li><li>2018 年 2 月 16 日，Go 语言 Go 1.10 版发布。</li></ul><h2 id="golang-的语言的特点">Golang 的语言的特点</h2><blockquote><p>简介：</p></blockquote><p>Go 语言保证了既能到达静态编译语言的安全和性能，又达到了动态语言开发维护的高效率，使用一个表达式来形容 Go 语言：Go = C + Python , 说明 Go 语言既有 C 静态语言程序的运行速度，又能达到 Python 动态语言的快速开发。</p><ol><li>C 语言中继承了很多理念，包括表达式语法，控制结构，基础数据类型，调用参数传值，指针等<br>等，也保留了和 C 语言一样的编译执行方式及弱化的指针<br>举一个案例(体验)：</li></ol>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//go 语言的指针的使用特点</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testPtr</span><span class="params">(num *<span class="type">int</span>)</span></span> &#123;</span><br><span class="line">*num = <span class="number">20</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>引入<em>包的概念</em>，用于组织程序结构，<em>Go 语言的一个文件都要归属于一个包</em>，而不能单独存在。</li></ol><ol start="3"><li><p>垃圾回收机制，内存自动回收，不需开发人员管理</p></li><li><p>天然并发 (重要特点)<br>(1) 从语言层面支持并发，实现简单<br>(2) goroutine，轻量级线程，可实现大并发处理，高效利用多核。<br>(3) 基于 CPS 并发模型(Communicating Sequential Processes )实现</p></li><li><p>吸收了管道通信机制，形成 Go 语言特有的管道 channel 通过管道 channel , 可以实现不同的 goroute之间的相互通信。</p></li><li><p>函数可以返回多个值。举例：</p></li></ol>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//写一个函数，实现同时返回 和，差</span></span><br><span class="line"><span class="comment">//go 函数支持返回多个值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSumAndSub</span><span class="params">(n1 <span class="type">int</span>, n2 <span class="type">int</span>)</span></span> (<span class="type">int</span>, <span class="type">int</span> ) &#123;</span><br><span class="line">sum := n1 + n2 <span class="comment">//go 语句后面不要带分号.</span></span><br><span class="line">sub := n1 - n2</span><br><span class="line"><span class="keyword">return</span> sum , sub</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="7"><li>新的创新：比如切片 slice、延时执行 defer</li></ol><h2 id="搭建go开发环境">搭建go开发环境</h2><h3 id="下载-sdk-工具包">下载 SDK 工具包</h3><ol><li>Go 语言的官网为：<a href="https://go.dev/">https://go.dev/</a></li><li>SDK 下载地址：<a href="https://golang.google.cn/dl/">https://golang.google.cn/dl/</a></li><li>选择os对应的 sdk 版本(建议使用stable versions即稳定版)</li></ol><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230503190154.png" alt="image-20230503190154398"></p><h3 id="windows下搭建go开发环境">windows下搭建go开发环境</h3><h4 id="安装">安装</h4><p>这里以<strong>go1.20.4.windows-amd64.zip</strong>为例</p><p>下载完后解压缩后会得到 go 文件夹，其中 <code>/bin</code> 目录包含了 go 源码包编译出的编译器（go）、文档工具（godoc）、格式化工具（gofmt），即是我们要进行配置的目录。</p><h4 id="配置环境变量">配置环境变量</h4><p>我们需要添加两个环境变量：</p><blockquote><p>GOROOT：SDK 的根目录，即解压缩后 go 文件夹所在的路径（例如 D:\GoEnv\go）<br>GOPATH：工作目录，即以后我们的 go 项目的工作路径，可以随意地址一个目录；</p></blockquote><p>同时还需要把 SDK 下的 /bin 目录添加到系统 Path 环境变量下，添加完成后在 cmd 中输入 go version 命令检查是否配置成功：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; go version</span><br><span class="line">go version go1.20.4 windows/amd64</span><br></pre></td></tr></table></figure><p>同时可以使用 <code>go env</code> 查看我们配置的环境变量：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; go <span class="built_in">env</span></span><br><span class="line">...</span><br><span class="line"><span class="built_in">set</span> GOPATH=E:\GoProject</span><br><span class="line"><span class="built_in">set</span> GOROOT=D:\GoEnv\go</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h4 id="配置-go-代理">配置 Go 代理</h4><p>通过 go get 命令下载各种依赖时，经常需要访问 github/google 等网站，这些网站访问速度可能会比较慢，所以我们可以进行配置代理，保证快速稳定的下载访问。</p><p>这里推荐 <a href="http://goproxy.io">goproxy.io</a>，它是全球最早的 Go modules 镜像代理服务之一，采用 CDN 加速服务为开发者提供依赖下载， 该服务由一批热爱开源，热爱 Go 语言的年轻人开发维护。</p><p>配置的方式就是在用户变量或系统变量下添加 GOPROXY 环境变量，变量值填写 <a href="https://goproxy.io">https://goproxy.io</a>,direct，添加完成后，可以再次使用 go env 命令查看到该环境变量：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; go <span class="built_in">env</span></span><br><span class="line">...</span><br><span class="line"><span class="built_in">set</span> GOPROXY=https://goproxy.io,direct</span><br><span class="line">... </span><br></pre></td></tr></table></figure><h3 id="linux下搭建go开发环境">Linux下搭建go开发环境</h3><p>以<code>go1.20.4.linux-amd64.tar.gz</code>为例</p><h4 id="解压">解压</h4><p>使用命令 <code>tar -xzvf go1.20.4.linux-amd64.tar.gz</code> 解压</p><h4 id="配置">配置</h4><p>打开<code>~/.bashrc</code>或<code>/etc/profile</code>文件，写入如下配置：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export GOPATH=$HOME/GOPATH  # $HOME/GOPATH为工作目录，即以后我们的 go 项目的工作路径</span><br><span class="line">export GOROOT=/usr/local/go # SDK 的根目录，即解压缩后 go 文件夹所在的路径</span><br><span class="line">export PATH=$GOPATH/bin:$GOROOT/bin:$PATH</span><br></pre></td></tr></table></figure><p>保存后执行<code>source ~/.bashrc</code>使配置生效</p><h4 id="测试">测试</h4><p>在命令行执行<code>go version</code> 如果能够显示正确的版本号则证明配置成功。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;什么是golang&quot;&gt;什么是Golang&lt;/h2&gt;
&lt;p&gt;Golang（也称为Go）是一种开源编程语言，由Google开发。它结合了静态编译语言的性能和动态语言的开发效率，适用于构建可靠、高效、并发的软件。&lt;/p&gt;
&lt;p&gt;Golang的设计目标是简单、高效、可靠。</summary>
      
    
    
    
    <category term="编程基础" scheme="https://www.yuanyuan.blog/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"/>
    
    
    <category term="golang" scheme="https://www.yuanyuan.blog/tags/golang/"/>
    
  </entry>
  
  <entry>
    <title>ubuntu22.04更新cmake</title>
    <link href="https://www.yuanyuan.blog/posts/170c5cd0.html"/>
    <id>https://www.yuanyuan.blog/posts/170c5cd0.html</id>
    <published>2023-04-05T15:43:17.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<h2 id="检查是否安装cmake">检查是否安装<code>cmake</code></h2><p>查看<code>cmake</code>版本：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cmake --version</span><br></pre></td></tr></table></figure><p>如果输出如下，表示未安装<code>cmake</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo: cmake: command not found</span><br></pre></td></tr></table></figure><h2 id="使用apt-get安装cmake">使用apt-get安装<code>cmake</code></h2><p>注意：使用<code>apt-get</code>安装的是低版本的<code>cmake</code>。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get -y install cmake</span><br></pre></td></tr></table></figure><p>查看版本，如下：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo cmake --version</span><br><span class="line">cmake version 3.16.3</span><br></pre></td></tr></table></figure><p>很多时候，低版本的<code>cmake</code>并不能满足我们的需求。</p><p>卸载<code>apt-get</code>安装的<code>cmake</code>：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt -y remove cmake</span><br></pre></td></tr></table></figure><h2 id="源码安装指定版本cmake">源码安装指定版本<code>cmake</code></h2><p>通过源码安装，我们可以安装指定版本的<code>cmake</code>。</p><p><code>cmake</code>官方为我们提供了各个版本的源码包，列表链接为：</p><div class='tag-link-1'><a class="tag-Link" target="_blank" href=" https://cmake.org/files">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://api.iowen.cn/favicon/cmake.org/files.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">cmake官网</div>            <div class="tag-link-sitename"> https://cmake.org/files</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230405155802.png" alt="image-20230405154931293"></p><p>访问源码包列表链接，可以选择我们指定的版本下载安装。</p><p>目前最新版本是<code>cmake 3.26.3</code>。</p><h3 id="下载cmake-3-26-3">下载<code>cmake 3.26.3 </code></h3><p>在喜欢的路径下，执行:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo wget https://cmake.org/files/LatestRelease/cmake-3.26.3.tar.gz</span><br></pre></td></tr></table></figure><h3 id="解压">解压</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tar -zxvf cmake-3.26.3.tar.gz</span><br></pre></td></tr></table></figure><p>解压后，会在当前路径下生成一个<code>cmake-3.26.3</code>文件夹。</p><p>进入<code>cmake-3.23.0</code>文件夹中：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd cmake-3.23.0</span><br></pre></td></tr></table></figure><h3 id="安装">安装</h3><p><strong>第一步：</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./configure</span><br></pre></td></tr></table></figure><p>如果报错<code>Could NOT find OpenSSL</code></p><p>解决：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get -y install libssl-dev</span><br></pre></td></tr></table></figure><p>然后，重新执行:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./configure </span><br></pre></td></tr></table></figure><p><strong>第二步：</strong></p><p>执行<code>make</code>:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo make -j8 </span><br></pre></td></tr></table></figure><p><strong>第三步：</strong></p><p>执行<code>make install</code>:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo make install</span><br></pre></td></tr></table></figure><p>验证是否安装成功：</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/20230405160206.png" alt="image-20230405160205894"></p><p>如果看到版本号，表示安装成功！</p><h2 id="卸载源码安装的cmake">卸载源码安装的<code>cmake</code></h2><p>注意，<code>sudo apt remove cmake</code> 命令无法卸载源码安装的<code>cmake</code>。</p><p>如需卸载源码安装的<code>cmake</code>，需要进入到安装时执行<code>make install</code>时的路径下， 执行卸载命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo make uninstall</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;检查是否安装cmake&quot;&gt;检查是否安装&lt;code&gt;cmake&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;查看&lt;code&gt;cmake&lt;/code&gt;版本：&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutt</summary>
      
    
    
    
    <category term="安装" scheme="https://www.yuanyuan.blog/categories/%E5%AE%89%E8%A3%85/"/>
    
    
    <category term="cmake" scheme="https://www.yuanyuan.blog/tags/cmake/"/>
    
  </entry>
  
  <entry>
    <title>前端框架</title>
    <link href="https://www.yuanyuan.blog/posts/89e03522.html"/>
    <id>https://www.yuanyuan.blog/posts/89e03522.html</id>
    <published>2023-03-31T16:09:20.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<h1 id="webpack-构建-vue3项目">webpack 构建 Vue3项目</h1><h3 id="1-初始化项目结构-跟cli-结构保持一致">1.初始化项目结构（跟cli 结构保持一致）</h3><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202304011622487.png" alt="image-20230401162245300"></p><h3 id="2-安装所需要的依赖包">2.安装所需要的依赖包</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack-vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack.config.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;dev&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack-dev-server&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;webpack&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;keywords&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@vue/compiler-sfc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.2.38&quot;</span><span class="punctuation">,</span> <span class="comment">//解析vue文件</span></span><br><span class="line">        <span class="attr">&quot;clean-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.0.0&quot;</span><span class="punctuation">,</span> <span class="comment">//打包 的时候清空dist</span></span><br><span class="line">        <span class="attr">&quot;css-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^6.7.1&quot;</span><span class="punctuation">,</span> <span class="comment">//处理css文件</span></span><br><span class="line">        <span class="attr">&quot;friendly-errors-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.7.0&quot;</span><span class="punctuation">,</span> <span class="comment">//美化dev</span></span><br><span class="line">        <span class="attr">&quot;html-webpack-plugin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.5.0&quot;</span><span class="punctuation">,</span> <span class="comment">//html 模板</span></span><br><span class="line">        <span class="attr">&quot;less&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.1.3&quot;</span><span class="punctuation">,</span>  <span class="comment">//处理less</span></span><br><span class="line">        <span class="attr">&quot;less-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^11.0.0&quot;</span><span class="punctuation">,</span> <span class="comment">//处理less文件</span></span><br><span class="line">        <span class="attr">&quot;style-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.3.1&quot;</span><span class="punctuation">,</span> <span class="comment">//处理style样式</span></span><br><span class="line">        <span class="attr">&quot;ts-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^9.3.1&quot;</span><span class="punctuation">,</span> <span class="comment">//处理ts</span></span><br><span class="line">        <span class="attr">&quot;typescript&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.8.2&quot;</span><span class="punctuation">,</span> <span class="comment">//ts</span></span><br><span class="line">        <span class="attr">&quot;vue&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^3.2.38&quot;</span><span class="punctuation">,</span> <span class="comment">//vue</span></span><br><span class="line">        <span class="attr">&quot;vue-loader&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^17.0.0&quot;</span><span class="punctuation">,</span> <span class="comment">//解析vue</span></span><br><span class="line">        <span class="attr">&quot;webpack&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^5.74.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;webpack-cli&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.10.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;webpack-dev-server&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.10.0&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="3-tsc-init-生成ts-文件-如果没有tsc-安装npm-install-typescript-g">3.tsc --init 生成ts 文件 如果没有tsc 安装npm install typescript -g</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;compilerOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;target&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esnext&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;esnext&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;strict&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;jsx&quot;</span><span class="punctuation">:</span> <span class="string">&quot;preserve&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;importHelpers&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;moduleResolution&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;skipLibCheck&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;esModuleInterop&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;allowSyntheticDefaultImports&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sourceMap&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;src/*&quot;</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;lib&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;esnext&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;dom&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;dom.iterable&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;scripthost&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;include&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;src/**/*.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;src/**/*.tsx&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;src/**/*.vue&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;tests/**/*.ts&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;tests/**/*.tsx&quot;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;exclude&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;node_modules&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="4-配置vue-声明文件不然ts-识别不了vue-后缀">4.配置vue 声明文件不然ts 识别不了vue 后缀</h3><p>在<code>src</code>目录下新建<code>env.d.ts</code></p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202304011626379.png" alt="image-20230401162653337"></p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 配置vue 声明文件不然ts 识别不了vue 后缀</span></span><br><span class="line"><span class="keyword">declare</span> <span class="variable language_">module</span> <span class="string">&quot;*.vue&quot;</span> &#123;</span><br><span class="line">    <span class="keyword">import</span> &#123; <span class="title class_">DefineComponent</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line">    <span class="keyword">const</span> <span class="attr">component</span>:<span class="title class_">DefineComponent</span>&lt;&#123;&#125;,&#123;&#125;,<span class="built_in">any</span>&gt;</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> component</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-编写webpack-config-js">5.编写webpack.config.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Configuration</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;webpack&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">CleanWebpackPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;clean-webpack-plugin&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">VueLoaderPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;vue-loader/dist/index&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">FriendlyErrorsWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;friendly-errors-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@type</span> &#123;<span class="type">Configuration</span>&#125; //配置智能提示</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&quot;development&quot;</span>,</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/main.ts&#x27;</span>, <span class="comment">//入口文件</span></span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;[hash].js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;dist&#x27;</span>) <span class="comment">//出口文件</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="attr">rules</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.vue$/</span>, <span class="comment">//解析vue 模板</span></span><br><span class="line">                <span class="attr">use</span>: <span class="string">&quot;vue-loader&quot;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="comment">//解析 less</span></span><br><span class="line">                <span class="attr">use</span>: [<span class="string">&quot;style-loader&quot;</span>, <span class="string">&quot;css-loader&quot;</span>, <span class="string">&quot;less-loader&quot;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="comment">//解析css</span></span><br><span class="line">                <span class="attr">use</span>: [<span class="string">&quot;style-loader&quot;</span>, <span class="string">&quot;css-loader&quot;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.ts$/</span>,  <span class="comment">//解析ts</span></span><br><span class="line">                <span class="attr">loader</span>: <span class="string">&quot;ts-loader&quot;</span>,</span><br><span class="line">                <span class="attr">options</span>: &#123;</span><br><span class="line">                    <span class="attr">configFile</span>: path.<span class="title function_">resolve</span>(process.<span class="title function_">cwd</span>(), <span class="string">&#x27;tsconfig.json&#x27;</span>),</span><br><span class="line">                    <span class="attr">appendTsSuffixTo</span>: [<span class="regexp">/\.vue$/</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="keyword">new</span> <span class="title function_">htmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./public/index.html&quot;</span> <span class="comment">//html模板</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">CleanWebpackPlugin</span>(), <span class="comment">//打包清空dist</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">VueLoaderPlugin</span>(), <span class="comment">//解析vue</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">FriendlyErrorsWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">compilationSuccessInfo</span>:&#123; <span class="comment">//美化样式</span></span><br><span class="line">                <span class="attr">messages</span>:[<span class="string">&#x27;You application is running here http://localhost:9001&#x27;</span>]</span><br><span class="line">            &#125;</span><br><span class="line">           </span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">resolve</span>: &#123;</span><br><span class="line">        <span class="attr">alias</span>: &#123;</span><br><span class="line">            <span class="string">&quot;@&quot;</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./src&#x27;</span>) <span class="comment">// 别名</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">extensions</span>: [<span class="string">&#x27;.js&#x27;</span>, <span class="string">&#x27;.json&#x27;</span>, <span class="string">&#x27;.vue&#x27;</span>, <span class="string">&#x27;.ts&#x27;</span>, <span class="string">&#x27;.tsx&#x27;</span>] <span class="comment">//识别后缀</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">stats</span>:<span class="string">&quot;errors-only&quot;</span>, <span class="comment">//取消提示</span></span><br><span class="line">    <span class="attr">devServer</span>: &#123;</span><br><span class="line">        <span class="attr">proxy</span>: &#123;&#125;,</span><br><span class="line">        <span class="attr">port</span>: <span class="number">9001</span>,</span><br><span class="line">        <span class="attr">hot</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">open</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">externals</span>: &#123;</span><br><span class="line">        <span class="attr">vue</span>: <span class="string">&quot;Vue&quot;</span> <span class="comment">//CDN 引入</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = config</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;webpack-构建-vue3项目&quot;&gt;webpack 构建 Vue3项目&lt;/h1&gt;
&lt;h3 id=&quot;1-初始化项目结构-跟cli-结构保持一致&quot;&gt;1.初始化项目结构（跟cli 结构保持一致）&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://cdn.jsdeli</summary>
      
    
    
    
    <category term="前端" scheme="https://www.yuanyuan.blog/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="前端框架" scheme="https://www.yuanyuan.blog/tags/%E5%89%8D%E7%AB%AF%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title>gitignore文件</title>
    <link href="https://www.yuanyuan.blog/posts/843cc845.html"/>
    <id>https://www.yuanyuan.blog/posts/843cc845.html</id>
    <published>2023-03-31T15:52:43.000Z</published>
    <updated>2024-01-14T15:51:58.798Z</updated>
    
    <content type="html"><![CDATA[<p>在本地的代码目录中，有些文件或者目录我们并不想提交到仓库中，比如一些运行日志等文件。这样的话，我们提交代码时，就只能一个一个文件去<code>git add</code>，太麻烦了。</p><p>为了解决这个问题，Git里面有一个<code>.gitignore</code>文件。可以指定Git需要忽略哪些文件。配置好之后，Git就会自动忽略满足配置的文件。这样，我们就可以尽情的使用<code>git add .</code>来添加文件了。</p><h2 id="git-忽略规则优先级">Git 忽略规则优先级</h2><p>在 <code>.gitingore</code> 文件中，每一行指定一个忽略规则，Git 检查忽略规则的时候有多个来源，它的优先级如下（由高到低）：</p><ol><li>从命令行中读取可用的忽略规则</li><li>当前目录定义的规则</li><li>父级目录定义的规则，依次递推</li><li><code>$GIT_DIR/info/exclude</code> 文件中定义的规则</li><li><code>core.excludesfile</code>中定义的全局规则</li></ol><h2 id="git-忽略规则匹配语法">Git 忽略规则匹配语法</h2><p>在 <code>.gitignore</code> 文件中，每一行的忽略规则的语法如下：</p><ul><li>空格不匹配任意文件，可作为分隔符，可用反斜杠转义</li><li>开头的文件标识注释，可以使用反斜杠进行转义</li><li><code>!</code>开头的模式标识否定，该文件将会再次被包含，如果排除了该文件的父级目录，则使用<code>!</code>也不会再次被包含。可以使用反斜杠进行转义</li><li><code>/</code>结束的模式只匹配文件夹以及在该文件夹路径下的内容，但是不匹配该文件</li><li><code>/</code>开始的模式匹配项目跟目录</li><li>如果一个模式不包含斜杠，则它匹配相对于当前<code>.gitignore</code>文件路径的内容，如果该模式不在<code>.gitignore</code>文件中，则相对于项目根目录</li><li><code>**</code> 匹配多级目录，可在开始，中间，结束</li><li><code>?</code> 通用匹配单个字符</li><li><code>*</code> 通用匹配零个或多个字符</li><li><code>[]</code> 通用匹配单个字符列表</li></ul><h2 id="匹配示例">匹配示例</h2><ul><li><code>bin/</code>: 忽略当前路径下的<code>bin</code>文件夹，该文件夹下的所有内容都会被忽略，不忽略<code>bin</code>文件</li><li><code>/bin</code>: 忽略根目录下的bin文件</li><li><code>/*.c</code>: 忽略 <code>cat.c</code>，不忽略 <code>build/cat.c</code></li><li><code>debug/*.obj</code>: 忽略 <code>debug/io.obj</code>，不忽略 <code>debug/common/io.obj</code> 和 <code>tools/debug/io.obj</code></li><li><code>**/foo</code>: 忽略<code>/foo</code>, <code>a/foo</code>, <code>a/b/foo</code>等</li><li><code>a/**/b</code>: 忽略<code>a/b</code>, <code>a/x/b</code>, <code>a/x/y/b</code>等</li><li><code>!/bin/run.sh</code>: 不忽略 <code>bin</code> 目录下的 <code>run.sh</code> 文件</li><li><code>*.log</code>: 忽略所有 <code>.log</code> 文件</li><li><code>config.php</code>: 忽略当前路径的 <code>config.php</code> 文件</li></ul><h2 id="特殊情况">特殊情况</h2><h3 id="文件已经提交过">文件已经提交过</h3><p>这里面有一些特殊情况需要考虑，比如某文件已经被提交过了，之后再对他做了一个<code>.gitignore</code>的忽略的话。忽略是不会生效的，需要我们手动先将缓存删除。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除本地的缓存</span></span><br><span class="line">git rm -r --cached .</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重新提交</span></span><br><span class="line">git commit -am &#x27;gitignore&#x27;</span><br></pre></td></tr></table></figure><h3 id="添加一个已经配置忽略的文件">添加一个已经配置忽略的文件</h3><p>再比如，我们忽略了文件夹A，但是现在要往文件夹A中添加代码文件。你会发现你没法把文件夹A中的代码提交。因为文件夹A被忽略了。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">强制添加</span></span><br><span class="line">git add -f 文件A/xxx.js</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">正常提交</span></span><br><span class="line">git commit -am &#x27;xxx&#x27;</span><br></pre></td></tr></table></figure><h2 id="检查文件为什么被忽略">检查文件为什么被忽略</h2><p>由于<code>.gitignore</code>文件经常会配置很多内容，某些文件你并不能很直观的知道为什么被忽略了。所以Git提供了一个检查忽略的命令。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git check-ignore -v 文件夹A/xxx.js</span><br></pre></td></tr></table></figure><h2 id="最后附一个官方示例">最后附一个官方示例</h2><div class='tag-link-1'><a class="tag-Link" target="_blank" href=" https://github.com/github/gitignore">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://api.iowen.cn/favicon/github.com/github/gitignore.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">官方示例</div>            <div class="tag-link-sitename"> https://github.com/github/gitignore</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;在本地的代码目录中，有些文件或者目录我们并不想提交到仓库中，比如一些运行日志等文件。这样的话，我们提交代码时，就只能一个一个文件去&lt;code&gt;git add&lt;/code&gt;，太麻烦了。&lt;/p&gt;
&lt;p&gt;为了解决这个问题，Git里面有一个&lt;code&gt;.gitignore&lt;/cod</summary>
      
    
    
    
    <category term="运维" scheme="https://www.yuanyuan.blog/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="git" scheme="https://www.yuanyuan.blog/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>sass</title>
    <link href="https://www.yuanyuan.blog/posts/dcc57bca.html"/>
    <id>https://www.yuanyuan.blog/posts/dcc57bca.html</id>
    <published>2023-03-30T13:22:21.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言">前言</h2><p>说到css，相信大家都知道，css样式是用来修饰网页页面结构的。对于一名前端来说写好css并不难，但如何写出优雅可复用、易重构的css代码并不容易。</p><p>于是css预处理器便出现在大家的视线里，分别是 <code>stylus</code>、<code>less</code>、<code>sass</code>。它们的出现让编写css更加像JavaScript一样具有严谨性、编程性。</p><p>在此对<code>Stylus</code>、<code>Less</code>就不做多叙述了，如果小伙伴对其他两种感兴趣，可以访问 <a href="https://stylus-lang.com/">Stylus官网</a> 、<a href="https://lesscss.cn/">Less官网</a>了解更多哦。</p><h2 id="sass背景">Sass背景</h2><p>Sass（<code>Syntactically Awesome Style Sheets</code>），套用<a href="https://www.sass.hk/">sass官网</a>的牛逼介绍：“Sass是世界上最成熟、最稳定、最强大的专业级CSS扩展语言！”。是一个相对新的css预编译框架，为前端开发而生。</p><h2 id="为什么使用sass">为什么使用Sass?</h2><p>通过Sass编写css代码，你可以减少冗余的css代码，编写更加语义化的css，它扩展了css的能力，增加变量、嵌套css规则、混合器、继承、函数等新特性。</p><h2 id="sass-vs-scss">.sass vs .scss ?</h2><p>早已Sass出现的时候，是没有Scss的，Sass语法跟原生css不尽相同。使用缩进代替括号，没有分号。有些开发者并不适应这种写法，于是在Sass发布的3.0版本后官方提出修改，将文件后缀名以<code>.sass</code>改成了<code>.scss</code>,语法也更贴切原生css，让开发者可以像原来写css一样愉快的写scss。<code>scss</code>对应<code>css</code>就像<code>typescript</code>是<code>JavaScript</code>的超集一样的关系。</p><h2 id="sass安装">Sass安装</h2><p>关于Sass安装网上有很多详细教程，推荐几篇典型的安装教程文章。<br><a href="https://www.sass.hk/install/">Sass官网安装教程</a></p><h2 id="sass在node-js编译环境的安装">Sass在<code>node.js</code>编译环境的安装</h2><ol><li><p>在 nodejs 的平台下面，我们需要安装<code>node-sass</code>模块，通过这个模块，我们可以将 <code>scss</code> 文件转换成<code>css</code> 文件</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install node-sass <span class="attr">--save</span></span><br></pre></td></tr></table></figure></li><li><p>安装完成以后，我们新建一个文件，名为<code>index.scss</code>文件</p></li><li><p>使用<code>node-sass</code>的语法来编译<code>index.scss</code>,具体语法如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node-sass --watch src/index.scss dist/index.css</span><br></pre></td></tr></table></figure></li><li><p>如果我们需要监控一个文件夹下面所有的文件，则需要使用如下的语法格式</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">node-sass  -w -r &lt;源文件夹&gt; -o &lt;目标文件夹&gt;    <span class="comment">//它只会跟踪同名文件，没有则新建</span></span><br><span class="line">-w, <span class="attr">--watch</span>                Watch <span class="selector-tag">a</span> directory or file <span class="comment">//监听</span></span><br><span class="line">-r, <span class="attr">--recursive</span>            Recursively watch directories or files  <span class="comment">//递归地查看目录或文件</span></span><br><span class="line">-o, <span class="attr">--output</span>               Output directory <span class="comment">//输出目录</span></span><br></pre></td></tr></table></figure></li><li><p>为了能够方法的执行我们的<code>node-sass</code>语法，我们一般会把编译命令写在 <code>package.json</code>的配置文件下面，如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sass-demo&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;sass练习&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sass&quot;</span><span class="punctuation">:</span> <span class="string">&quot;node-sass --watch ./src/index.scss ./src/index.css&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;keywords&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;luckydong&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ISC&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;node-sass&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^4.9.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="1-sass变量">1、 Sass变量</h2><h3 id="1-1-变量声明与引用">1.1 变量声明与引用</h3><p><code>sass</code>变量声明和<code>css</code>属性声明很像：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$theme-<span class="attribute">color</span>: <span class="number">#fff</span>;</span><br></pre></td></tr></table></figure><p>这意味着变量<code>$theme-color</code>现在的值是<code>#fff</code>。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$theme-<span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  $<span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: $height;</span><br><span class="line">  <span class="attribute">color</span>: $theme-color;</span><br><span class="line">&#125;</span><br><span class="line">//编译后</span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在这段代码中，<code>$theme-color</code>这个变量定义在规则块外边，所以在这个样式表中都可以像 <code>div</code>规则块那样引用它。</p><h3 id="1-2-默认变量">1.2 默认变量</h3><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$defaultWidth</span>: <span class="number">100px</span>; <span class="comment">//全局变量</span></span><br><span class="line"><span class="variable">$defaultWidth</span>: <span class="number">200px</span> !default;</span><br><span class="line"><span class="selector-class">.div1</span> &#123;</span><br><span class="line">  <span class="variable">$height</span>: <span class="number">50px</span>; <span class="comment">//定义变量  局部变量</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="variable">$defaultWidth</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="variable">$height</span>; <span class="comment">//引用变量</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.div2</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="variable">$defaultWidth</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注意：在<code>Scss</code>语法里面，变量分为全局变量与局部变量，变量加上<code>!default</code> 以后就是默认变量</p></blockquote><h2 id="2-嵌套-css-规则">2、 嵌套 CSS 规则</h2><p><code>css</code>中重复写选择器是非常繁琐无趣的事。如果要写一大串指向页面中同一块样式时，往往需要多次写同一个<code>id</code>或是同一个<code>class</code>类名:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#content</span> <span class="selector-tag">article</span> <span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#content</span> <span class="selector-tag">article</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">1.4em</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#content</span> <span class="selector-tag">aside</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的<code>css</code>代码使用<code>scss</code>语法编写后就会变得简单明了、结构清晰，如下所示</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#content</span> &#123;</span><br><span class="line">  <span class="selector-tag">article</span> &#123;</span><br><span class="line">    <span class="selector-tag">h1</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">p</span> &#123;</span><br><span class="line">      <span class="attribute">margin-bottom</span>: <span class="number">1.4em</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">aside</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-1-父选择器的标识符">2.1 父选择器的标识符<code>&amp;</code></h3><p>在 scss 中，有时候我们需要在子级当中使用父级选择器，此时我们就需要使用<code>&amp;</code>来选取父级选择器</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.div1</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.div1</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.div1</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的 <code>css</code>代码经过<code>scss</code>换写后，可以简写为如下</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.div1</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: auto;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-子级选择器中的-与">2.2 子级选择器中的&gt; ~与+</h3><ol><li><code>'&gt;'</code>代表是的子级选择器</li><li>空格代码的是后代选择器</li><li><code>'+'</code>代表的是相邻兄弟选择器</li><li><code>‘～’</code>代表兄弟选择器</li></ol><blockquote><p>以上的四种用法与 CSS 的选择器保持一致</p></blockquote><h2 id="3-混合器">3、 混合器</h2><p>有时候我们在写样式的时候会发现，有些地方有样式，其中有一些是相同的，这个时候，我们会把这些样式提取出来，然后再单独导入进去。</p><p>例如：假设我们需要写一个 button，这个 button 的大小与边框都一样，唯独在颜色上一样的时候，我们可以使用混合器做如下处理</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> btn &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">120px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">35px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid lightgray;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btn-success</span> &#123;</span><br><span class="line">  <span class="keyword">@include</span> btn;</span><br><span class="line">  <span class="attribute">background-color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>说明：在上面的代码当中，不难发现，我们使用了<code>@mixin</code> 来定义一个混合器。在下面的样式当中，我们使用了<code>@include</code>导入混合器，这样 .btn-success 的样式就结合了之前定义的样式了。</p></blockquote><h3 id="3-1-混合器的中参数">3.1 混合器的中参数</h3><p><code>SCSS</code>中的混合器有点类似于js中的方法，定义一个混合器就相当于定义了一个方法，而我们定义方法的时候可以定义参数，在调用方法的时候，我们则可以使用这个参数。同理，在 <code>SCSS</code> 当中，定义混合器也可以使用参数，代码如下所示：</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> flex-box(<span class="variable">$direction</span>) &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: <span class="variable">$direction</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item1</span> &#123;</span><br><span class="line">  <span class="keyword">@include</span> flex-box(row);</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的代码经过 <code>node-sass</code>编译后，如下：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.item1</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: row;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-混合器参数的默认值">3.2 混合器参数的默认值</h3><p>为了在<code>@include</code>混合器时不必传入所有的参数，给参数指定一个默认值，上面的scss 中，如果希望<code>flex</code>布局中默认的主轴是 <code>column</code>，可以定义如下：</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> flex-box(<span class="variable">$direction</span>: column) &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: <span class="variable">$direction</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.item1</span> &#123;</span><br><span class="line">  <span class="keyword">@include</span> flex-box;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>在上面的 SCSS 当中，我们在调用的时候没有传递参数给混合器，而是使用了它的默认值</p></blockquote><h2 id="4-选择器继承">4、 选择器继承</h2><p>使用<code>sass</code>的时候，最后一个减少重复的主要特性就是选择器继承。</p><p>选择器继承指的是一个选择器可以继承另一个选择器定义的所有样式。这个通过<code>@extend</code>语法实现，如下代码:</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//通过选择器继承继承样式</span></span><br><span class="line"><span class="selector-class">.error</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fdd</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.loading-error</span> &#123;</span><br><span class="line">  <span class="keyword">@extend</span> .error;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">3px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的<code>@extend</code>就相当于继承，后面的.error 则是继承的选择器，上面的 <code>scss</code> 经过编译后所呈现的代码如下所示：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.error</span>,</span><br><span class="line"><span class="selector-class">.loading-error</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fdd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.loading-error</span> &#123;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">3px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><strong>说明</strong>：我们可以看到，继承的选择器，它在这里使用了分组选择器来完了这个功能，这样我们的.loading-error 的样式则单独的区分开。</p></blockquote><p><em>关于<code>@extend</code>有两个要点你应该知道。</em></p><p>跟混合器相比，继承生成的css代码相对更少。因为继承仅仅是重复选择器，而不会重复属性，所以使用继承往往比混合器生成的css体积更小。如果你非常关心你站点的速度，请牢记这一点。</p><p>继承遵从css层叠的规则。当两个不同的css规则应用到同一个html元素上时，并且这两个不同的css规则对同一属性的修饰存在不同的值，css层叠规则会决定应用哪个样式。</p><p>相当直观：通常权重更高的选择器胜出，如果权重相同，定义在后边的规则胜出。</p><h3 id="写在最后">写在最后</h3><blockquote><ol><li>变量</li><li>嵌套 CSS 规则</li><li>混合器</li><li>继承</li></ol></blockquote><p>以上的四种是 Sass 的核心内容，也是最基础内容，通过了解学习后，我们可以快速的编写页面样式，提高开发效率，做到 CSS 代码重复率低，可复用性高。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;p&gt;说到css，相信大家都知道，css样式是用来修饰网页页面结构的。对于一名前端来说写好css并不难，但如何写出优雅可复用、易重构的css代码并不容易。&lt;/p&gt;
&lt;p&gt;于是css预处理器便出现在大家的视线里，分别是 &lt;code&gt;stylu</summary>
      
    
    
    
    <category term="前端" scheme="https://www.yuanyuan.blog/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="sass" scheme="https://www.yuanyuan.blog/tags/sass/"/>
    
  </entry>
  
  <entry>
    <title>less</title>
    <link href="https://www.yuanyuan.blog/posts/d3b694df.html"/>
    <id>https://www.yuanyuan.blog/posts/d3b694df.html</id>
    <published>2023-03-30T13:22:12.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言">前言</h2><h3 id="css的短板">CSS的短板</h3><p>作为前端学习者的我们 或多或少都要学些 CSS ，它作为前端开发的三大基石之一，时刻引领着 Web 的发展潮向。 而 CSS 作为一门标记性语言，可能 给初学者第一印象 就是简单易懂，毫无逻辑，不像编程该有的样子。在语法更新时，每当新属性提出，浏览器的兼容又会马上变成绊脚石，可以说 CSS 短板不容忽视。</p><p>问题的诞生往往伴随着技术的兴起， 在 Web 发展的这几年， 为了让 CSS 富有逻辑性，短板不那么严重，涌现出了 一些神奇的预处理语言。 它们让 CSS 彻底变成一门 可以使用 变量 、循环 、继承 、自定义方法等多种特性的标记语言，逻辑性得以大大增强。</p><h3 id="预处理语言的诞生">预处理语言的诞生</h3><p>其中 就我所知的有三门语言：Sass、Less 、Stylus 。</p><ol><li>Sass 诞生于 2007 年，Ruby 编写，其语法功能都十分全面，可以说 它完全把 CSS 变成了一门编程语言。另外 在国内外都很受欢迎，并且它的项目团队很是强大 ，是一款十分优秀的预处理语言。</li><li>Stylus 诞生于 2010 年，来自 Node.js 社区，语法功能也和 Sass 不相伯仲，是一门十分独特的创新型语言。</li><li>Less 诞生于 2009 年，受Sass的影响创建的一个开源项目。 它扩充了 CSS 语言，增加了诸如变量、混合（mixin）、函数等功能，让 CSS 更易维护、方便制作主题、扩充（<em>引用于官网</em>）。</li></ol><h3 id="选择预处理语言">选择预处理语言</h3><p>这是一个十分纠结的问题。</p><ol><li>在网上讨论看来，Sass 与 Stylus 相比于 Less 功能更为丰富，但对于学习成本以及适应时间 ，Less 稍胜一筹，这也是我选择 Less 的原因。</li><li>Less 没有去掉任何 CSS 的功能，而是在现有的语法上，增添了许多额外的功能特性，所以学习 Less 是一件非常舒服的事情。</li></ol><p>如果你之前没有接触过预处理语言，纠结应该学哪一个，不如先看看 下面 Less 的介绍，我相信你会爱上它的。</p><h3 id="使用-less-的前奏">使用 Less 的前奏</h3><p>使用 Less 有两种方式</p><ol><li>在页面中 引入 Less.js</li></ol><ul><li><p>可在<a href="http://lesscss.org/">官网</a>下载</p></li><li><p>或使用CDN</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/less@4.1.3/dist/less.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>需要注意的是，link 标签一定要在 Less.js 之前引入，并且 link 标签的 rel 属性要设置为stylesheet/less。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet/less&quot;</span> <span class="attr">href</span>=<span class="string">&quot;style.less&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;less.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><ol><li><p>在命令行 使用npm安装</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g less</span><br></pre></td></tr></table></figure><p>具体使用命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ lessc styles.less &gt; styles.css</span><br></pre></td></tr></table></figure><p>假如还有问题，<a href="http://less.bootcss.com/">官网</a>已经有了明确的步骤。</p><p>如果你也是 Webpack 的使用者，还需要配合 less-loader 进行处理，具体可见我的这篇文章：<a href="https://tomotoes.com/posts/4d6f8cc5/">Webpack飞行手册</a>，里面详细说明了 less 的处理方式。</p><p>如果你在本地环境，可以使用第一种方式，非常简单；但在生产环境中，性能非常重要，最好使用第二种方式。</p></li></ol><h2 id="正文">正文</h2><p>下面我将简介 Less 的功能特性。</p><h3 id="变量">变量</h3><p>我们常常在 CSS 中 看到同一个值重复多次，这样难易于代码维护。 理想状态，应是下面这样：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bgColor=<span class="string">&quot;skyblue&quot;</span>;</span><br><span class="line">$(<span class="string">&quot;.post-content&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;background-color&quot;</span>,bgColor);</span><br><span class="line">$(<span class="string">&quot;#wrap&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;background-color&quot;</span>,bgColor);</span><br><span class="line">$(<span class="string">&quot;.arctive&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;background-color&quot;</span>,bgColor);</span><br></pre></td></tr></table></figure><p>只要我们修改 <code>bgColor</code>这一个变量， 整个页面的背景颜色都会随之改变。</p><p>而 Less 中的变量十分强大，可化万物，值得一提的是，其变量是常量 ，所以只能定义一次，不能重复使用。</p><ol><li><p><strong>值变量</strong></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="variable">@color:</span> <span class="number">#999</span>;</span><br><span class="line"><span class="variable">@bgColor:</span> skyblue;<span class="comment">//不要添加引号</span></span><br><span class="line"><span class="variable">@width:</span> <span class="number">50%</span>;</span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">@color</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="variable">@bgColor</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="variable">@width</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成后的 CSS */</span></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#999</span>;</span><br><span class="line">  <span class="attribute">background</span>: skyblue;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以 <code>@</code> 开头 定义变量，并且使用时 直接 键入 <code>@</code>名称。</p><p>在平时工作中，我们就可以把 常用的变量 封装到一个文件中，这样利于代码组织维护。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@lightPrimaryColor:</span> <span class="number">#c5cae9</span>;</span><br><span class="line"><span class="variable">@textPrimaryColor:</span> <span class="number">#fff</span>;</span><br><span class="line"><span class="variable">@accentColor:</span> <span class="built_in">rgb</span>(<span class="number">99</span>, <span class="number">137</span>, <span class="number">185</span>);</span><br><span class="line"><span class="variable">@primaryTextColor:</span> <span class="number">#646464</span>;</span><br><span class="line"><span class="variable">@secondaryTextColor:</span> <span class="number">#000</span>;</span><br><span class="line"><span class="variable">@dividerColor:</span> <span class="number">#b6b6b6</span>;</span><br><span class="line"><span class="variable">@borderColor:</span> <span class="number">#dadada</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>选择器变量</strong></p><p>让 选择器 变成 动态</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="variable">@mySelector:</span> #wrap;</span><br><span class="line"><span class="variable">@Wrap:</span> wrap;</span><br><span class="line"><span class="variable">@&#123;mySelector&#125;</span>&#123; <span class="comment">//变量名 必须使用大括号包裹</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#999</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.@&#123;Wrap&#125;</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>:<span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#@&#123;Wrap&#125;</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>:<span class="number">#666</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#999</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.wrap</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>:<span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>:<span class="number">#666</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>属性变量</strong></p><p>可减少代码书写量</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="variable">@borderStyle:</span> border-style;</span><br><span class="line"><span class="variable">@Soild:</span>solid;</span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  @&#123;borderStyle&#125;: @<span class="selector-tag">Soild</span>;<span class="comment">//变量名 必须使用大括号包裹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">border-style</span>:solid;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>url 变量</strong></p><p>项目结构改变时，修改其变量即可。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="variable">@images:</span> <span class="string">&quot;../img&quot;</span>;<span class="comment">//需要加引号</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: url(<span class="string">&quot;@&#123;images&#125;/dog.png&quot;</span>);<span class="comment">//变量名 必须使用大括号包裹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: url(<span class="string">&quot;../img/dog.png&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>声明变量</strong></p><p>有点类似于 下面的 混合方法</p><ul><li>结构: @name: { 属性: 值 ;};</li><li>使用：@name();</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="variable">@background:</span> &#123;<span class="attribute">background</span>:red;&#125;;</span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">    <span class="variable">@background</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">@Rules:</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">border</span>: solid <span class="number">1px</span> red;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="selector-id">#con</span>&#123;</span><br><span class="line">  <span class="variable">@Rules</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>:red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#con</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">border</span>: solid <span class="number">1px</span> red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>变量运算</strong></p><p>不得不提的是，Less 的变量运算完全超出我的期望，十分强大。</p><ul><li>加减法时 以第一个数据的单位为基准</li><li>乘除法时 注意单位一定要统一</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="variable">@width:</span><span class="number">300px</span>;</span><br><span class="line"><span class="variable">@color:</span><span class="number">#222</span>;</span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="variable">@width-20</span>;</span><br><span class="line">  <span class="attribute">height</span>:<span class="variable">@width-20</span>*<span class="number">5</span>;</span><br><span class="line">  <span class="attribute">margin</span>:(<span class="variable">@width-20</span>)*<span class="number">5</span>;</span><br><span class="line">  <span class="attribute">color</span>:<span class="variable">@color</span>*<span class="number">2</span>;</span><br><span class="line">  <span class="attribute">background-color</span>:<span class="variable">@color</span> + <span class="number">#111</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">280px</span>;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">margin</span>:<span class="number">1400px</span>;</span><br><span class="line">  <span class="attribute">color</span>:<span class="number">#444</span>;</span><br><span class="line">  <span class="attribute">background-color</span>:<span class="number">#333</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>变量作用域</strong></p><p>一句话理解就是：<strong>就近原则</strong>，不要跟我提闭包。</p><p><em>借助官网的Demo</em></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="variable">@var:</span> <span class="variable">@a</span>;</span><br><span class="line"><span class="variable">@a:</span> <span class="number">100%</span>;</span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="variable">@var</span>;</span><br><span class="line">  <span class="variable">@a:</span> <span class="number">9%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#wrap</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">9%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>用变量去定义变量</strong></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="variable">@fnord:</span>  <span class="string">&quot;I am fnord.&quot;</span>;</span><br><span class="line"><span class="variable">@var:</span>    <span class="string">&quot;fnord&quot;</span>;</span><br><span class="line"><span class="selector-id">#wrap</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="variable">@@var</span>; <span class="comment">//将@var替换为其值 content:@fnord;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#wrap</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;I am fnord.&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="嵌套">嵌套</h3><ol><li><p><strong>&amp; 的妙用</strong></p><p>&amp; ：代表的上一层选择器的名字，此例便是<code>header</code>。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-id">#header</span>&#123;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">:after</span>&#123;</span><br><span class="line">    <span class="attribute">content</span>:<span class="string">&quot;Less is more!&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.title</span>&#123;</span><br><span class="line">    <span class="attribute">font-weight</span>:bold;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-tag">_content</span>&#123;<span class="comment">//理解方式：直接把 &amp; 替换成 #header</span></span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">20px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#header</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">  <span class="attribute">content</span>:<span class="string">&quot;Less is more!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#header</span> <span class="selector-class">.title</span>&#123; <span class="comment">//嵌套了</span></span><br><span class="line">  <span class="attribute">font-weight</span>:bold;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#header_content</span>&#123;<span class="comment">//没有嵌套！</span></span><br><span class="line">    <span class="attribute">margin</span>:<span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>媒体查询</strong></p><p>在以往的工作中，我们使用 媒体查询，都要把一个元素 分开写</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">500px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">768px</span>)&#123;</span><br><span class="line">  <span class="selector-id">#wrap</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">100px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Less 提供了一个十分便捷的方式</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">    <span class="comment">//something...</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">@media</span> screen&#123;</span><br><span class="line">        <span class="keyword">@media</span> (<span class="attribute">max-width</span>:<span class="number">768px</span>)&#123;</span><br><span class="line">          <span class="attribute">width</span>:<span class="number">100px</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">@media</span> tv &#123;</span><br><span class="line">      <span class="attribute">width</span>:<span class="number">2000px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">maxwidth</span>:<span class="number">768px</span>)&#123;</span><br><span class="line">  <span class="selector-id">#main</span>&#123;</span><br><span class="line">      <span class="attribute">width</span>:<span class="number">100px</span>; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@media</span> tv&#123;</span><br><span class="line">  <span class="selector-id">#main</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>:<span class="number">2000px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>唯一的缺点就是 每一个元素都会编译出自己 <code>@media</code> 声明，并不会合并。</p></li><li><p><strong>实战技巧</strong></p><p>可以借助 Less 在元素中，去定义自己的私有样式。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="comment">// something..</span></span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-class">.show</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>:block;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.show</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>:none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> main = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;main&quot;</span>);</span><br><span class="line">main.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;show&quot;</span>);</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#main</span><span class="selector-class">.show</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>:block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.show</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>:none; <span class="comment">//会被覆盖。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="混合方法">混合方法</h3><ol><li><p><strong>无参数方法</strong></p><p>方法犹如 声明的集合，使用时 直接键入名称即可。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-class">.card</span> &#123; <span class="comment">// 等价于 .card()</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#f6f6f6</span>;</span><br><span class="line">    -webkit-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(<span class="number">151</span>, <span class="number">151</span>, <span class="number">151</span>, .<span class="number">58</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(<span class="number">151</span>, <span class="number">151</span>, <span class="number">151</span>, .<span class="number">58</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="selector-class">.card</span>;<span class="comment">//等价于.card();</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f6f6f6</span>;</span><br><span class="line">  -webkit-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(<span class="number">151</span>, <span class="number">151</span>, <span class="number">151</span>, .<span class="number">58</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">2px</span> <span class="built_in">rgba</span>(<span class="number">151</span>, <span class="number">151</span>, <span class="number">151</span>, .<span class="number">58</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中 <code>.card</code> 与 <code>.card()</code> 是等价的。 个人建议，为了避免 代码混淆，应写成 :</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.card</span>()&#123;</span><br><span class="line">  <span class="comment">//something...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="selector-class">.card</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>要点：</p><ul><li><code>.</code> 与 <code>#</code> 皆可作为 方法前缀。</li><li>方法后写不写 <code>()</code> 看个人习惯。</li></ul></li><li><p><strong>默认参数方法</strong></p><ul><li>Less 可以使用默认参数，如果 没有传参数，那么将使用默认参数。</li><li><code>@arguments</code> 犹如 JS 中的 <code>arguments</code> 指代的是 全部参数。</li><li>传的参数中 必须带着单位。</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-class">.border</span>(<span class="variable">@a</span>:<span class="number">10px</span>,<span class="variable">@b</span>:<span class="number">50px</span>,<span class="variable">@c</span>:<span class="number">30px</span>,<span class="variable">@color</span>:<span class="number">#000</span>)&#123;</span><br><span class="line">    <span class="attribute">border</span>:solid <span class="number">1px</span> <span class="variable">@color</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="variable">@arguments</span>;<span class="comment">//指代的是 全部参数</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">    <span class="selector-class">.border</span>(<span class="number">0px</span>,<span class="number">5px</span>,<span class="number">30px</span>,red);<span class="comment">//必须带着单位</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">    <span class="selector-class">.border</span>(<span class="number">0px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#content</span>&#123;</span><br><span class="line">  <span class="selector-class">.border</span>;<span class="comment">//等价于 .border()</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">    <span class="attribute">border</span>:solid <span class="number">1px</span> red;</span><br><span class="line">    <span class="attribute">box-shadow</span>:<span class="number">0px</span>,<span class="number">5px</span>,<span class="number">30px</span>,red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">    <span class="attribute">border</span>:solid <span class="number">1px</span> <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">50px</span> <span class="number">30px</span> <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#content</span>&#123;</span><br><span class="line">    <span class="attribute">border</span>:solid <span class="number">1px</span> <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">10px</span> <span class="number">50px</span> <span class="number">30px</span> <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>方法的匹配模式</strong></p><p>与 面向对象中的多态 很相似</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-class">.triangle</span>(top,<span class="variable">@width</span>:<span class="number">20px</span>,<span class="variable">@color</span>:<span class="number">#000</span>)&#123;</span><br><span class="line">    <span class="attribute">border-color</span>:transparent  transparent <span class="variable">@color</span> transparent ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.triangle</span>(right,<span class="variable">@width</span>:<span class="number">20px</span>,<span class="variable">@color</span>:<span class="number">#000</span>)&#123;</span><br><span class="line">    <span class="attribute">border-color</span>:transparent <span class="variable">@color</span> transparent  transparent ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.triangle</span>(bottom,<span class="variable">@width</span>:<span class="number">20px</span>,<span class="variable">@color</span>:<span class="number">#000</span>)&#123;</span><br><span class="line">    <span class="attribute">border-color</span>:<span class="variable">@color</span> transparent  transparent  transparent ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.triangle</span>(left,<span class="variable">@width</span>:<span class="number">20px</span>,<span class="variable">@color</span>:<span class="number">#000</span>)&#123;</span><br><span class="line">    <span class="attribute">border-color</span>:transparent  transparent  transparent <span class="variable">@color</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.triangle</span>(<span class="variable">@_</span>,<span class="variable">@width</span>:<span class="number">20px</span>,<span class="variable">@color</span>:<span class="number">#000</span>)&#123;</span><br><span class="line">    <span class="attribute">border-style</span>: solid;</span><br><span class="line">    <span class="attribute">border-width</span>: <span class="variable">@width</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">    <span class="selector-class">.triangle</span>(left, <span class="number">50px</span>, <span class="number">#999</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="attribute">border-color</span>:transparent  transparent  transparent <span class="number">#999</span>;</span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>要点</p><ul><li>第一个参数 <code>left</code> 要会找到方法中匹配程度最高的，如果匹配程度相同，将全部选择，并存在着样式覆盖替换。</li><li>如果匹配的参数 是变量，则将会匹配，如 <code>@_</code> 。</li></ul></li><li><p><strong>方法的命名空间</strong></p><p>让方法更加规范</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-id">#card</span>()&#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#723232</span>;</span><br><span class="line">    <span class="selector-class">.d</span>(<span class="variable">@w</span>:<span class="number">300px</span>)&#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="variable">@w</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="selector-id">#a</span>(<span class="variable">@h</span>:<span class="number">300px</span>)&#123;</span><br><span class="line">            <span class="attribute">height</span>: <span class="variable">@h</span>;<span class="comment">//可以使用上一层传进来的方法</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">    <span class="selector-id">#card</span> &gt; <span class="selector-class">.d</span> &gt; <span class="selector-id">#a</span>(<span class="number">100px</span>); <span class="comment">// 父元素不能加 括号</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">    <span class="selector-id">#card</span> <span class="selector-class">.d</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#con</span>&#123;</span><br><span class="line">    <span class="comment">//不得单独使用命名空间的方法</span></span><br><span class="line">    <span class="comment">//.d() 如果前面没有引入命名空间 #card ，将会报错</span></span><br><span class="line">    </span><br><span class="line">    <span class="selector-id">#card</span>; <span class="comment">// 等价于 #card();</span></span><br><span class="line">    <span class="selector-class">.d</span>(<span class="number">20px</span>); <span class="comment">//必须先引入 #card</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">height</span>:<span class="number">100px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">300px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#con</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>要点</p><ul><li>在 CSS 中<code>&gt;</code> 选择器，选择的是 儿子元素，就是 必须与父元素 有直接血源的元素。</li><li>在引入命令空间时，如使用 <code>&gt;</code> 选择器，父元素不能加 括号。</li><li>不得单独使用命名空间的方法 必须先引入命名空间，才能使用 其中方法。</li><li>子方法 可以使用上一层传进来的方法</li></ul></li><li><p><strong>方法的条件筛选</strong></p><p>Less 没有 if else，可是它有 <code>when</code></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-id">#card</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// and 运算符 ，相当于 与运算 &amp;&amp;，必须条件全部符合才会执行</span></span><br><span class="line">    <span class="selector-class">.border</span>(<span class="variable">@width</span>,<span class="variable">@color</span>,<span class="variable">@style</span>) <span class="keyword">when</span> (<span class="variable">@width</span>&gt;<span class="number">100px</span>) <span class="keyword">and</span>(<span class="variable">@color</span>=<span class="number">#999</span>)&#123;</span><br><span class="line">        <span class="attribute">border</span>:<span class="variable">@style</span> <span class="variable">@color</span> <span class="variable">@width</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// not 运算符，相当于 非运算 !，条件为 不符合才会执行</span></span><br><span class="line">    <span class="selector-class">.background</span>(<span class="variable">@color</span>) <span class="keyword">when</span> <span class="keyword">not</span> (<span class="variable">@color</span>&gt;=<span class="number">#222</span>)&#123;</span><br><span class="line">        <span class="attribute">background</span>:<span class="variable">@color</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// , 逗号分隔符：相当于 或运算 ||，只要有一个符合条件就会执行</span></span><br><span class="line">    <span class="selector-class">.font</span>(<span class="variable">@size</span>:<span class="number">20px</span>) <span class="keyword">when</span> (<span class="variable">@size</span>&gt;<span class="number">50px</span>) , (<span class="variable">@size</span>&lt;<span class="number">100px</span>)&#123;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="variable">@size</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">    <span class="selector-id">#card</span>&gt;<span class="selector-class">.border</span>(<span class="number">200px</span>,<span class="number">#999</span>,solid);</span><br><span class="line">    <span class="selector-id">#card</span> <span class="selector-class">.background</span>(<span class="number">#111</span>);</span><br><span class="line">    <span class="selector-id">#card</span> &gt; <span class="selector-class">.font</span>(<span class="number">40px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 生成后的 CSS */</span></span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="attribute">border</span>:solid <span class="number">#999</span> <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">background</span>:<span class="number">#111</span>;</span><br><span class="line">  <span class="attribute">font-size</span>:<span class="number">40px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>要点</p><ul><li>比较运算有： &gt; &gt;= = =&lt; &lt;。</li><li>= 代表的是等于</li><li>除去关键字 true 以外的值都被视为 false：</li></ul></li><li><p><strong>数量不定的参数</strong></p><p>如果你希望你的方法接受数量不定的参数，你可以使用… ，犹如 ES6 的扩展运算符。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-class">.boxShadow</span>(...)&#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="variable">@arguments</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.textShadow</span>(<span class="variable">@a</span>,...)&#123;</span><br><span class="line">    <span class="attribute">text-shadow</span>: <span class="variable">@arguments</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">    <span class="selector-class">.boxShadow</span>(<span class="number">1px</span>,<span class="number">4px</span>,<span class="number">30px</span>,red);</span><br><span class="line">    <span class="selector-class">.textShadow</span>(<span class="number">1px</span>,<span class="number">4px</span>,<span class="number">30px</span>,red);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成后的 CSS */</span></span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">1px</span> <span class="number">4px</span> <span class="number">30px</span> red;</span><br><span class="line">  <span class="attribute">text-shadow</span>: <span class="number">1px</span> <span class="number">4px</span> <span class="number">30px</span> red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>方法使用important！</strong></p><p>使用方法 非常简单，在方法名后 加上关键字即可。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-class">.border</span>&#123;</span><br><span class="line">    <span class="attribute">border</span>: solid <span class="number">1px</span> red;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">50px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">    <span class="selector-class">.border</span>() !important;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 生成后的 CSS */</span></span><br><span class="line"><span class="selector-id">#main</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: solid <span class="number">1px</span> red <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">50px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>循环方法</strong></p><p>Less 并没有提供 for 循环功能，但这也难不倒 聪明的程序员，使用递归去实现。 下面是官网中的一个 Demo，模拟了生成栅格系统。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-class">.generate-columns</span>(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.generate-columns</span>(<span class="variable">@n</span>, <span class="variable">@i</span>: <span class="number">1</span>) <span class="keyword">when</span> (<span class="variable">@i</span> =&lt; <span class="variable">@n</span>) &#123;</span><br><span class="line">  <span class="selector-class">.column-</span><span class="variable">@&#123;i&#125;</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: (<span class="variable">@i</span> * <span class="number">100%</span> / <span class="variable">@n</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.generate-columns</span>(<span class="variable">@n</span>, (<span class="variable">@i</span> + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 生成后的 CSS */</span></span><br><span class="line"><span class="selector-class">.column-1</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">25%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.column-2</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.column-3</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">75%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.column-4</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>属性拼接方法</strong></p><p><code>+_</code> 代表的是 空格；<code>+</code> 代表的是 逗号。</p><ul><li>逗号</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-class">.boxShadow</span>() &#123;</span><br><span class="line">    <span class="selector-tag">box-shadow</span>+: <span class="selector-tag">inset</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="selector-id">#555</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="selector-class">.boxShadow</span>();</span><br><span class="line">  <span class="selector-tag">box-shadow</span>+: <span class="number">0</span> <span class="number">0</span> <span class="number">20px</span> <span class="selector-tag">black</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 生成后的 CSS */</span></span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">box-shadow</span>: inset <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="number">#555</span>, <span class="number">0</span> <span class="number">0</span> <span class="number">20px</span> black;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>空格</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-class">.Animation</span>() &#123;</span><br><span class="line">  <span class="selector-tag">transform</span>+<span class="selector-tag">_</span>: <span class="selector-tag">scale</span>(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="selector-class">.Animation</span>();</span><br><span class="line">  <span class="selector-tag">transform</span>+<span class="selector-tag">_</span>: <span class="selector-tag">rotate</span>(<span class="number">15deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">2</span>) <span class="built_in">rotate</span>(<span class="number">15deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>实战技巧</strong></p><p>下面是官网中的一个非常赞的 Demo</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-class">.average</span>(<span class="variable">@x</span>, <span class="variable">@y</span>) &#123;</span><br><span class="line">  <span class="variable">@average:</span> ((<span class="variable">@x</span> + <span class="variable">@y</span>) / <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="selector-class">.average</span>(<span class="number">16px</span>, <span class="number">50px</span>); <span class="comment">// 调用 方法</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="variable">@average</span>;    <span class="comment">// 使用返回值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">33px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p>可以说 Less 是一门优雅编程语言。</p><h3 id="继承">继承</h3><p>extend 是 Less 的一个伪类。它可继承 所匹配声明中的全部样式。</p><ol><li><p><strong>extend 关键字的使用</strong></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-class">.animation</span>&#123;</span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">3s</span> ease-out;</span><br><span class="line">    <span class="selector-class">.hide</span>&#123;</span><br><span class="line">      <span class="attribute">transform</span>:<span class="built_in">scale</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">    <span class="selector-tag">&amp;</span>:<span class="selector-tag">extend</span>(.animation);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#con</span>&#123;</span><br><span class="line">    <span class="selector-tag">&amp;</span>:<span class="selector-tag">extend</span>(.animation .hide);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成后的 CSS */</span></span><br><span class="line"><span class="selector-class">.animation</span>,<span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="attribute">transition</span>: all .<span class="number">3s</span> ease-out;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.animation</span> <span class="selector-class">.hide</span> , <span class="selector-id">#con</span>&#123;</span><br><span class="line">    <span class="attribute">transform</span>:<span class="built_in">scale</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>all 全局搜索替换</strong></p><p>使用选择器匹配到的 全部声明。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#main</span> &#123;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>:<span class="string">&quot;Less is good!&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span>:<span class="selector-tag">extend</span>(#main all) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#main</span>,<span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#main</span><span class="selector-pseudo">:after</span>, <span class="selector-id">#wrap</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&quot;Less is good!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>减少代码的重复性</strong></p><p>从表面 看来，extend 与 方法 最大的差别，就是 extend 是同个选择器共用同一个声明，而 方法 是使用自己的声明，这无疑 增加了代码的重复性。</p><p>方法示例 与上面的 extend 进行对比：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-class">.Method</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">      <span class="attribute">content</span>:<span class="string">&quot;Less is good!&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="selector-class">.Method</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="selector-class">.Method</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成的 CSS */</span></span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">:after</span>&#123;</span><br><span class="line">    <span class="attribute">content</span>:<span class="string">&quot;Less is good!&quot;</span>;</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">:after</span>&#123;</span><br><span class="line">    <span class="attribute">content</span>:<span class="string">&quot;Less is good!&quot;</span>;</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>要点</strong></p><p><em>翻译官网</em></p><ul><li>选择器和扩展之间 是允许有空格的：pre:hover :extend(div pre).</li><li>可以有多个扩展: pre:hover:extend(div pre):extend(.bucket tr) - 注意这与 pre:hover:extend(div pre, .bucket tr)一样。</li><li>这是不可以的，扩展必须在最后 : pre:hover:extend(div pre).nth-child(odd)。</li><li>如果一个规则集包含多个选择器，所有选择器都可以使用extend关键字。</li></ul><h3 id="导入">导入</h3><ol><li>导入 less 文件 可省略后缀</li></ol><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">import</span> &quot;<span class="selector-tag">main</span>&quot;; </span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line"><span class="selector-tag">import</span> &quot;<span class="selector-tag">main</span><span class="selector-class">.less</span>&quot;;</span><br></pre></td></tr></table></figure><ol><li><code>@import</code> 的位置可随意放置</li></ol><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>:<span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@import</span> <span class="string">&quot;style&quot;</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>reference</strong></p><p>Less 中 最强大的特性 使用 引入的 Less 文件，但不会 编译它。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="keyword">@import</span> (reference) <span class="string">&quot;bootstrap.less&quot;</span>; </span><br><span class="line"></span><br><span class="line"><span class="selector-id">#wrap</span>:<span class="selector-tag">extend</span>(.navbar all)&#123;&#125;</span><br></pre></td></tr></table></figure><p>翻译官网：</p><blockquote><p>使用@import (reference)导入外部文件，但不会添加 把导入的文件 编译到最终输出中，只引用。</p></blockquote></li><li><p><strong>once</strong></p><blockquote><p>@import语句的默认行为。这表明相同的文件只会被导入一次，而随后的导入文件的重复代码都不会解析。</p></blockquote><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> (once) <span class="string">&quot;foo.less&quot;</span>;</span><br><span class="line"><span class="keyword">@import</span> (once) <span class="string">&quot;foo.less&quot;</span>; <span class="comment">// this statement will be ignored</span></span><br></pre></td></tr></table></figure></li><li><p><strong>multiple</strong></p><blockquote><p>使用@import (multiple)允许导入多个同名文件。</p></blockquote><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// file: foo.less</span></span><br><span class="line"><span class="selector-class">.a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: green;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// file: main.less</span></span><br><span class="line"><span class="keyword">@import</span> (multiple) <span class="string">&quot;foo.less&quot;</span>;</span><br><span class="line"><span class="keyword">@import</span> (multiple) <span class="string">&quot;foo.less&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成后的 CSS */</span></span><br><span class="line"><span class="selector-class">.a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: green;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="函数">函数</h3><ol><li><p><strong>判断类型</strong></p><ul><li>isnumber</li></ul><blockquote><p>判断给定的值 是否 是一个数字。</p></blockquote><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">isnumber</span>(<span class="number">#ff0</span>);     <span class="comment">// false</span></span><br><span class="line"><span class="selector-tag">isnumber</span>(blue);     <span class="comment">// false</span></span><br><span class="line"><span class="selector-tag">isnumber</span>(<span class="string">&quot;string&quot;</span>); <span class="comment">// false</span></span><br><span class="line"><span class="selector-tag">isnumber</span>(<span class="number">1234</span>);     <span class="comment">// true</span></span><br><span class="line"><span class="selector-tag">isnumber</span>(<span class="number">56px</span>);     <span class="comment">// true</span></span><br><span class="line"><span class="selector-tag">isnumber</span>(<span class="number">7.8%</span>);     <span class="comment">// true</span></span><br><span class="line"><span class="selector-tag">isnumber</span>(keyword);  <span class="comment">// false</span></span><br><span class="line"><span class="selector-tag">isnumber</span>(url(<span class="string">...</span>)); <span class="comment">// false</span></span><br></pre></td></tr></table></figure><ul><li>iscolor</li></ul><blockquote><p>判断给定的值 是否 是一个颜色。</p></blockquote><ul><li>isurl</li></ul><blockquote><p>判断给定的值 是否 是一个 url 。</p></blockquote></li><li><p><strong>颜色操作</strong></p><ul><li>saturate</li></ul><blockquote><p>增加一定数值的颜色饱和度。</p></blockquote><ul><li>lighten</li></ul><blockquote><p>增加一定数值的颜色亮度。</p></blockquote><ul><li>darken</li></ul><blockquote><p>降低一定数值的颜色亮度。</p></blockquote><ul><li>fade</li></ul><blockquote><p>给颜色设定一定数值的透明度。</p></blockquote><ul><li>mix</li></ul><blockquote><p>根据比例混合两种颜色。</p></blockquote></li><li><p><strong>数学函数</strong></p><ul><li>ceil</li></ul><blockquote><p>向上取整。</p></blockquote><ul><li>floor</li></ul><blockquote><p>向下取整。</p></blockquote><ul><li>percentage</li></ul><blockquote><p>将浮点数转换为百分比字符串。</p></blockquote><ul><li>round</li></ul><blockquote><p>四舍五入。</p></blockquote><ul><li>sqrt</li></ul><blockquote><p>计算一个数的平方根。</p></blockquote><ul><li>abs</li></ul><blockquote><p>计算数字的绝对值，原样保持单位。</p></blockquote><ul><li>pow</li></ul><blockquote><p>计算一个数的乘方。</p></blockquote></li></ol><p>由于 文章 篇幅有限，所以 只能介绍一些 使用效率高的函数。</p><p>如果你想了解更多，可以去官网的<a href="http://lesscss.cn/functions/">函数链接</a></p><h3 id="其他">其他</h3><ol><li><p><strong>注释</strong></p><ul><li>/* */ CSS原生注释，会被编译在 CSS 文件中。</li><li>/  / Less提供的一种注释，不会被编译在 CSS 文件中。</li></ul></li><li><p><strong>避免编译</strong></p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="string">~&#x27;calc(300px-30px)&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 生成后的 CSS */</span></span><br><span class="line"><span class="selector-id">#main</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="built_in">calc</span>(<span class="number">300px</span>-<span class="number">30px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结构： <code>~' 值 '</code></p></li><li><p><strong>变量拼串</strong></p><p>在平时工作中，这种需求 太常见了。 在下面例子中， 实现了不同的 transtion-delay、animation、@keyframes</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.judge</span>(<span class="variable">@i</span>) <span class="keyword">when</span>(<span class="variable">@i</span>=<span class="number">1</span>)&#123;</span><br><span class="line">  <span class="variable">@size:</span><span class="number">15px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.judge</span>(<span class="variable">@i</span>) <span class="keyword">when</span>(<span class="variable">@i</span>&gt;<span class="number">1</span>)&#123;</span><br><span class="line">  <span class="variable">@size:</span><span class="number">16px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.loopAnimation</span>(<span class="variable">@i</span>) <span class="keyword">when</span> (<span class="variable">@i</span>&lt;<span class="number">16</span>) &#123;</span><br><span class="line">  </span><br><span class="line">  <span class="selector-class">.circle</span><span class="selector-pseudo">:nth-child</span>(<span class="variable">@&#123;i&#125;</span>)&#123;</span><br><span class="line">      <span class="selector-class">.judeg</span>(<span class="variable">@i</span>);</span><br><span class="line">      <span class="attribute">border-radius</span>:<span class="variable">@size</span> <span class="variable">@size</span> <span class="number">0</span> <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">animation</span>: <span class="string">~&quot;circle-@&#123;i&#125;&quot;</span> <span class="variable">@duration</span> infinite <span class="variable">@ease</span>;</span><br><span class="line">      <span class="attribute">transition-delay</span>:<span class="string">~&quot;@&#123;i&#125;ms&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">@keyframes</span> <span class="string">~&quot;circle-@&#123;i&#125;&quot;</span> &#123;</span><br><span class="line">      <span class="comment">// do something...</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.loopAnimation</span>(<span class="variable">@i</span> + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结构： <code>~&quot;字符@&#123;变量&#125;字符&quot;</code>;</p></li><li><p><strong>使用 JS</strong></p><p>因为 Less 是由 JS 编写，所以 Less 有一得天独厚的特性：代码中使用 Javascript 。</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Less */</span></span><br><span class="line"><span class="variable">@content:</span><span class="built_in">`&quot;aaa&quot;.toUpperCase()`</span>;</span><br><span class="line"><span class="selector-id">#randomColor</span>&#123;</span><br><span class="line">  <span class="variable">@randomColor:</span> <span class="string">~&quot;rgb(`Math.round(Math.random() * 256)`,`Math.round(Math.random() * 256)`,`Math.round(Math.random() * 256)`)&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="string">~&quot;`Math.round(Math.random() * 100)`px&quot;</span>;</span><br><span class="line">  <span class="selector-tag">&amp;</span><span class="selector-pseudo">:after</span>&#123;</span><br><span class="line">      <span class="attribute">content</span>:<span class="variable">@content</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="attribute">height</span>: <span class="string">~&quot;`window.innerHeight`px&quot;</span>;</span><br><span class="line">  alert:~&quot;`alert(1)`&quot;;</span><br><span class="line">  <span class="selector-id">#randomColor</span>();</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="variable">@randomColor</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 生成后的 CSS */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 弹出 1</span></span><br><span class="line"><span class="selector-id">#wrap</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: 随机值（<span class="number">0</span>~<span class="number">100</span>）px;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">743px</span>;<span class="comment">//由电脑而异</span></span><br><span class="line">  <span class="attribute">background</span>: 随机颜色;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#wrap</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">  <span class="attribute">content</span>:<span class="string">&quot;AAA&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;前言&lt;/h2&gt;
&lt;h3 id=&quot;css的短板&quot;&gt;CSS的短板&lt;/h3&gt;
&lt;p&gt;作为前端学习者的我们 或多或少都要学些 CSS ，它作为前端开发的三大基石之一，时刻引领着 Web 的发展潮向。 而 CSS 作为一门标记性语言，可能 给初学者第一印象 就是简单</summary>
      
    
    
    
    <category term="前端" scheme="https://www.yuanyuan.blog/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
    <category term="less" scheme="https://www.yuanyuan.blog/tags/less/"/>
    
  </entry>
  
  <entry>
    <title>MongoDB Realm</title>
    <link href="https://www.yuanyuan.blog/posts/99ca06de.html"/>
    <id>https://www.yuanyuan.blog/posts/99ca06de.html</id>
    <published>2023-03-11T16:09:50.000Z</published>
    <updated>2024-01-14T15:51:58.798Z</updated>
    
    <content type="html"><![CDATA[<h2 id="使用realm">使用Realm</h2><div class='tag-link-1'><a class="tag-Link" target="_blank" href=" https://www.mongodb.com/docs/realm/sdk/kotlin/">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://api.iowen.cn/favicon/www.mongodb.com/docs/realm/sdk/kotlin/.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">Realm官方文档</div>            <div class="tag-link-sitename"> https://www.mongodb.com/docs/realm/sdk/kotlin/</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div><h3 id="添加依赖">添加依赖</h3><p>在build.gradle(app)文件中添加</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">...</span><br><span class="line">    id <span class="string">&#x27;io.realm.kotlin&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">...</span><br><span class="line">    <span class="comment">//MongoDB Realm</span></span><br><span class="line">    implementation <span class="string">&#x27;org.jetbrains.kotlinx:kotlinx-coroutines-core:1.6.4&#x27;</span></span><br><span class="line">    implementation <span class="string">&#x27;io.realm.kotlin:library-base:1.6.1&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在build.gradle(项目)文件中添加</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">plugins &#123;</span><br><span class="line">    ...</span><br><span class="line">    id <span class="string">&#x27;io.realm.kotlin&#x27;</span> version <span class="string">&#x27;1.6.1&#x27;</span> apply <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="定义object-model">定义Object Model</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io.realm.kotlin.types.ObjectId</span><br><span class="line"><span class="keyword">import</span> io.realm.kotlin.types.RealmObject</span><br><span class="line"><span class="keyword">import</span> io.realm.kotlin.types.annotations.PrimaryKey</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Item</span>() : RealmObject &#123;</span><br><span class="line">    <span class="meta">@PrimaryKey</span></span><br><span class="line">    <span class="keyword">var</span> _id: ObjectId = ObjectId.create()</span><br><span class="line">    <span class="keyword">var</span> isComplete: <span class="built_in">Boolean</span> = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> summary: String = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">var</span> owner_id: String = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(ownerId: String = <span class="string">&quot;&quot;</span>) : <span class="keyword">this</span>() &#123;</span><br><span class="line">        owner_id = ownerId</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="创建realm">创建Realm</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> config = RealmConfiguration.create(schema = setOf(Item::<span class="keyword">class</span>))</span><br><span class="line"><span class="keyword">val</span> realm: Realm = Realm.<span class="keyword">open</span>(config)</span><br></pre></td></tr></table></figure><h3 id="create-read-update-and-delete-objects">Create, Read, Update, and Delete Objects</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//To create a new Item, instantiate an instance of the Item class and add it to the realm in a write transaction block:</span></span><br><span class="line">realm.writeBlocking &#123;</span><br><span class="line">    copyToRealm(Item().apply &#123;</span><br><span class="line">        summary = <span class="string">&quot;Do the laundry&quot;</span></span><br><span class="line">        isComplete = <span class="literal">false</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//query</span></span><br><span class="line"><span class="comment">// all items in the realm</span></span><br><span class="line"><span class="keyword">val</span> items: RealmResults&lt;Item&gt; = realm.query&lt;Item&gt;().find()</span><br><span class="line"><span class="comment">//filter</span></span><br><span class="line"><span class="comment">// items in the realm whose name begins with the letter &#x27;D&#x27;</span></span><br><span class="line"><span class="keyword">val</span> itemsThatBeginWIthD: RealmResults&lt;Item&gt; =</span><br><span class="line">    realm.query&lt;Item&gt;(<span class="string">&quot;summary BEGINSWITH $0&quot;</span>, <span class="string">&quot;D&quot;</span>)</span><br><span class="line">        .find()</span><br><span class="line"><span class="comment">//  todo items that have not been completed yet</span></span><br><span class="line"><span class="keyword">val</span> incompleteItems: RealmResults&lt;Item&gt; =</span><br><span class="line">    realm.query&lt;Item&gt;(<span class="string">&quot;isComplete == false&quot;</span>)</span><br><span class="line">        .find()</span><br><span class="line"></span><br><span class="line"><span class="comment">//To modify a Todo item, update its properties in a write transaction block:</span></span><br><span class="line"><span class="comment">// change the first item with open status to complete to show that the todo item has been done</span></span><br><span class="line">realm.writeBlocking &#123;</span><br><span class="line">    findLatest(incompleteItems[<span class="number">0</span>])?.isComplete = <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//delete a Todo item by calling mutableRealm.delete() in a write transaction block:</span></span><br><span class="line"><span class="comment">// delete the first item in the realm</span></span><br><span class="line">realm.writeBlocking &#123;</span><br><span class="line">    <span class="keyword">val</span> writeTransactionItems = query&lt;Item&gt;().find()</span><br><span class="line">    delete(writeTransactionItems.first())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="watch-for-changes">Watch for Changes</h3><p>下面这个例子监听所有Item objects的变化</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// flow.collect() is blocking -- run it in a background context</span></span><br><span class="line"><span class="keyword">val</span> job = CoroutineScope(Dispatchers.Default).launch &#123;</span><br><span class="line">    <span class="comment">// create a Flow from the Item collection, then add a listener to the Flow</span></span><br><span class="line">    <span class="keyword">val</span> itemsFlow = items.asFlow()</span><br><span class="line">    itemsFlow.collect &#123; changes: ResultsChange&lt;Item&gt; -&gt;</span><br><span class="line">        <span class="keyword">when</span> (changes) &#123;</span><br><span class="line">            <span class="comment">// UpdatedResults means this change represents an update/insert/delete operation</span></span><br><span class="line">            <span class="keyword">is</span> UpdatedResults -&gt; &#123;</span><br><span class="line">                changes.insertions <span class="comment">// indexes of inserted objects</span></span><br><span class="line">                changes.insertionRanges <span class="comment">// ranges of inserted objects</span></span><br><span class="line">                changes.changes <span class="comment">// indexes of modified objects</span></span><br><span class="line">                changes.changeRanges <span class="comment">// ranges of modified objects</span></span><br><span class="line">                changes.deletions <span class="comment">// indexes of deleted objects</span></span><br><span class="line">                changes.deletionRanges <span class="comment">// ranges of deleted objects</span></span><br><span class="line">                changes.list <span class="comment">// the full collection of objects</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> -&gt; &#123;</span><br><span class="line">                <span class="comment">// types other than UpdatedResults are not changes -- ignore them</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当我们完成观察后，记得取消job以关闭携程</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">job.cancel() <span class="comment">// cancel the coroutine containing the listener</span></span><br></pre></td></tr></table></figure><h3 id="关闭realm">关闭Realm</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">realm.close()</span><br></pre></td></tr></table></figure><h3 id="查看数据库文件软件">查看数据库文件软件</h3><div class='tag-link-1'><a class="tag-Link" target="_blank" href=" https://www.mongodb.com/docs/realm/studio/">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://api.iowen.cn/favicon/www.mongodb.com/docs/realm/studio/.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">Realm Studio</div>            <div class="tag-link-sitename"> https://www.mongodb.com/docs/realm/studio/</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div><h3 id="案例代码地址">案例代码地址</h3><div class='tag-link-1'><a class="tag-Link" target="_blank" href=" https://github.com/liaojie1314/MongoDBRealmTest">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://api.iowen.cn/favicon/github.com/liaojie1314/MongoDBRealmTest.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">github代码地址</div>            <div class="tag-link-sitename"> https://github.com/liaojie1314/MongoDBRealmTest</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div><h2 id="room-vs-mongodb-realm">Room VS MongoDB Realm</h2><h3 id="room">Room</h3><p>Room是一个开源数据库，由谷歌专门为Android应用程序开发，它被设计成一个轻量级的高效且易于使用的传统SQLite数据库,它使用对象关系映射的概念(ORM)映射Java或co-objects到Room数据库表。</p><p>优点</p><ul><li>Integration with the AAC(与Android架构组件的集成)</li><li>Strong typing(强大键入功能,有助于防止编译时的错误)</li><li>Easy to use</li><li>Good performance</li></ul><p>缺点</p><ul><li>Security</li><li>Cross-platform</li></ul><h3 id="mongodb-realm">MongoDB Realm</h3><p><a href="https://www.mongodb.com/realm/mobile/database">Realm</a> 是一个专门为移动端设计的数据库。主要特点是性能好，易使用。在移动端 Realm 颇有一些人气，在轻量的场景下使用还是挺适合的。随着 App 的发展，越来越多的本地数据需要和服务器进行同步。如果团队自己开发，需要制定服务器端数据库的格式（和移动端数据库不一样）、服务器端的存储、需要写一个和服务器进行数据同步的程序。对于小团队而言，为了实现这个需求可是不小的工作量。如果 Realm 也提供一个在云上数据库，再提供一个同步的程序。那么数据同步的需求对于中小规模开发者就非常变得非常轻松了。于是 Realm 推出了 Realm Platform，也叫 Realm Cloud。Realm platform 的收费也是按照容量来算钱。</p><p>MongoDB 是一个流行的 NoSQL 数据库，主要是在服务器端使用。后来推出了基于云端的 MongoDB Atlas。随着移动互联网的发展，MongoDB 就想着开发一个在移动端的服务，可以把数据方便的同步到 MongoDB Atlas 上。MongoDB 当时发布了一个 iOS 端的 beta SDK。</p><p>优点</p><ul><li>Cross-platform</li><li>Serverless database</li><li>Device Sync</li><li>Query language</li><li>Security</li></ul><p>缺点</p><ul><li>Learning curve</li><li>Pricing</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;使用realm&quot;&gt;使用Realm&lt;/h2&gt;
&lt;div class=&#39;tag-link-1&#39;&gt;&lt;a class=&quot;tag-Link&quot; target=&quot;_blank&quot; href=&quot; https://www.mongodb.com/docs/realm/sdk/kotl</summary>
      
    
    
    
    <category term="编程进阶" scheme="https://www.yuanyuan.blog/categories/%E7%BC%96%E7%A8%8B%E8%BF%9B%E9%98%B6/"/>
    
    
    <category term="Android" scheme="https://www.yuanyuan.blog/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>小型录音机</title>
    <link href="https://www.yuanyuan.blog/posts/b4b7793c.html"/>
    <id>https://www.yuanyuan.blog/posts/b4b7793c.html</id>
    <published>2023-03-01T19:46:07.000Z</published>
    <updated>2024-01-14T15:51:58.794Z</updated>
    
    <content type="html"><![CDATA[<h3 id="record相关">record相关</h3><h4 id="audiorecorder-kt">AudioRecorder.kt</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">AudioRecorder</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">start</span><span class="params">(outputFile: <span class="type">File</span>)</span></span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">stop</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="androidaudiorecorder-kt">AndroidAudioRecorder.kt</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.media.MediaRecorder</span><br><span class="line"><span class="keyword">import</span> android.os.Build</span><br><span class="line"><span class="keyword">import</span> android.provider.MediaStore.Audio.Media</span><br><span class="line"><span class="keyword">import</span> java.io.File</span><br><span class="line"><span class="keyword">import</span> java.io.FileOutputStream</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AndroidAudioRecorder</span>(</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> context: Context</span><br><span class="line">): AudioRecorder &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> recorder: MediaRecorder? = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">createRecorder</span><span class="params">()</span></span>: MediaRecorder &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">if</span>(Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.S) &#123;</span><br><span class="line">            MediaRecorder(context)</span><br><span class="line">        &#125; <span class="keyword">else</span> MediaRecorder()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">start</span><span class="params">(outputFile: <span class="type">File</span>)</span></span> &#123;</span><br><span class="line">        createRecorder().apply &#123;</span><br><span class="line">            setAudioSource(MediaRecorder.AudioSource.MIC)</span><br><span class="line">            setOutputFormat(MediaRecorder.OutputFormat.MPEG_4)</span><br><span class="line">            setAudioEncoder(MediaRecorder.AudioEncoder.AAC)</span><br><span class="line">            setOutputFile(FileOutputStream(outputFile).fd)</span><br><span class="line"></span><br><span class="line">            prepare()</span><br><span class="line">            start()</span><br><span class="line"></span><br><span class="line">            recorder = <span class="keyword">this</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">stop</span><span class="params">()</span></span> &#123;</span><br><span class="line">        recorder?.stop()</span><br><span class="line">        recorder?.reset()</span><br><span class="line">        recorder = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="playback相关">playback相关</h3><h4 id="audioplayer-kt">AudioPlayer.kt</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.File</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">AudioPlayer</span> &#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">playFile</span><span class="params">(file: <span class="type">File</span>)</span></span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">stop</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="androidaudioplayer-kt">AndroidAudioPlayer.kt</h4><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.content.Context</span><br><span class="line"><span class="keyword">import</span> android.media.MediaPlayer</span><br><span class="line"><span class="keyword">import</span> androidx.core.net.toUri</span><br><span class="line"><span class="keyword">import</span> java.io.File</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AndroidAudioPlayer</span>(</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> context: Context</span><br><span class="line">): AudioPlayer &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> player: MediaPlayer? = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">playFile</span><span class="params">(file: <span class="type">File</span>)</span></span> &#123;</span><br><span class="line">        MediaPlayer.create(context, file.toUri()).apply &#123;</span><br><span class="line">            player = <span class="keyword">this</span></span><br><span class="line">            start()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">stop</span><span class="params">()</span></span> &#123;</span><br><span class="line">        player?.stop()</span><br><span class="line">        player?.release()</span><br><span class="line">        player = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="使用">使用</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.Manifest</span><br><span class="line"><span class="keyword">import</span> android.os.Bundle</span><br><span class="line"><span class="keyword">import</span> androidx.activity.ComponentActivity</span><br><span class="line"><span class="keyword">import</span> androidx.activity.compose.setContent</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.Arrangement</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.Column</span><br><span class="line"><span class="keyword">import</span> androidx.compose.foundation.layout.fillMaxSize</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material.Button</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material.MaterialTheme</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material.Surface</span><br><span class="line"><span class="keyword">import</span> androidx.compose.material.Text</span><br><span class="line"><span class="keyword">import</span> androidx.compose.runtime.Composable</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Alignment</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.Modifier</span><br><span class="line"><span class="keyword">import</span> androidx.compose.ui.tooling.preview.Preview</span><br><span class="line"><span class="keyword">import</span> androidx.core.app.ActivityCompat</span><br><span class="line"><span class="keyword">import</span> java.io.File</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MainActivity</span> : <span class="type">ComponentActivity</span>() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> recorder <span class="keyword">by</span> lazy &#123;</span><br><span class="line">        AndroidAudioRecorder(applicationContext)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> player <span class="keyword">by</span> lazy &#123;</span><br><span class="line">        AndroidAudioPlayer(applicationContext)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> audioFile: File? = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        ActivityCompat.requestPermissions(</span><br><span class="line">            <span class="keyword">this</span>,</span><br><span class="line">            arrayOf(Manifest.permission.RECORD_AUDIO),</span><br><span class="line">            <span class="number">0</span></span><br><span class="line">        )</span><br><span class="line">        setContent &#123;</span><br><span class="line">            AudioRecorderTheme &#123;</span><br><span class="line">                Column(</span><br><span class="line">                    modifier = Modifier.fillMaxSize(),</span><br><span class="line">                    verticalArrangement = Arrangement.Center,</span><br><span class="line">                    horizontalAlignment = Alignment.CenterHorizontally</span><br><span class="line">                ) &#123;</span><br><span class="line">                    Button(onClick = &#123;</span><br><span class="line">                        File(cacheDir, <span class="string">&quot;audio.mp3&quot;</span>).also &#123;</span><br><span class="line">                            recorder.start(it)</span><br><span class="line">                            audioFile = it</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;) &#123;</span><br><span class="line">                        Text(text = <span class="string">&quot;Start recording&quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                    Button(onClick = &#123;</span><br><span class="line">                        recorder.stop()</span><br><span class="line">                    &#125;) &#123;</span><br><span class="line">                        Text(text = <span class="string">&quot;Stop recording&quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                    Button(onClick = &#123;</span><br><span class="line">                        player.playFile(audioFile ?: <span class="keyword">return</span><span class="symbol">@Button</span>)</span><br><span class="line">                    &#125;) &#123;</span><br><span class="line">                        Text(text = <span class="string">&quot;Play&quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                    Button(onClick = &#123;</span><br><span class="line">                        player.stop()</span><br><span class="line">                    &#125;) &#123;</span><br><span class="line">                        Text(text = <span class="string">&quot;Stop playing&quot;</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;record相关&quot;&gt;record相关&lt;/h3&gt;
&lt;h4 id=&quot;audiorecorder-kt&quot;&gt;AudioRecorder.kt&lt;/h4&gt;
&lt;figure class=&quot;highlight kotlin&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutte</summary>
      
    
    
    
    <category term="个人资料" scheme="https://www.yuanyuan.blog/categories/%E4%B8%AA%E4%BA%BA%E8%B5%84%E6%96%99/"/>
    
    
    <category term="Android" scheme="https://www.yuanyuan.blog/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>Redis（十二）拓展：Redis的面试题整理和解答</title>
    <link href="https://www.yuanyuan.blog/posts/9ad3a763.html"/>
    <id>https://www.yuanyuan.blog/posts/9ad3a763.html</id>
    <published>2023-01-28T21:09:29.000Z</published>
    <updated>2024-01-14T15:51:58.802Z</updated>
    
    <content type="html"><![CDATA[<h2 id="概述">概述</h2><h3 id="什么是redis">什么是Redis</h3><p>Redis(Remote Dictionary Server) 是一个使用 C 语言编写的，开源的（BSD许可）高性能非关系型（NoSQL）的键值对数据库。</p><p>Redis 可以存储键和五种不同类型的值之间的映射。键的类型只能为字符串，值支持五种数据类型：字符串、列表、集合、散列表、有序集合。</p><p>与传统数据库不同的是 Redis 的数据是存在内存中的，所以读写速度非常快，因此 redis 被广泛应用于缓存方向，每秒可以处理超过 10万次读写操作，是已知性能最快的Key-Value DB。另外，Redis 也经常用来做分布式锁。除此之外，Redis 支持事务 、持久化、LUA脚本、LRU驱动事件、多种集群方案。</p><h3 id="redis有哪些优缺点">Redis有哪些优缺点</h3><p>优点</p><ul><li>读写性能优异， Redis能读的速度是110000次/s，写的速度是81000次/s。</li><li>支持数据持久化，支持AOF和RDB两种持久化方式。</li><li>支持事务，Redis的所有操作都是原子性的，同时Redis还支持对几个操作合并后的原子性执行。</li><li>数据结构丰富，除了支持string类型的value外还支持hash、set、zset、list等数据结构。</li><li>支持主从复制，主机会自动将数据同步到从机，可以进行读写分离。</li></ul><p>缺点</p><ul><li>数据库容量受到物理内存的限制，不能用作海量数据的高性能读写，因此Redis适合的场景主要局限在较小数据量的高性能操作和运算上。</li><li>Redis 不具备自动容错和恢复功能，主机从机的宕机都会导致前端部分读写请求失败，需要等待机器重启或者手动切换前端的IP才能恢复。</li><li>主机宕机，宕机前有部分数据未能及时同步到从机，切换IP后还会引入数据不一致的问题，降低了系统的可用性。</li><li>Redis 较难支持在线扩容，在集群容量达到上限时在线扩容会变得很复杂。为避免这一问题，运维人员在系统上线时必须确保有足够的空间，这对资源造成了很大的浪费。</li></ul><h3 id="为什么要用-redis-为什么要用缓存">为什么要用 Redis /为什么要用缓存</h3><p>主要从“高性能”和“高并发”这两点来看待这个问题。</p><p><strong>高性能：</strong></p><p>假如用户第一次访问数据库中的某些数据。这个过程会比较慢，因为是从硬盘上读取的。将该用户访问的数据存在数缓存中，这样下一次再访问这些数据的时候就可以直接从缓存中获取了。操作缓存就是直接操作内存，所以速度相当快。如果数据库中的对应数据改变的之后，同步改变缓存中相应的数据即可！<br><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202301311635272.png" alt="image-20230131163520168" style="zoom:80%;" /></p><p><strong>高并发：</strong></p><p>直接操作缓存能够承受的请求是远远大于直接访问数据库的，所以我们可以考虑把数据库中的部分数据转移到缓存中去，这样用户的一部分请求会直接到缓存这里而不用经过数据库。</p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202301311644086.png" alt="aHR0cHM6Ly91cGxvYWQtaW1hZ2VzLmppYW5zaHUuaW8vdXBsb2FkX2ltYWdlcy8xNDUzNDg2OS0wOWIxZDI3OWEwNWVmNWJjLmpwZw" style="zoom:80%;" /><h3 id="为什么要用-redis-而不用-map-guava-做缓存">为什么要用 Redis 而不用 map/guava 做缓存?</h3><p>缓存分为本地缓存和分布式缓存。以 Java 为例，使用自带的 map 或者 guava 实现的是本地缓存，最主要的特点是轻量以及快速，生命周期随着 jvm 的销毁而结束，并且在多实例的情况下，每个实例都需要各自保存一份缓存，缓存不具有一致性。</p><p>使用 redis 或 memcached 之类的称为分布式缓存，在多实例的情况下，各实例共用一份缓存数据，缓存具有一致性。缺点是需要保持 redis 或 memcached服务的高可用，整个程序架构上较为复杂。</p><h3 id="redis为什么这么快">Redis为什么这么快</h3><p>1、完全基于内存，绝大部分请求是纯粹的内存操作，非常快速。数据存在内存中，类似于 HashMap，HashMap 的优势就是查找和操作的时间复杂度都是O(1)；</p><p>2、数据结构简单，对数据操作也简单，Redis 中的数据结构是专门进行设计的；</p><p>3、采用单线程，避免了不必要的上下文切换和竞争条件，也不存在多进程或者多线程导致的切换而消耗 CPU，不用去考虑各种锁的问题，不存在加锁释放锁操作，没有因为可能出现死锁而导致的性能消耗；</p><p>4、使用多路 I/O 复用模型，非阻塞 IO；</p><p>5、使用底层模型不同，它们之间底层实现方式以及与客户端之间通信的应用协议不一样，Redis 直接自己构建了 VM 机制 ，因为一般的系统调用系统函数的话，会浪费一定的时间去移动和请求；</p><h2 id="数据类型">数据类型</h2><h3 id="redis有哪些数据类型">Redis有哪些数据类型</h3><p>Redis主要有5种数据类型，包括String，List，Set，Zset，Hash，满足大部分的使用要求</p><table><thead><tr><th style="text-align:center">数据类型</th><th style="text-align:center">可以存储的值</th><th style="text-align:center">操作</th><th style="text-align:center">应用场景</th></tr></thead><tbody><tr><td style="text-align:center">STRING</td><td style="text-align:center">字符串、整数或者浮点数</td><td style="text-align:center">对整个字符串或者字符串的其中一部分执行操作 对整数和浮点数执行自增或者自减操作</td><td style="text-align:center">做简单的键值对缓存</td></tr><tr><td style="text-align:center">LIST</td><td style="text-align:center">列表</td><td style="text-align:center">从两端压入或者弹出元素 对单个或者多个元素进行修剪， 只保留一个范围内的元素</td><td style="text-align:center">存储一些列表型的数据结构，类似粉丝列表、文章的评论列表之类的数据</td></tr><tr><td style="text-align:center">SET</td><td style="text-align:center">无序集合</td><td style="text-align:center">添加、获取、移除单个元素 检查一个元素是否存在于集合中 计算交集、并集、差集 从集合里面随机获取元素</td><td style="text-align:center">交集、并集、差集的操作，比如交集，可以把两个人的粉丝列表整一个交集</td></tr><tr><td style="text-align:center">HASH</td><td style="text-align:center">包含键值对的无序散列表</td><td style="text-align:center">添加、获取、移除单个键值对 获取所有键值对 检查某个键是否存在</td><td style="text-align:center">结构化的数据，比如一个对象</td></tr><tr><td style="text-align:center">ZSET</td><td style="text-align:center">有序集合</td><td style="text-align:center">添加、获取、删除元素 根据分值范围或者成员来获取元素 计算一个键的排名</td><td style="text-align:center">去重但可以排序，如获取排名前几名的用户</td></tr></tbody></table><h3 id="redis的应用场景">Redis的应用场景</h3><p><strong>总结一</strong></p><p>计数器</p><p>可以对 String 进行自增自减运算，从而实现计数器功能。Redis 这种内存型数据库的读写性能非常高，很适合存储频繁读写的计数量。</p><p>缓存</p><p>将热点数据放到内存中，设置内存的最大使用量以及淘汰策略来保证缓存的命中率。</p><p>会话缓存</p><p>可以使用 Redis 来统一存储多台应用服务器的会话信息。当应用服务器不再存储用户的会话信息，也就不再具有状态，一个用户可以请求任意一个应用服务器，从而更容易实现高可用性以及可伸缩性。</p><p>全页缓存（FPC）</p><p>除基本的会话token之外，Redis还提供很简便的FPC平台。以Magento为例，Magento提供一个插件来使用Redis作为全页缓存后端。此外，对WordPress的用户来说，Pantheon有一个非常好的插件 wp-redis，这个插件能帮助你以最快速度加载你曾浏览过的页面。</p><p>查找表</p><p>例如 DNS 记录就很适合使用 Redis 进行存储。查找表和缓存类似，也是利用了 Redis 快速的查找特性。但是查找表的内容不能失效，而缓存的内容可以失效，因为缓存不作为可靠的数据来源。</p><p>消息队列(发布/订阅功能)</p><p>List 是一个双向链表，可以通过 lpush 和 rpop 写入和读取消息。不过最好使用 Kafka、RabbitMQ 等消息中间件。</p><p>分布式锁实现</p><p>在分布式场景下，无法使用单机环境下的锁来对多个节点上的进程进行同步。可以使用 Redis 自带的 SETNX 命令实现分布式锁，除此之外，还可以使用官方提供的 RedLock 分布式锁实现。</p><p>其它</p><p>Set 可以实现交集、并集等操作，从而实现共同好友等功能。ZSet 可以实现有序性操作，从而实现排行榜等功能。</p><p><strong>总结二</strong></p><p>Redis相比其他缓存，有一个非常大的优势，就是支持多种数据类型。</p><p>数据类型说明string字符串，最简单的k-v存储hashhash格式，value为field和value，适合ID-Detail这样的场景。list简单的list，顺序列表，支持首位或者末尾插入数据set无序list，查找速度快，适合交集、并集、差集处理sorted set有序的set</p><p>其实，通过上面的数据类型的特性，基本就能想到合适的应用场景了。</p><p>string——适合最简单的k-v存储，类似于memcached的存储结构，短信验证码，配置信息等，就用这种类型来存储。</p><p>hash——一般key为ID或者唯一标示，value对应的就是详情了。如商品详情，个人信息详情，新闻详情等。</p><p>list——因为list是有序的，比较适合存储一些有序且数据相对固定的数据。如省市区表、字典表等。因为list是有序的，适合根据写入的时间来排序，如：消息队列等。<br>set——可以简单的理解为ID-List的模式，如微博中一个人有哪些好友，set最牛的地方在于，可以对两个set提供交集、并集、差集操作。例如：查找两个人共同的好友等。</p><p>Sorted Set——是set的增强版本，增加了一个score参数，自动会根据score的值进行排序。比较适合类似于top 10等不根据插入的时间来排序的数据。</p><p>如上所述，虽然Redis不像关系数据库那么复杂的数据结构，但是，也能适合很多场景，比一般的缓存数据结构要多。了解每种数据结构适合的业务场景，不仅有利于提升开发效率，也能有效利用Redis的性能。</p><h2 id="持久化">持久化</h2><h3 id="什么是redis持久化？">什么是Redis持久化？</h3><p>持久化就是把内存的数据写到磁盘中去，防止服务宕机了内存数据丢失。</p><h3 id="redis-的持久化机制是什么？各自的优缺点？">Redis 的持久化机制是什么？各自的优缺点？</h3><p>Redis 提供两种持久化机制 RDB（默认） 和 AOF 机制:</p><p>RDB：是Redis DataBase缩写快照</p><p>RDB是Redis默认的持久化方式。按照一定的时间将内存的数据以快照的形式保存到硬盘中，对应产生的数据文件为dump.rdb。通过配置文件中的save参数来定义快照的周期。</p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202301311645562.png" alt="image-20230131164545525" style="zoom:67%;" /><p>优点：</p><ul><li>1、只有一个文件 dump.rdb，方便持久化。</li><li>2、容灾性好，一个文件可以保存到安全的磁盘。</li><li>3、性能最大化，fork 子进程来完成写操作，让主进程继续处理命令，所以是 IO 最大化。使用单独子进程来进行持久化，主进程不会进行任何 IO 操作，保证了 redis 的高性能</li><li>4.相对于数据集大时，比 AOF 的启动效率更高。</li></ul><p>缺点：</p><ul><li>1、数据安全性低。RDB 是间隔一段时间进行持久化，如果持久化之间 redis 发生故障，会发生数据丢失。所以这种方式更适合数据要求不严谨的时候</li><li>2、AOF（Append-only file)持久化方式： 是指所有的命令行记录以 redis 命令请 求协议的格式完全持久化存储)保存为 aof 文件。</li></ul><p>AOF：持久化</p><p>AOF持久化(即Append Only File持久化)，则是将Redis执行的每次写命令记录到单独的日志文件中，当重启Redis会重新将持久化的日志中文件恢复数据。</p><p>当两种方式同时开启时，数据恢复Redis会优先选择AOF恢复。</p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202301311647120.png" alt="image-20230131164713055" style="zoom:67%;" /><p>优点：</p><ul><li>1、数据安全，aof 持久化可以配置 appendfsync 属性，有 always，每进行一次 命令操作就记录到 aof 文件中一次。</li><li>2、通过 append 模式写文件，即使中途服务器宕机，可以通过 redis-check-aof 工具解决数据一致性问题。</li><li>3、AOF 机制的 rewrite 模式。AOF 文件没被 rewrite 之前（文件过大时会对命令 进行合并重写），可以删除其中的某些命令（比如误操作的 flushall）)</li></ul><p>缺点：</p><ul><li>1、AOF 文件比 RDB 文件大，且恢复速度慢。</li><li>2、数据集大的时候，比 rdb 启动效率低。</li></ul><p>优缺点是什么？</p><ul><li>AOF文件比RDB更新频率高，优先使用AOF还原数据。</li><li>AOF比RDB更安全也更大</li><li>RDB性能比AOF好</li><li>如果两个都配了优先加载AOF</li></ul><h3 id="如何选择合适的持久化方式">如何选择合适的持久化方式</h3><ul><li><p>一般来说， 如果想达到足以媲美PostgreSQL的数据安全性，你应该同时使用两种持久化功能。在这种情况下，当 Redis 重启的时候会优先载入AOF文件来恢复原始的数据，因为在通常情况下AOF文件保存的数据集要比RDB文件保存的数据集要完整。</p></li><li><p>如果你非常关心你的数据， 但仍然可以承受数分钟以内的数据丢失，那么你可以只使用RDB持久化。</p></li><li><p>有很多用户都只使用AOF持久化，但并不推荐这种方式，因为定时生成RDB快照（snapshot）非常便于进行数据库备份， 并且 RDB 恢复数据集的速度也要比AOF恢复的速度要快，除此之外，使用RDB还可以避免AOF程序的bug。</p></li><li><p>如果你只希望你的数据在服务器运行的时候存在，你也可以不使用任何持久化方式。</p></li></ul><h3 id="redis持久化数据和缓存怎么做扩容？">Redis持久化数据和缓存怎么做扩容？</h3><ul><li>如果Redis被当做缓存使用，使用一致性哈希实现动态扩容缩容。</li><li>如果Redis被当做一个持久化存储使用，必须使用固定的keys-to-nodes映射关系，节点的数量一旦确定不能变化。否则的话(即Redis节点需要动态变化的情况），必须使用可以在运行时进行数据再平衡的一套系统，而当前只有Redis集群可以做到这样。</li></ul><h2 id="过期键的删除策略">过期键的删除策略</h2><h3 id="redis的过期键的删除策略">Redis的过期键的删除策略</h3><p>我们都知道，Redis是key-value数据库，我们可以设置Redis中缓存的key的过期时间。Redis的过期策略就是指当Redis中缓存的key过期了，Redis如何处理。</p><p>过期策略通常有以下三种：</p><ul><li><p>定时过期：每个设置过期时间的key都需要创建一个定时器，到过期时间就会立即清除。该策略可以立即清除过期的数据，对内存很友好；但是会占用大量的CPU资源去处理过期的数据，从而影响缓存的响应时间和吞吐量。</p></li><li><p>惰性过期：只有当访问一个key时，才会判断该key是否已过期，过期则清除。该策略可以最大化地节省CPU资源，却对内存非常不友好。极端情况可能出现大量的过期key没有再次被访问，从而不会被清除，占用大量内存。</p></li></ul><ul><li>定期过期：每隔一定的时间，会扫描一定数量的数据库的expires字典中一定数量的key，并清除其中已过期的key。该策略是前两者的一个折中方案。通过调整定时扫描的时间间隔和每次扫描的限定耗时，可以在不同情况下使得CPU和内存资源达到最优的平衡效果。<br>(expires字典会保存所有设置了过期时间的key的过期时间数据，其中，key是指向键空间中的某个键的指针，value是该键的毫秒精度的UNIX时间戳表示的过期时间。键空间是指该Redis集群中保存的所有键。)</li></ul><p>Redis中同时使用了惰性过期和定期过期两种过期策略。</p><h3 id="redis-key的过期时间和永久有效分别怎么设置？">Redis key的过期时间和永久有效分别怎么设置？</h3><p>EXPIRE和PERSIST命令。</p><h3 id="我们知道通过expire来设置key-的过期时间-那么对过期的数据怎么处理呢">我们知道通过expire来设置key 的过期时间，那么对过期的数据怎么处理呢?</h3><p>除了缓存服务器自带的缓存失效策略之外（Redis默认的有6中策略可供选择），我们还可以根据具体的业务需求进行自定义的缓存淘汰，常见的策略有两种：</p><ol><li>定时去清理过期的缓存；</li><li>当有用户请求过来时，再判断这个请求所用到的缓存是否过期，过期的话就去底层系统得到新数据并更新缓存。</li></ol><p>两者各有优劣，第一种的缺点是维护大量缓存的key是比较麻烦的，第二种的缺点就是每次用户请求过来都要判断缓存失效，逻辑相对比较复杂！具体用哪种方案，大家可以根据自己的应用场景来权衡。</p><h2 id="内存相关">内存相关</h2><h3 id="mysql里有2000w数据-redis中只存20w的数据-如何保证redis中的数据都是热点数据">MySQL里有2000w数据，redis中只存20w的数据，如何保证redis中的数据都是热点数据</h3><p>redis内存数据集大小上升到一定大小的时候，就会施行数据淘汰策略。</p><h3 id="redis的内存淘汰策略有哪些">Redis的内存淘汰策略有哪些</h3><p>Redis的内存淘汰策略是指在Redis的用于缓存的内存不足时，怎么处理需要新写入且需要申请额外空间的数据。</p><p><strong>全局的键空间选择性移除</strong></p><ul><li>noeviction：当内存不足以容纳新写入数据时，新写入操作会报错。</li><li>allkeys-lru：当内存不足以容纳新写入数据时，在键空间中，移除最近最少使用的key。（这个是<strong>最常用</strong>的）</li><li>allkeys-random：当内存不足以容纳新写入数据时，在键空间中，随机移除某个key。</li></ul><p><strong>设置过期时间的键空间选择性移除</strong></p><ul><li><p>volatile-lru：当内存不足以容纳新写入数据时，在设置了过期时间的键空间中，移除最近最少使用的key。</p></li><li><p>volatile-random：当内存不足以容纳新写入数据时，在设置了过期时间的键空间中，随机移除某个key。</p></li><li><p>volatile-ttl：当内存不足以容纳新写入数据时，在设置了过期时间的键空间中，有更早过期时间的key优先移除。</p></li></ul><p><strong>总结</strong></p><p>Redis的内存淘汰策略的选取并不会影响过期的key的处理。内存淘汰策略用于处理内存不足时的需要申请额外空间的数据；过期策略用于处理过期的缓存数据。</p><h3 id="redis主要消耗什么物理资源？">Redis主要消耗什么物理资源？</h3><p>内存。</p><h3 id="redis的内存用完了会发生什么？">Redis的内存用完了会发生什么？</h3><p>如果达到设置的上限，Redis的写命令会返回错误信息（但是读命令还可以正常返回。）或者你可以配置内存淘汰机制，当Redis达到内存上限时会冲刷掉旧的内容。</p><h3 id="redis如何做内存优化？">Redis如何做内存优化？</h3><p>可以好好利用Hash,list,sorted set,set等集合类型数据，因为通常情况下很多小的Key-Value可以用更紧凑的方式存放到一起。尽可能使用散列表（hashes），散列表（是说散列表里面存储的数少）使用的内存非常小，所以你应该尽可能的将你的数据模型抽象到一个散列表里面。比如你的web系统中有一个用户对象，不要为这个用户的名称，姓氏，邮箱，密码设置单独的key，而是应该把这个用户的所有信息存储到一张散列表里面线程模型</p><h3 id="redis线程模型">Redis线程模型</h3><p>Redis基于Reactor模式开发了网络事件处理器，这个处理器被称为文件事件处理器（file event handler）。它的组成结构为4部分：多个套接字、IO多路复用程序、文件事件分派器、事件处理器。因为文件事件分派器队列的消费是单线程的，所以Redis才叫单线程模型。</p><ul><li>文件事件处理器使用 I/O 多路复用（multiplexing）程序来同时监听多个套接字， 并根据套接字目前执行的任务来为套接字关联不同的事件处理器。</li><li>当被监听的套接字准备好执行连接应答（accept）、读取（read）、写入（write）、关闭（close）等操作时， 与操作相对应的文件事件就会产生， 这时文件事件处理器就会调用套接字之前关联好的事件处理器来处理这些事件。</li></ul><p>虽然文件事件处理器以单线程方式运行， 但通过使用 I/O 多路复用程序来监听多个套接字， 文件事件处理器既实现了高性能的网络通信模型， 又可以很好地与 redis 服务器中其他同样以单线程方式运行的模块进行对接， 这保持了 Redis 内部单线程设计的简单性。</p><h2 id="事务">事务</h2><h3 id="什么是事务？">什么是事务？</h3><p>事务是一个单独的隔离操作：事务中的所有命令都会序列化、按顺序地执行。事务在执行的过程中，不会被其他客户端发送来的命令请求所打断。</p><p>事务是一个原子操作：事务中的命令要么全部被执行，要么全部都不执行。</p><h3 id="redis事务的概念">Redis事务的概念</h3><p>Redis 事务的本质是通过MULTI、EXEC、WATCH等一组命令的集合。事务支持一次执行多个命令，一个事务中所有命令都会被序列化。在事务执行过程，会按照顺序串行化执行队列中的命令，其他客户端提交的命令请求不会插入到事务执行命令序列中。</p><p>总结说：redis事务就是一次性、顺序性、排他性的执行一个队列中的一系列命令。</p><h3 id="redis事务的三个阶段">Redis事务的三个阶段</h3><ol><li><p>事务开始 MULTI</p></li><li><p>命令入队</p></li><li><p>事务执行 EXEC</p></li></ol><p>事务执行过程中，如果服务端收到有EXEC、DISCARD、WATCH、MULTI之外的请求，将会把请求放入队列中排队</p><h3 id="redis事务相关命令">Redis事务相关命令</h3><p>Redis事务功能是通过MULTI、EXEC、DISCARD和WATCH 四个原语实现的</p><p>Redis会将一个事务中的所有命令序列化，然后按顺序执行。</p><ol><li><strong>redis 不支持回滚</strong>，“Redis 在事务失败时不进行回滚，而是继续执行余下的命令”， 所以 Redis 的内部可以保持简单且快速。</li><li><strong>如果在一个事务中的命令出现错误，那么所有的命令都不会执行</strong>；</li><li><strong>如果在一个事务中出现运行错误，那么正确的命令会被执行</strong>。</li></ol><ul><li>WATCH 命令是一个乐观锁，可以为 Redis 事务提供 check-and-set （CAS）行为。 可以监控一个或多个键，一旦其中有一个键被修改（或删除），之后的事务就不会执行，监控一直持续到EXEC命令。</li><li>MULTI命令用于开启一个事务，它总是返回OK。 MULTI执行之后，客户端可以继续向服务器发送任意多条命令，这些命令不会立即被执行，而是被放到一个队列中，当EXEC命令被调用时，所有队列中的命令才会被执行。</li></ul><ul><li>EXEC：执行所有事务块内的命令。返回事务块内所有命令的返回值，按命令执行的先后顺序排列。 当操作被打断时，返回空值 nil 。</li><li>通过调用DISCARD，客户端可以清空事务队列，并放弃执行事务， 并且客户端会从事务状态中退出。</li><li>UNWATCH命令可以取消watch对所有key的监控。</li></ul><h3 id="事务管理-acid-概述">事务管理（ACID）概述</h3><p>原子性（Atomicity）<br>原子性是指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。</p><p>一致性（Consistency）</p><p>事务前后数据的完整性必须保持一致。</p><p>隔离性（Isolation）<br>多个事务并发执行时，一个事务的执行不应影响其他事务的执行</p><p>持久性（Durability）<br>持久性是指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，接下来即使数据库发生故障也不应该对其有任何影响</p><p><strong>Redis的事务总是具有ACID中的一致性和隔离性</strong>，其他特性是不支持的。当服务器运行在<em>AOF</em>持久化模式下，并且appendfsync选项的值为always时，事务也具有耐久性。</p><h3 id="redis事务支持隔离性吗">Redis事务支持隔离性吗</h3><p>Redis 是单进程程序，并且它保证在执行事务时，不会对事务进行中断，事务可以运行直到执行完所有事务队列中的命令为止。因此，<strong>Redis 的事务是总是带有隔离性的</strong>。</p><h3 id="redis事务保证原子性吗-支持回滚吗">Redis事务保证原子性吗，支持回滚吗</h3><p>Redis中，单条命令是原子性执行的，但<strong>事务不保证原子性，且没有回滚</strong>。事务中任意命令执行失败，其余的命令仍会被执行。</p><h3 id="redis事务其他实现">Redis事务其他实现</h3><ul><li><p>基于Lua脚本，Redis可以保证脚本内的命令一次性、按顺序地执行，<br>其同时也不提供事务运行错误的回滚，执行过程中如果部分命令运行错误，剩下的命令还是会继续运行完</p></li><li><p>基于中间标记变量，通过另外的标记变量来标识事务是否执行完成，读取数据时先读取该标记变量判断是否事务执行完成。但这样会需要额外写代码实现，比较繁琐</p></li></ul><h2 id="集群方案">集群方案</h2><h3 id="哨兵模式">哨兵模式</h3><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202301311654118.png" alt="image-20230131165422933" style="zoom:67%;" /><p><strong>哨兵的介绍</strong></p><p>sentinel，中文名是哨兵。哨兵是 redis 集群机构中非常重要的一个组件，主要有以下功能：</p><ul><li>集群监控：负责监控 redis master 和 slave 进程是否正常工作。</li><li>消息通知：如果某个 redis 实例有故障，那么哨兵负责发送消息作为报警通知给管理员。</li><li>故障转移：如果 master node 挂掉了，会自动转移到 slave node 上。</li><li>配置中心：如果故障转移发生了，通知 client 客户端新的 master 地址。</li></ul><p><strong>哨兵用于实现 redis 集群的高可用</strong>，本身也是分布式的，作为一个哨兵集群去运行，互相协同工作。</p><ul><li><p>故障转移时，判断一个 master node 是否宕机了，需要大部分的哨兵都同意才行，涉及到了分布式选举的问题。</p></li><li><p>即使部分哨兵节点挂掉了，哨兵集群还是能正常工作的，因为如果一个作为高可用机制重要组成部分的故障转移系统本身是单点的，那就很坑爹了。</p></li></ul><p><strong>哨兵的核心知识</strong></p><ul><li>哨兵至少需要 3 个实例，来保证自己的健壮性。</li><li>哨兵 + redis 主从的部署架构，是<strong>不保证数据零丢失</strong>的，只能保证 redis 集群的高可用性。</li><li>对于哨兵 + redis 主从这种复杂的部署架构，尽量在测试环境和生产环境，都进行充足的测试和演练。</li></ul><h3 id="官方redis-cluster-方案-服务端路由查询">官方Redis Cluster 方案(服务端路由查询)</h3><p>redis 集群模式的工作原理能说一下么？在集群模式下，redis 的 key 是如何寻址的？分布式寻址都有哪些算法？了解一致性 hash 算法吗？</p><p><strong>简介</strong></p><p>Redis Cluster是一种服务端Sharding技术，3.0版本开始正式提供。Redis Cluster并没有使用一致性hash，而是采用slot(槽)的概念，一共分成16384个槽。将请求发送到任意节点，接收到请求的节点会将查询请求发送到正确的节点上执行</p><p><strong>方案说明</strong></p><ol><li><p>通过哈希的方式，将数据分片，每个节点均分存储一定哈希槽(哈希值)区间的数据，默认分配了16384 个槽位</p></li><li><p>每份数据分片会存储在多个互为主从的多节点上</p></li><li><p>数据写入先写主节点，再同步到从节点(支持配置为阻塞同步)</p></li><li><p>同一分片多个节点间的数据不保持一致性</p></li><li><p>读取数据时，当客户端操作的key没有分配在该节点上时，redis会返回转向指令，指向正确的节点</p></li><li><p>扩容时时需要需要把旧节点的数据迁移一部分到新节点</p></li></ol><p>在 redis cluster 架构下，每个 redis 要放开两个端口号，比如一个是 6379，另外一个就是 加1w 的端口号，比如 16379。</p><p>16379 端口号是用来进行节点间通信的，也就是 cluster bus 的东西，cluster bus 的通信，用来进行故障检测、配置更新、故障转移授权。cluster bus 用了另外一种二进制的协议，<strong>gossip</strong> 协议，用于节点间进行高效的数据交换，占用更少的网络带宽和处理时间。</p><p><strong>节点间的内部通信机制</strong></p><p>基本通信原理</p><p>集群元数据的维护有两种方式：集中式、Gossip 协议。redis cluster 节点间采用 gossip 协议进行通信。</p><p><strong>分布式寻址算法</strong></p><ul><li>hash 算法（大量缓存重建）</li><li>一致性 hash 算法（自动缓存迁移）+ 虚拟节点（自动负载均衡）</li><li>redis cluster 的 hash slot 算法</li></ul><p><strong>优点</strong></p><ul><li>无中心架构，支持动态扩容，对业务透明</li><li>具备Sentinel的监控和自动Failover(故障转移)能力</li><li>客户端不需要连接集群所有节点，连接集群中任何一个可用节点即可</li><li>高性能，客户端直连redis服务，免去了proxy代理的损耗</li></ul><p><strong>缺点</strong></p><ul><li>运维也很复杂，数据迁移需要人工干预</li><li>只能使用0号数据库</li><li>不支持批量操作(pipeline管道操作)</li><li>分布式逻辑和存储模块耦合等</li></ul><h3 id="基于客户端分配">基于客户端分配</h3><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202301311658319.png" alt="image-20230131165804257" style="zoom: 67%;" /><p><strong>简介</strong></p><p>Redis Sharding是Redis Cluster出来之前，业界普遍使用的多Redis实例集群方法。其主要思想是采用哈希算法将Redis数据的key进行散列，通过hash函数，特定的key会映射到特定的Redis节点上。Java redis客户端驱动jedis，支持Redis Sharding功能，即ShardedJedis以及结合缓存池的ShardedJedisPool</p><p><strong>优点</strong></p><p>优势在于非常简单，服务端的Redis实例彼此独立，相互无关联，每个Redis实例像单服务器一样运行，非常容易线性扩展，系统的灵活性很强</p><p><strong>缺点</strong></p><ul><li>由于sharding处理放到客户端，规模进一步扩大时给运维带来挑战。</li><li>客户端sharding不支持动态增删节点。服务端Redis实例群拓扑结构有变化时，每个客户端都需要更新调整。连接不能共享，当应用规模增大时，资源浪费制约优化</li></ul><h3 id="基于代理服务器分片">基于代理服务器分片</h3><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202301311659625.png" alt="image-20230131165901572" style="zoom:67%;" /><p><strong>简介</strong></p><p>客户端发送请求到一个代理组件，代理解析客户端的数据，并将请求转发至正确的节点，最后将结果回复给客户端</p><p><strong>特征</strong></p><ul><li>透明接入，业务程序不用关心后端Redis实例，切换成本低</li><li>Proxy 的逻辑和存储的逻辑是隔离的</li><li>代理层多了一次转发，性能有所损耗</li></ul><p><strong>业界开源方案</strong></p><ul><li>Twtter开源的Twemproxy</li><li>豌豆荚开源的Codis</li></ul><h3 id="redis-主从架构">Redis 主从架构</h3><p>单机的 redis，能够承载的 QPS 大概就在上万到几万不等。对于缓存来说，一般都是用来支撑<strong>读高并发</strong>的。因此架构做成主从(master-slave)架构，一主多从，主负责写，并且将数据复制到其它的 slave 节点，从节点负责读。所有的<strong>读请求全部走从节点</strong>。这样也可以很轻松实现水平扩容，<strong>支撑读高并发</strong>。<br><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202301311700471.png" alt="20200115180329317"></p><p>redis replication -&gt; 主从架构 -&gt; 读写分离 -&gt; 水平扩容支撑读高并发</p><p><strong>redis replication 的核心机制</strong></p><ul><li><p>redis 采用<strong>异步方式</strong>复制数据到 slave 节点，不过 redis2.8 开始，slave node 会周期性地确认自己每次复制的数据量；</p></li><li><p>一个 master node 是可以配置多个 slave node 的；</p></li><li><p>slave node 也可以连接其他的 slave node；</p></li><li><p>slave node 做复制的时候，不会 block master node 的正常工作；</p></li></ul><ul><li>slave node 在做复制的时候，也不会 block 对自己的查询操作，它会用旧的数据集来提供服务；但是复制完成的时候，需要删除旧数据集，加载新数据集，这个时候就会暂停对外服务了；</li><li>slave node 主要用来进行横向扩容，做读写分离，扩容的 slave node 可以提高读的吞吐量。</li></ul><p>注意，如果采用了主从架构，那么建议必须<strong>开启</strong> master node 的持久化，不建议用 slave node 作为 master node 的数据热备，因为那样的话，如果你关掉 master 的持久化，可能在 master 宕机重启的时候数据是空的，然后可能一经过复制， slave node 的数据也丢了。</p><p>另外，master 的各种备份方案，也需要做。万一本地的所有文件丢失了，从备份中挑选一份 rdb 去恢复 master，这样才能<strong>确保启动的时候，是有数据的</strong>，即使采用了后续讲解的高可用机制，slave node 可以自动接管 master node，但也可能 sentinel 还没检测到 master failure，master node 就自动重启了，还是可能导致上面所有的 slave node 数据被清空。</p><p><strong>redis 主从复制的核心原理</strong></p><p>当启动一个 slave node 的时候，它会发送一个 <code>PSYNC</code> 命令给 master node。</p><p>如果这是 slave node 初次连接到 master node，那么会触发一次 <code>full resynchronization</code> 全量复制。此时 master 会启动一个后台线程，开始生成一份 <code>RDB</code> 快照文件，</p><p>同时还会将从客户端 client 新收到的所有写命令缓存在内存中。<code>RDB</code> 文件生成完毕后， master 会将这个 <code>RDB</code> 发送给 slave，slave 会先<strong>写入本地磁盘，然后再从本地磁盘加载到内存</strong>中</p><p>接着 master 会将内存中缓存的写命令发送到 slave，slave 也会同步这些数据。</p><p>slave node 如果跟 master node 有网络故障，断开了连接，会自动重连，连接之后 master node 仅会复制给 slave 部分缺少的数据。</p><p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202301311702157.png" alt="20200115180337645"></p><p><strong>过程原理</strong></p><ol><li><p>当从库和主库建立MS关系后，会向主数据库发送SYNC命令</p></li><li><p>主库接收到SYNC命令后会开始在后台保存快照(RDB持久化过程)，并将期间接收到的写命令缓存起来</p></li><li><p>当快照完成后，主Redis会将快照文件和所有缓存的写命令发送给从Redis</p></li><li><p>从Redis接收到后，会载入快照文件并且执行收到的缓存的命令</p></li><li><p>之后，主Redis每当接收到写命令时就会将命令发送从Redis，从而保证数据的一致</p></li></ol><p><strong>缺点</strong></p><p>所有的slave节点数据的复制和同步都由master节点来处理，会照成master节点压力太大，使用主从从结构来解决</p><h3 id="redis集群的主从复制模型是怎样的？">Redis集群的主从复制模型是怎样的？</h3><p>为了使在部分节点失败或者大部分节点无法通信的情况下集群仍然可用，所以集群使用了主从复制模型，每个节点都会有N-1个复制品</p><h3 id="生产环境中的-redis-是怎么部署的？">生产环境中的 redis 是怎么部署的？</h3><p>redis cluster，10 台机器，5 台机器部署了 redis 主实例，另外 5 台机器部署了 redis 的从实例，每个主实例挂了一个从实例，5 个节点对外提供读写服务，每个节点的读写高峰qps可能可以达到每秒 5 万，5 台机器最多是 25 万读写请求/s。</p><p>机器是什么配置？32G 内存+ 8 核 CPU + 1T 磁盘，但是分配给 redis 进程的是10g内存，一般线上生产环境，redis 的内存尽量不要超过 10g，超过 10g 可能会有问题。</p><p>5 台机器对外提供读写，一共有 50g 内存。</p><p>因为每个主实例都挂了一个从实例，所以是高可用的，任何一个主实例宕机，都会自动故障迁移，redis 从实例会自动变成主实例继续提供读写服务。</p><p>你往内存里写的是什么数据？每条数据的大小是多少？商品数据，每条数据是 10kb。100 条数据是 1mb，10 万条数据是 1g。常驻内存的是 200 万条商品数据，占用内存是 20g，仅仅不到总内存的 50%。目前高峰期每秒就是 3500 左右的请求量。</p><p>其实大型的公司，会有基础架构的 team 负责缓存集群的运维。</p><h3 id="说说redis哈希槽的概念？">说说Redis哈希槽的概念？</h3><p>Redis集群没有使用一致性hash,而是引入了哈希槽的概念，Redis集群有16384个哈希槽，每个key通过CRC16校验后对16384取模来决定放置哪个槽，集群的每个节点负责一部分hash槽。</p><h3 id="redis集群会有写操作丢失吗？为什么？">Redis集群会有写操作丢失吗？为什么？</h3><p>Redis并不能保证数据的强一致性，这意味这在实际中集群在特定的条件下可能会丢失写操作。</p><h3 id="redis集群之间是如何复制的？">Redis集群之间是如何复制的？</h3><p>异步复制</p><h3 id="redis集群最大节点个数是多少？">Redis集群最大节点个数是多少？</h3><p>16384个</p><h3 id="redis集群如何选择数据库？">Redis集群如何选择数据库？</h3><p>Redis集群目前无法做数据库选择，默认在0数据库。</p><h2 id="分区">分区</h2><h3 id="redis是单线程的-如何提高多核cpu的利用率？">Redis是单线程的，如何提高多核CPU的利用率？</h3><p>可以在同一个服务器部署多个Redis的实例，并把他们当作不同的服务器来使用，在某些时候，无论如何一个服务器是不够的， 所以，如果你想使用多个CPU，你可以考虑一下分片（shard）。</p><h3 id="为什么要做redis分区？">为什么要做Redis分区？</h3><p>分区可以让Redis管理更大的内存，Redis将可以使用所有机器的内存。如果没有分区，你最多只能使用一台机器的内存。分区使Redis的计算能力通过简单地增加计算机得到成倍提升，Redis的网络带宽也会随着计算机和网卡的增加而成倍增长。</p><h3 id="你知道有哪些redis分区实现方案？">你知道有哪些Redis分区实现方案？</h3><ul><li><p>客户端分区就是在客户端就已经决定数据会被存储到哪个redis节点或者从哪个redis节点读取。大多数客户端已经实现了客户端分区。</p></li><li><p>代理分区 意味着客户端将请求发送给代理，然后代理决定去哪个节点写数据或者读数据。代理根据分区规则决定请求哪些Redis实例，然后根据Redis的响应结果返回给客户端。redis和memcached的一种代理实现就是Twemproxy</p></li></ul><ul><li>查询路由(Query routing) 的意思是客户端随机地请求任意一个redis实例，然后由Redis将请求转发给正确的Redis节点。Redis Cluster实现了一种混合形式的查询路由，但并不是直接将请求从一个redis节点转发到另一个redis节点，而是在客户端的帮助下直接redirected到正确的redis节点。</li></ul><h3 id="redis分区有什么缺点？">Redis分区有什么缺点？</h3><ul><li>涉及多个key的操作通常不会被支持。例如你不能对两个集合求交集，因为他们可能被存储到不同的Redis实例（实际上这种情况也有办法，但是不能直接使用交集指令）。</li><li>同时操作多个key,则不能使用Redis事务.</li><li>分区使用的粒度是key，不能使用一个非常长的排序key存储一个数据集（The partitioning granularity is the key, so it is not possible to shard a dataset with a single huge key like a very big sorted set）</li><li>当使用分区的时候，数据处理会非常复杂，例如为了备份你必须从不同的Redis实例和主机同时收集RDB / AOF文件。</li><li>分区时动态扩容或缩容可能非常复杂。Redis集群在运行时增加或者删除Redis节点，能做到最大程度对用户透明地数据再平衡，但其他一些客户端分区或者代理分区方法则不支持这种特性。然而，有一种预分片的技术也可以较好的解决这个问题。</li></ul><h2 id="分布式问题">分布式问题</h2><h3 id="redis实现分布式锁">Redis实现分布式锁</h3><p>Redis为单进程单线程模式，采用队列模式将并发访问变成串行访问，且多客户端对Redis的连接并不存在竞争关系Redis中可以使用SETNX命令实现分布式锁。</p><p>当且仅当 key 不存在，将 key 的值设为 value。 若给定的 key 已经存在，则 SETNX 不做任何动作</p><p>SETNX 是『SET if Not eXists』(如果不存在，则 SET)的简写。</p><p>返回值：设置成功，返回 1 。设置失败，返回 0 。</p><img src="https://cdn.jsdelivr.net/gh/liaojie1314/PicGo@master/images/202301311706001.png" alt="20191213103148681" style="zoom:80%;" /><p>使用SETNX完成同步锁的流程及事项如下：</p><p>使用SETNX命令获取锁，若返回0（key已存在，锁已存在）则获取失败，反之获取成功</p><p>为了防止获取锁后程序出现异常，导致其他线程/进程调用SETNX命令总是返回0而进入死锁状态，需要为该key设置一个“合理”的过期时间</p><p>释放锁，使用DEL命令将锁数据删除</p><h3 id="如何解决-redis-的并发竞争-key-问题">如何解决 Redis 的并发竞争 Key 问题</h3><p>所谓 Redis 的并发竞争 Key 的问题也就是多个系统同时对一个 key 进行操作，但是最后执行的顺序和我们期望的顺序不同，这样也就导致了结果的不同！</p><p>推荐一种方案：分布式锁（zookeeper 和 redis 都可以实现分布式锁）。（如果不存在 Redis 的并发竞争 Key 问题，不要使用分布式锁，这样会影响性能）</p><p>基于zookeeper临时有序节点可以实现的分布式锁。大致思想为：每个客户端对某个方法加锁时，在zookeeper上的与该方法对应的指定节点的目录下，生成一个唯一的瞬时有序节点。 判断是否获取锁的方式很简单，只需要判断有序节点中序号最小的一个。 当释放锁的时候，只需将这个瞬时节点删除即可。同时，其可以避免服务宕机导致的锁无法释放，而产生的死锁问题。完成业务流程后，删除对应的子节点释放锁。</p><p>在实践中，当然是从以可靠性为主。所以首推Zookeeper。</p><h3 id="分布式redis是前期做还是后期规模上来了再做好？为什么？">分布式Redis是前期做还是后期规模上来了再做好？为什么？</h3><p>既然Redis是如此的轻量（单实例只使用1M内存），为防止以后的扩容，最好的办法就是一开始就启动较多实例。即便你只有一台服务器，你也可以一开始就让Redis以分布式的方式运行，使用分区，在同一台服务器上启动多个实例。</p><p>一开始就多设置几个Redis实例，例如32或者64个实例，对大多数用户来说这操作起来可能比较麻烦，但是从长久来看做这点牺牲是值得的。</p><p>这样的话，当你的数据不断增长，需要更多的Redis服务器时，你需要做的就是仅仅将Redis实例从一台服务迁移到另外一台服务器而已（而不用考虑重新分区的问题）。一旦你添加了另一台服务器，你需要将你一半的Redis实例从第一台机器迁移到第二台机器。</p><h3 id="什么是-redlock">什么是 RedLock</h3><p>Redis 官方站提出了一种权威的基于 Redis 实现分布式锁的方式名叫 <em>Redlock</em>，此种方式比原先的单节点的方法更安全。它可以保证以下特性：</p><ol><li>安全特性：互斥访问，即永远只有一个 client 能拿到锁</li><li>避免死锁：最终 client 都可能拿到锁，不会出现死锁的情况，即使原本锁住某资源的 client crash 了或者出现了网络分区</li><li>容错性：只要大部分 Redis 节点存活就可以正常提供服务</li></ol><h2 id="缓存异常">缓存异常</h2><h3 id="缓存雪崩">缓存雪崩</h3><p><strong>缓存雪崩</strong>是指缓存同一时间大面积的失效，所以，后面的请求都会落到数据库上，造成数据库短时间内承受大量请求而崩掉。</p><p><strong>解决方案</strong></p><ol><li>缓存数据的过期时间设置随机，防止同一时间大量数据过期现象发生。</li><li>一般并发量不是特别多的时候，使用最多的解决方案是加锁排队。</li><li>给每一个缓存数据增加相应的缓存标记，记录缓存的是否失效，如果缓存标记失效，则更新数据缓存。</li></ol><h3 id="缓存穿透">缓存穿透</h3><p><strong>缓存穿透</strong>是指缓存和数据库中都没有的数据，导致所有的请求都落到数据库上，造成数据库短时间内承受大量请求而崩掉。</p><p><strong>解决方案</strong></p><ol><li><p>接口层增加校验，如用户鉴权校验，id做基础校验，id&lt;=0的直接拦截；</p></li><li><p>从缓存取不到的数据，在数据库中也没有取到，这时也可以将key-value对写为key-null，缓存有效时间可以设置短点，如30秒（设置太长会导致正常情况也没法使用）。这样可以防止攻击用户反复用同一个id暴力攻击</p></li><li><p>采用布隆过滤器，将所有可能存在的数据哈希到一个足够大的 bitmap 中，一个一定不存在的数据会被这个 bitmap 拦截掉，从而避免了对底层存储系统的查询压力</p></li></ol><p><strong>附加</strong></p><p>对于空间的利用到达了一种极致，那就是Bitmap和布隆过滤器(Bloom Filter)。<br>Bitmap： 典型的就是哈希表<br>缺点是，Bitmap对于每个元素只能记录1bit信息，如果还想完成额外的功能，恐怕只能靠牺牲更多的空间、时间来完成了。</p><p>布隆过滤器（推荐）</p><p>就是引入了k(k&gt;1)k(k&gt;1)个相互独立的哈希函数，保证在给定的空间、误判率下，完成元素判重的过程。</p><p>它的优点是空间效率和查询时间都远远超过一般的算法，缺点是有一定的误识别率和删除困难。<br>Bloom-Filter算法的核心思想就是利用多个不同的Hash函数来解决“冲突”。</p><p>Hash存在一个冲突（碰撞）的问题，用同一个Hash得到的两个URL的值有可能相同。为了减少冲突，我们可以多引入几个Hash，如果通过其中的一个Hash值我们得出某元素不在集合中，那么该元素肯定不在集合中。只有在所有的Hash函数告诉我们该元素在集合中时，才能确定该元素存在于集合中。这便是Bloom-Filter的基本思想。<br>Bloom-Filter一般用于在大数据量的集合中判定某元素是否存在。</p><h3 id="缓存击穿">缓存击穿</h3><p><strong>缓存击穿</strong>是指缓存中没有但数据库中有的数据（一般是缓存时间到期），这时由于并发用户特别多，同时读缓存没读到数据，又同时去数据库去取数据，引起数据库压力瞬间增大，造成过大压力。和缓存雪崩不同的是，缓存击穿指并发查同一条数据，缓存雪崩是不同数据都过期了，很多数据都查不到从而查数据库。</p><p><strong>解决方案</strong></p><ol><li>设置热点数据永远不过期。</li><li>加互斥锁，互斥锁</li></ol><h3 id="缓存预热">缓存预热</h3><p><strong>缓存预热</strong>就是系统上线后，将相关的缓存数据直接加载到缓存系统。这样就可以避免在用户请求的时候，先查询数据库，然后再将数据缓存的问题！用户直接查询事先被预热的缓存数据！</p><p><strong>解决方案</strong></p><ol><li>直接写个缓存刷新页面，上线时手工操作一下；</li><li>数据量不大，可以在项目启动的时候自动进行加载；</li><li>定时刷新缓存；</li></ol><h3 id="缓存降级">缓存降级</h3><p>当访问量剧增、服务出现问题（如响应时间慢或不响应）或非核心服务影响到核心流程的性能时，仍然需要保证服务还是可用的，即使是有损服务。系统可以根据一些关键数据进行自动降级，也可以配置开关实现人工降级。</p><p><strong>缓存降级</strong>的最终目的是保证核心服务可用，即使是有损的。而且有些服务是无法降级的（如加入购物车、结算）。</p><p>在进行降级之前要对系统进行梳理，看看系统是不是可以丢卒保帅；从而梳理出哪些必须誓死保护，哪些可降级；比如可以参考日志级别设置预案：</p><ol><li><p>一般：比如有些服务偶尔因为网络抖动或者服务正在上线而超时，可以自动降级；</p></li><li><p>警告：有些服务在一段时间内成功率有波动（如在95~100%之间），可以自动降级或人工降级，并发送告警；</p></li><li><p>错误：比如可用率低于90%，或者数据库连接池被打爆了，或者访问量突然猛增到系统能承受的最大阀值，此时可以根据情况自动降级或者人工降级；</p></li><li><p>严重错误：比如因为特殊原因数据错误了，此时需要紧急人工降级。</p></li></ol><p>服务降级的目的，是为了防止Redis服务故障，导致数据库跟着一起发生雪崩问题。因此，对于不重要的缓存数据，可以采取服务降级策略，例如一个比较常见的做法就是，Redis出现问题，不去数据库查询，而是直接返回默认值给用户。</p><h3 id="热点数据和冷数据">热点数据和冷数据</h3><p>热点数据，缓存才有价值</p><p>对于冷数据而言，大部分数据可能还没有再次访问到就已经被挤出内存，不仅占用内存，而且价值不大。频繁修改的数据，看情况考虑使用缓存</p><p>对于热点数据，比如我们的某IM产品，生日祝福模块，当天的寿星列表，缓存以后可能读取数十万次。再举个例子，某导航产品，我们将导航信息，缓存以后可能读取数百万次。</p><p>数据更新前至少读取两次，缓存才有意义。这个是最基本的策略，如果缓存还没有起作用就失效了，那就没有太大价值了。</p><p>那存不存在，修改频率很高，但是又不得不考虑缓存的场景呢？有！比如，这个读取接口对数据库的压力很大，但是又是热点数据，这个时候就需要考虑通过缓存手段，减少数据库的压力，比如我们的某助手产品的，点赞数，收藏数，分享数等是非常典型的热点数据，但是又不断变化，此时就需要将数据同步保存到Redis缓存，减少数据库压力。</p><h3 id="缓存热点key">缓存热点key</h3><p>缓存中的一个Key(比如一个促销商品)，在某个时间点过期的时候，恰好在这个时间点对这个Key有大量的并发请求过来，这些请求发现缓存过期一般都会从后端DB加载数据并回设到缓存，这个时候大并发的请求可能会瞬间把后端DB压垮。</p><p><strong>解决方案</strong></p><p>对缓存查询加锁，如果KEY不存在，就加锁，然后查DB入缓存，然后解锁；其他进程如果发现有锁就等待，然后等解锁后返回数据或者进入DB查询</p><h2 id="常用工具">常用工具</h2><h3 id="redis支持的java客户端都有哪些？官方推荐用哪个？">Redis支持的Java客户端都有哪些？官方推荐用哪个？</h3><p>Redisson、Jedis、lettuce等等，官方推荐使用Redisson。</p><h3 id="redis和redisson有什么关系？">Redis和Redisson有什么关系？</h3><p>Redisson是一个高级的分布式协调Redis客服端，能帮助用户在分布式环境中轻松实现一些Java的对象 (Bloom filter, BitSet, Set, SetMultimap, ScoredSortedSet, SortedSet, Map, ConcurrentMap, List, ListMultimap, Queue, BlockingQueue, Deque, BlockingDeque, Semaphore, Lock, ReadWriteLock, AtomicLong, CountDownLatch, Publish / Subscribe, HyperLogLog)。</p><h3 id="jedis与redisson对比有什么优缺点？">Jedis与Redisson对比有什么优缺点？</h3><p>Jedis是Redis的Java实现的客户端，其API提供了比较全面的Redis命令的支持；Redisson实现了分布式和可扩展的Java数据结构，和Jedis相比，功能较为简单，不支持字符串操作，不支持排序、事务、管道、分区等Redis特性。Redisson的宗旨是促进使用者对Redis的关注分离，从而让使用者能够将精力更集中地放在处理业务逻辑上。</p><h2 id="其他问题">其他问题</h2><h3 id="redis与memcached的区别">Redis与Memcached的区别</h3><p>两者都是非关系型内存键值数据库，现在公司一般都是用 Redis 来实现缓存，而且 Redis 自身也越来越强大了！Redis 与 Memcached 主要有以下不同：</p><table><thead><tr><th style="text-align:center">对比参数</th><th style="text-align:center">Redis</th><th style="text-align:center">Memcached</th></tr></thead><tbody><tr><td style="text-align:center">类型</td><td style="text-align:center">1. 支持内存 2. 非关系型数据库</td><td style="text-align:center">1. 支持内存 2. 键值对形式 3. 缓存形式</td></tr><tr><td style="text-align:center"><strong>数据存储类型</strong></td><td style="text-align:center">1. String 2. List 3. Set 4. Hash 5. Sort Set 【俗称ZSet】</td><td style="text-align:center">1. 文本型 2. 二进制类型</td></tr><tr><td style="text-align:center">查询【操作】类型</td><td style="text-align:center">1. 批量操作 2. 事务支持 3. 每个类型不同的CRUD</td><td style="text-align:center">1.常用的CRUD 2. 少量的其他命令</td></tr><tr><td style="text-align:center">附加功能</td><td style="text-align:center">1. 发布/订阅模式 2. 主从分区 3. 序列化支持 4. 脚本支持【Lua脚本】</td><td style="text-align:center">1. 多线程服务支持</td></tr><tr><td style="text-align:center"><strong>网络IO模型</strong></td><td style="text-align:center">1. 单线程的多路 IO 复用模型</td><td style="text-align:center">1. 多线程，非阻塞IO模式</td></tr><tr><td style="text-align:center">事件库</td><td style="text-align:center">自封转简易事件库AeEvent</td><td style="text-align:center">贵族血统的LibEvent事件库</td></tr><tr><td style="text-align:center"><strong>持久化支持</strong></td><td style="text-align:center">1. RDB 2. AOF</td><td style="text-align:center">不支持</td></tr><tr><td style="text-align:center"><strong>集群模式</strong></td><td style="text-align:center">原生支持 cluster 模式，可以实现主从复制，读写分离</td><td style="text-align:center">没有原生的集群模式，需要依靠客户端来实现往集群中分片写入数据</td></tr><tr><td style="text-align:center">内存管理机制</td><td style="text-align:center">在 Redis 中，并不是所有数据都一直存储在内存中，可以将一些很久没用的 value 交换到磁盘</td><td style="text-align:center">Memcached 的数据则会一直在内存中，Memcached 将内存分割成特定长度的块来存储数据，以完全解决内存碎片的问题。但是这种方式会使得内存的利用率不高，例如块的大小为 128 bytes，只存储 100 bytes 的数据，那么剩下的 28 bytes 就浪费掉了。</td></tr><tr><td style="text-align:center"><strong>适用场景</strong></td><td style="text-align:center">复杂数据结构，有持久化，高可用需求，value存储内容较大</td><td style="text-align:center">纯key-value，数据量非常大，并发量非常大的业务</td></tr></tbody></table><p>(1) memcached所有的值均是简单的字符串，redis作为其替代者，支持更为丰富的数据类型</p><p>(2) redis的速度比memcached快很多</p><p>(3) redis可以持久化其数据</p><h3 id="如何保证缓存与数据库双写时的数据一致性？">如何保证缓存与数据库双写时的数据一致性？</h3><p>你只要用缓存，就可能会涉及到缓存与数据库双存储双写，你只要是双写，就一定会有数据一致性的问题，那么你如何解决一致性问题？</p><p>一般来说，就是如果你的系统不是严格要求缓存+数据库必须一致性的话，缓存可以稍微的跟数据库偶尔有不一致的情况，最好不要做这个方案，读请求和写请求串行化，串到一个内存队列里去，这样就可以保证一定不会出现不一致的情况</p><p>串行化之后，就会导致系统的吞吐量会大幅度的降低，用比正常情况下多几倍的机器去支撑线上的一个请求。</p><p>还有一种方式就是可能会暂时产生不一致的情况，但是发生的几率特别小，就是<strong>先更新数据库，然后再删除缓存。</strong></p><table><thead><tr><th style="text-align:center">问题场景</th><th style="text-align:center">描述</th><th style="text-align:center">解决</th></tr></thead><tbody><tr><td style="text-align:center">先写缓存，再写数据库，缓存写成功，数据库写失败</td><td style="text-align:center">缓存写成功，但写数据库失败或者响应延迟，则下次读取（并发读）缓存时，就出现脏读</td><td style="text-align:center">这个写缓存的方式，本身就是错误的，需要改为先写数据库，把旧缓存置为失效；读取数据的时候，如果缓存不存在，则读取数据库再写缓存</td></tr><tr><td style="text-align:center">先写数据库，再写缓存，数据库写成功，缓存写失败</td><td style="text-align:center">写数据库成功，但写缓存失败，则下次读取（并发读）缓存时，则读不到数据</td><td style="text-align:center">缓存使用时，假如读缓存失败，先读数据库，再回写缓存的方式实现</td></tr><tr><td style="text-align:center">需要缓存异步刷新</td><td style="text-align:center">指数据库操作和写缓存不在一个操作步骤中，比如在分布式场景下，无法做到同时写缓存或需要异步刷新（补救措施）时候</td><td style="text-align:center">确定哪些数据适合此类场景，根据经验值确定合理的数据不一致时间，用户数据刷新的时间间隔</td></tr></tbody></table><h3 id="redis常见性能问题和解决方案？">Redis常见性能问题和解决方案？</h3><ol><li><p>Master最好不要做任何持久化工作，包括内存快照和AOF日志文件，特别是不要启用内存快照做持久化。</p></li><li><p>如果数据比较关键，某个Slave开启AOF备份数据，策略为每秒同步一次。</p></li><li><p>为了主从复制的速度和连接的稳定性，Slave和Master最好在同一个局域网内。</p></li><li><p>尽量避免在压力较大的主库上增加从库</p></li><li><p>Master调用BGREWRITEAOF重写AOF文件，AOF在重写的时候会占大量的CPU和内存资源，导致服务load过高，出现短暂服务暂停现象。</p></li><li><p>为了Master的稳定性，主从复制不要用图状结构，用单向链表结构更稳定，即主从关系为：Master&lt;–Slave1&lt;–Slave2&lt;–Slave3…，这样的结构也方便解决单点故障问题，实现Slave对Master的替换，也即，如果Master挂了，可以立马启用Slave1做Master，其他不变。</p></li></ol><h3 id="redis官方为什么不提供windows版本？">Redis官方为什么不提供Windows版本？</h3><p>因为目前Linux版本已经相当稳定，而且用户量很大，无需开发windows版本，反而会带来兼容性等问题。</p><h3 id="一个字符串类型的值能存储最大容量是多少？">一个字符串类型的值能存储最大容量是多少？</h3><p>512M</p><h3 id="redis如何做大量数据插入？">Redis如何做大量数据插入？</h3><p>Redis2.6开始redis-cli支持一种新的被称之为pipe mode的新模式用于执行大量数据插入工作。</p><h3 id="假如redis里面有1亿个key-其中有10w个key是以某个固定的已知的前缀开头的-如果将它们全部找出来？">假如Redis里面有1亿个key，其中有10w个key是以某个固定的已知的前缀开头的，如果将它们全部找出来？</h3><p>使用keys指令可以扫出指定模式的key列表。</p><p>对方接着追问：如果这个redis正在给线上的业务提供服务，那使用keys指令会有什么问题？</p><p>这个时候你要回答redis关键的一个特性：redis的单线程的。keys指令会导致线程阻塞一段时间，线上服务会停顿，直到指令执行完毕，服务才能恢复。这个时候可以使用scan指令，scan指令可以无阻塞的提取出指定模式的key列表，但是会有一定的重复概率，在客户端做一次去重就可以了，但是整体所花费的时间会比直接用keys指令长。</p><h3 id="使用redis做过异步队列吗-是如何实现的">使用Redis做过异步队列吗，是如何实现的</h3><p>使用list类型保存数据信息，rpush生产消息，lpop消费消息，当lpop没有消息时，可以sleep一段时间，然后再检查有没有信息，如果不想sleep的话，可以使用blpop, 在没有信息的时候，会一直阻塞，直到信息的到来。redis可以通过pub/sub主题订阅模式实现一个生产者，多个消费者，当然也存在一定的缺点，当消费者下线时，生产的消息会丢失。</p><h3 id="redis如何实现延时队列">Redis如何实现延时队列</h3><p>使用sortedset，使用时间戳做score, 消息内容作为key,调用zadd来生产消息，消费者使用zrangbyscore获取n秒之前的数据做轮询处理。</p><h3 id="redis回收进程如何工作的？">Redis回收进程如何工作的？</h3><ol><li>一个客户端运行了新的命令，添加了新的数据。</li><li>Redis检查内存使用情况，如果大于maxmemory的限制， 则根据设定好的策略进行回收。</li><li>一个新的命令被执行，等等。</li><li>所以我们不断地穿越内存限制的边界，通过不断达到边界然后不断地回收回到边界以下。</li></ol><p>如果一个命令的结果导致大量内存被使用（例如很大的集合的交集保存到一个新的键），不用多久内存限制就会被这个内存使用量超越。</p><h3 id="redis回收使用的是什么算法？">Redis回收使用的是什么算法？</h3><p>LRU算法</p><h2 id="整理的其他面试题">整理的其他面试题</h2><div class='tag-link-1'><a class="tag-Link" target="_blank" href=" https://www.php.cn/redis/458425.html">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://api.iowen.cn/favicon/www.php.cn/redis/458425.html.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">2023年最新redis面试题大全及答案（收藏）</div>            <div class="tag-link-sitename"> https://www.php.cn/redis/458425.html</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div><div class='tag-link-1'><a class="tag-Link" target="_blank" href=" https://www.jianshu.com/p/65765dd10671">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://api.iowen.cn/favicon/www.jianshu.com/p/65765dd10671.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">Redis面试题总结</div>            <div class="tag-link-sitename"> https://www.jianshu.com/p/65765dd10671</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div><div class='tag-link-1'><a class="tag-Link" target="_blank" href=" https://zhuanlan.zhihu.com/p/91539644">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://api.iowen.cn/favicon/zhuanlan.zhihu.com/p/91539644.png);"></div>        <div class="tag-link-right">            <div class="tag-link-title">《进大厂系列》系列-Redis常见面试题（带答案）</div>            <div class="tag-link-sitename"> https://zhuanlan.zhihu.com/p/91539644</div>        </div>        <i class="fa-solid fa-angle-right"></i>    </div>    </a></div>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;概述&quot;&gt;概述&lt;/h2&gt;
&lt;h3 id=&quot;什么是redis&quot;&gt;什么是Redis&lt;/h3&gt;
&lt;p&gt;Redis(Remote Dictionary Server) 是一个使用 C 语言编写的，开源的（BSD许可）高性能非关系型（NoSQL）的键值对数据库。&lt;/p&gt;
&lt;p</summary>
      
    
    
    
    <category term="数据库" scheme="https://www.yuanyuan.blog/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
    
    <category term="redis" scheme="https://www.yuanyuan.blog/tags/redis/"/>
    
  </entry>
  
</feed>
